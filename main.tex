\documentclass[a4paper]{amsart}
\usepackage[utf8]{inputenc}
\usepackage{fullpage}
\input{header}

% Title, authors, and affiliations
\title{Poincar\'e--Friedrichs constants over triangulated domains}
\author{TCF, MWL, MV}

% Theorem environments

\begin{document}

\begin{abstract}
    We construct upper bounds for Poincar\'e--Friedrichs constants over triangulated domains. 
    These include the Poincar\'e, Maxwell, and Friedrichs constants as special cases. 
    The main application that we envision concern computable estimates over finite element patches. 
\end{abstract}

\maketitle

\section{Introduction}

% introductory paragraph 

% Estimates for Poincare constants 
% \cite{bebendorf2003note}
% \cite{vohralik2005discrete}
% \cite{farwig2016note}
% Verfurth, Veeser & Verfurth 
% ...

% Estimates for Friedrichs constants (if any)

% Estimates for Maxwell constants (if any)


While it is known that finite element patches admit Poincar\'e--Friedrichs inequalities, 
we are not aware of computable estimates. 
Clearly, not all local patches describe convex subdomains. 
An ostensibly more practical class of domains are domains star-shaped with respect to a ball.
Indeed, finite element patches of Lipschitz satisfy that condition. 
Over patches around interior subsimplices, the size of interior ball only depends on the shape regularity of the triangulation. However, the interior ball can be arbitrarily small when the patch is around a boundary simplex at a reentrant corner, even if the mesh has good shape-regularity. 
Some interesting limit cases include the slit domain and the crossed bricks domain,
for which some finite element patches are not star-shaped with respect to any ball. 
\color{red}Our upper bounds do not depend on the angles of such reentrant corners, even in the aforementioned limit cases, but only the shape-regularity of the triangulation. \color{black}


It is often very helpful if a simplicial complex can be created recursively, starting with a single simplex. 
In particular, this enables the inductive method of proof.


Estimating Poincar\'e--Friedrichs over domains and manifolds with shellable triangulations is fundamentally restricted to spaces with the simplicial homology groups of discs and spheres. However, these estimates are important partial results. Forthcoming work will take these as a subcomponent in computing upper bounds for Poincar\'e--Friedrichs constants over simplicial triangulations of general $n$-dimensional manifolds. 



\section{Basic notions of triangulations and polytopal shellings}

We gather notions of simplicial meshes for the subsequent discussion. 
Apart from basic definitions and notational conventions, we pay special attention to the question of when a simplicial complex is a triangulation of a manifold. 
A particularly important class of simplicial complexes are so-called \emph{shellable} complexes. Such simplicial complexes are constructed by successively adding simplices in a particularly well-behaved manner. While shellable complexes are a very special class of complexes, they faciliate achieving the main goal of our exposition.
Our main references on simplicial complexes and shellability are the monographs by Ziegler~\cite{ziegler2012lectures} and Kozlov~\cite{kozlov2008combinatorial}. 

% 1. Develop some notation 

\subsection{Basic notions}

A ${k}$-dimensional \emph{simplex} $T$ is the convex hull of ${k}+1$ affinely independent points $v_0, v_1, \ldots, v_{{k}} \in \mathbb{R}^{n}$. We call these the \emph{vertices} of the simplex $T$. 
If $S$ is a simplex whose vertices are also vertices of another simplex $T$, in which case $S \subseteq T$, 
then we call $S$ a subsimplex of $T$ and we call $T$ a supersimplex of $S$. 

A family of simplices $\calT$ is a \emph{simplicial complex} or \emph{triangulation}, if its member simplices satisfy the following condition: 
(i) every subsimplex of any simplex in $\calT$ is itself part of $\calT$, and (ii) the intersection between any two simplices $T, T' \in \calT$ is either empty or a shared subsimplex of both $T$ and $T'$. 
The set of $k$-dimensional simplices in $\calT$ is denoted as $\subsimplex_{{k}}(\calT)$. 
We say that $\calT$ has dimension $n$ if it contains an $n$-dimensional simplex as a supersimplex for each simplex within it. 

Given any simplex $T$, we write $\subsimplex(T)$ for the simplicial complex that contains all subsimplices of $T$. 
More specifically, $\subsimplex_{{k}}(T) \subseteq \subsimplex(T)$ denotes the set of $k$-dimensional subsimplices of $T$. 
Whenever $\calT$ is a simplicial complex and $T \in \calT$, we let $\supsimplex(\calT,T)$ be the set of simplices in $\calT$ that contain $T$.
We write $\supsimplex_{k}(\calT,T)$ for the set of $k$-dimensional simplices in $\supsimplex(\calT,T)$. 
Additionally, the notations $\Vertices(\calT) := \subsimplex_{0}(\calT)$ and $\Edges(\calT) := \subsimplex_{1}(\calT)$ refer to the vertices and edges of the simplicial complex, respectively. Similarly, if $\calT$ is an $n$-dimensional simplicial complex, we write $\Faces(\calT) := \subsimplex_{n-1}(\calT)$ for the faces of the triangulation. 

When $\calT$ is a triangulation and $T \in \calT$, then $\patch_{\calT}(T)$ denotes the \emph{local patch} of $T$, which is the smallest simplicial subcomplex of $\calT$ that contains all supersimplices of $T$. Formally,
\begin{gather*}
    \patch_{\calT}(T) := \bigcup_{ T' \in \supsimplex(\calT,T) } \subsimplex(T').
\end{gather*}
A crucial observation is the following.

\begin{lemma}
 Let $\calT$ be an $n$-dimensional simplicial complex and let $T,T' \in \calT$.
 Then either $\calT_{n}(T) \cap \calT_{n}(T') = \emptyset$ or there exists $S \in \calT$
 such that $\calT_{n}(T) \cap \calT_{n}(T') = \calT_{n}(S)$ with $T, T' \subseteq S$.
\end{lemma}
\begin{proof}
 Let $F \in \calT$ be $n$-dimensional.
 We have $F \in \patch_{\calT}(T )$ if and only if all vertices of $T $ are vertices of $F$.
 We have $F \in \patch_{\calT}(T')$ if and only if all vertices of $T'$ are vertices of $F$.
 Consequently, $F \in \patch_{\calT}(T) \cap \patch_{\calT}(T)$ if and only if $F \in \patch_{\calT}(S)$,
 where $S \in \calT$ and $S$ is the convex closure of $F$ and $F'$.
\end{proof}

Given an $n$-dimensional simplicial complex $\calT$, 
we call $n$-simplices $S,T \in \calT$ \emph{strongly connected in $\calT$} if there exists a sequence $S_0=S,S_1,\dots,T=S_m \in \calT$ such that $S_{i} \cap S_{i-1}$ is a face of both $S_{i}$ and $S_{i-1}$ for all $1 \leq i \leq m$. Clearly, strongly connected in $\calT$ is an equivalence relation. A \emph{strongly connected component} of $\calT$ is an equivalence class under this equivalence relation, and we call $\calT$ strongly connected if it has only one strongly connected component. 




% 2. Develop manifold-like complexes and characterize them 
\subsection{Triangulations of manifolds}

We call an $n$-dimensional simplicial complex $\calT$ \emph{non-branching} if every $F \in \calT$ of dimension $n-1$ is contained in at most two $n$-simplices of $\calT$. We call those $F \in \calT$ of dimension $n-1$ contained within only one parent a \emph{boundary face}.
We write $\partial\calT$ for the simplicial subcomplex of $\calT$ of dimension $n-1$ 
whose full-dimensional members are exactly the boundary faces of $\calT$.

An $n$-dimensional simplicial complex is called \emph{manifold-like} if for every $x \in \bigcup \calT$
we have one of the following two conditions:
\begin{itemize}
 \item 
 there exists $\epsilon > 0$ 
 and a homeomorphism 
 \begin{align*}
    \phi : \Ball_\epsilon(x) \cap \bigcup\calT  
    \rightarrow 
    \left\{ x \in \bbR^{n} \suchthat |x| \leq 1 \right\}
 \end{align*}
 such that $\phi(x) = 0$,
 \item 
 there exists $\epsilon > 0$ and a homeomorphism 
 \begin{align*}
    \phi : \Ball_\epsilon(x) \cap \bigcup\calT 
    \rightarrow 
    \left\{ x \in \bbR^{n} \suchthat |x| \leq 1, x_n \leq 0 \right\}
 \end{align*}
 such that $\phi(x) = 0$.
\end{itemize}
This characterizes the union of the simplicial complex $\calT$ as a topological manifold with boundary. 

We would like to have a purely combinatorial and computable criterion that characterizes manifold-like simplicial complexes. A first step in that direction is the following result.

\begin{lemma}\label{lemma:characterizationofmanifoldcomplexes}
    Let $\calT$ be an $n$-dimensional simplicial complex. The following are equivalent:
    \begin{itemize}
     \item $\calT$ is manifold-like
     \item $\patch_{\calT}(V)$ is the triangulation of a ball for all $V \in \Vertices(\calT)$
     \item $\patch_{\calT}(V)$ is manifold-like for all $V \in \Vertices(\calT)$
     \item $\patch_{\calT}(S)$ is the triangulation of a ball for all $S \in \calT$
     \item $\patch_{\calT}(S)$ is manifold-like for all $S \in \calT$
    \end{itemize}
\end{lemma}
\begin{proof}
    \color{red} TODO
\end{proof}



\begin{remark}
    Clearly, not every simplicial complex is the triangulation of some (embedded) topological manifold with or without boundary. 
    Conversely, for each dimension $n \geq 5$ there exists an $n$-dimensional compact topological manifold without a triangulation. % TODO: are these compact?
    % TODO There are computational limits to algorithmically deciding whether a simplicial complex represents a manifold. 
\end{remark}



\begin{figure}
    \centering
    \begin{tikzpicture}
        \coordinate (O) at (0, 0);
        \coordinate (A) at ({cos(0)}, {sin(0)});
        \coordinate (B) at ({cos(60)}, {sin(60)});
        \coordinate (C) at ({cos(120)}, {sin(120)});
        \coordinate (D) at ({cos(180)}, {sin(180)});
        \coordinate (E) at ({cos(240)}, {sin(240)});
        \coordinate (F) at ({cos(300)}, {sin(300)});
        \fill[gray!20] (A) -- (B) -- (O) -- (F) -- cycle;
        \draw (A) -- (B) -- (C) -- (D) -- (E) -- (F) -- cycle;
        \draw[dashed] (O) -- (A); \draw[dotted] (O) -- (B); \draw (O) -- (C); \draw (O) -- (D); \draw (O) -- (E); \draw (O) -- (F);
    \end{tikzpicture}
    \begin{tikzpicture}
        \coordinate (O) at (0, 0);
        \coordinate (A) at ({cos(0)}, {sin(0)});
        \coordinate (B) at ({cos(60)}, {sin(60)});
        \coordinate (C) at ({cos(120)}, {sin(120)});
        \coordinate (D) at ({cos(180)}, {sin(180)});
        \coordinate (E) at ({cos(240)}, {sin(240)});
        \coordinate (F) at ({cos(300)}, {sin(300)});
        \fill[gray!20] (A) -- (B) -- (O) -- (F) -- cycle;
        \draw[dotted] (A) -- (B); \draw (B) -- (C) -- (D) -- (E) -- (F) -- (A);
        \draw[dashed] (O) -- (A); \draw (O) -- (B); \draw (O) -- (C); \draw (O) -- (D); \draw (O) -- (E); \draw (O) -- (F);
    \end{tikzpicture}
    \begin{tikzpicture}
        \coordinate (O) at (0, 0);
        \coordinate (A) at ({cos(0)}, {sin(0)});
        \coordinate (B) at ({cos(60)}, {sin(60)});
        \coordinate (C) at ({cos(120)}, {sin(120)});
        \coordinate (D) at ({cos(180)}, {sin(180)});
        \coordinate (E) at ({cos(240)}, {sin(240)});
        \coordinate (F) at ({cos(300)}, {sin(300)});
        \fill[gray!20] (A) -- (B) -- (O) -- (F) -- cycle;
        \draw (A) -- (B) -- (C) -- (D) -- (E) -- (F) -- cycle;
        \draw[dashed] (O) -- (A); \draw (O) -- (B); \draw[dotted] (O) -- (C); \draw (O) -- (D); \draw (O) -- (E); \draw (O) -- (F);
    \end{tikzpicture}
    \begin{tikzpicture}
        \coordinate (O) at (0, 0);
        \coordinate (A) at ({cos(0)}, {sin(0)});
        \coordinate (B) at ({cos(60)}, {sin(60)});
        \coordinate (C) at ({cos(120)}, {sin(120)});
        \coordinate (D) at ({cos(180)}, {sin(180)});
        \coordinate (E) at ({cos(240)}, {sin(240)});
        \coordinate (F) at ({cos(300)}, {sin(300)});
        \fill[gray!20] (A) -- (B) -- (O) -- (F) -- cycle;
        \draw (A) -- (B) -- (C) -- (D) -- (E) -- (F) -- cycle;
        \draw[dashed] (O) -- (A); \draw (O) -- (B); \draw (O) -- (C); \draw[dotted] (O) -- (D); \draw (O) -- (E); \draw (O) -- (F);
    \end{tikzpicture}
    \caption{Examples and counterexamples for building a manifold-like $1$-patching of a $2$-dimensional manifold-like triangulation. (1) We have already added the edge patch along the dashed line and we add the edge patch along the dotted line. (2) The new edge patch already be a subset of the subtriangulation (3) An inadmissible choice because new edge patch has no overlap with current subtriangulation, though the next subtriangulation would be manifold-like (4) An inadmissible choice because new edge patch has no overlap with current subtriangulation and the next subtriangulation would not be manifold-like.}\label{figure:illustrationpatching}
\end{figure}

\begin{figure}
    \centering
    \begin{tikzpicture}[scale=0.5]
        \coordinate (O) at (0, 0);
        \coordinate (A) at ({0.8*cos(  0)}, {0.8*sin(  0)});
        \coordinate (B) at ({0.8*cos(120)}, {0.8*sin(120)});
        \coordinate (C) at ({0.8*cos(240)}, {0.8*sin(240)});
        \coordinate (X) at ({3.0*cos( 60)}, {3.0*sin( 60)});
        \coordinate (Y) at ({3.0*cos(180)}, {3.0*sin(180)});
        \coordinate (Z) at ({3.0*cos(300)}, {3.0*sin(300)});
        \draw (A) -- (B) -- (C) -- cycle; \draw (X) -- (Y) -- (Z) -- cycle;
        \draw[fill=gray!20] (X) -- (Y) -- (B) -- cycle;
        \draw[fill=gray!20] (Y) -- (Z) -- (C) -- cycle;
        \draw[fill=gray!20] (Z) -- (X) -- (A) -- cycle;
        \draw[fill=gray!20] (A) -- (X) -- (B) -- cycle;
        \draw[fill=gray!20] (B) -- (Y) -- (C) -- cycle;
        \draw[fill=gray!20] (C) -- (Z) -- (A) -- cycle;
    \end{tikzpicture}
    \begin{tikzpicture}[scale=0.5]
        \coordinate (O) at (0, 0);
        \coordinate (A) at ({3.0*cos(  0)}, {3.0*sin(  0)});
        \coordinate (B) at ({3.0*cos(120)}, {3.0*sin(120)});
        \coordinate (C) at ({3.0*cos(240)}, {3.0*sin(240)});
        \coordinate (X) at ({3.0*cos( 60)}, {3.0*sin( 60)});
        \coordinate (Y) at ({3.0*cos(180)}, {3.0*sin(180)});
        \coordinate (Z) at ({3.0*cos(300)}, {3.0*sin(300)});
        \draw (O) -- (A);
        \draw (O) -- (B);
        \draw (O) -- (C);
        \draw (O) -- (X);
        \draw (O) -- (Y);
        \draw (O) -- (Z);
        %
    \end{tikzpicture}
    \begin{tikzpicture}[scale=0.5] 
        \tikzset{z={(90:1cm)}, y={(-30:1cm)}, x={(210:1cm)}}
        % \tikzset{z={(90:1cm)}, y={(-10:1cm)}, x={(250:1cm)}}

        \coordinate (O) at (0, 0);
        \coordinate (A) at ({3.0*cos(  0)}, {3.0*sin(  0)});
        \coordinate (B) at ({3.0*cos(120)}, {3.0*sin(120)});
        \coordinate (C) at ({3.0*cos(240)}, {3.0*sin(240)});
        \coordinate (X) at ({3.0*cos( 60)}, {3.0*sin( 60)});
        \coordinate (Y) at ({3.0*cos(180)}, {3.0*sin(180)});
        \coordinate (Z) at ({3.0*cos(300)}, {3.0*sin(300)});
        \coordinate (T) at ({0}, {0}, {3});

        \draw[thick, fill=gray!30] (O) -- (C) -- (T) -- cycle;
        \draw[thick, fill=gray!30] (O) -- (Y) -- (T) -- cycle;
        \draw[thick, fill=gray!30] (O) -- (Z) -- (T) -- cycle;
        \draw[thick, fill=gray!30] (O) -- (A) -- (T) -- cycle;
        \draw[thick, fill=gray!30] (O) -- (B) -- (T) -- cycle;
        \draw[thick, fill=gray!30] (O) -- (X) -- (T) -- cycle;
        
        
    \end{tikzpicture}

    \caption{Example of a connected $2$-dimensional manifold-like simplicial complex, which triangulates an annulus, that does neither admit a manifold-like $0$-patching nor manifold-like $1$-patching.}\label{figure:annuluscounterexample}
\end{figure}

% \color{red}
% \begin{proposition}
%     Suppose that $\calT$ is a connected $n$-dimensional simplicial complex. Then the following are equivalent:
%     \begin{itemize}
%      \item $\calT$ is manifold-like
%      \item $\calT$ has a manifold-like $0$-patching
%      % \item There exists $1 \leq k \leq n$ such that $\calT$ has a $k$-patching
%     \end{itemize}
% \end{proposition}
% \color{black}





% 3. Shellability 
\subsection{Shellable simplicial complexes}

We turn our attention to a different idea of how to incrementally construct a simplicial complex while maintaining well-behaved intermediate complexes. 
Given an $n$-dimensional simplicial complex $\calT$, a \emph{shelling} is an enumeration of the $n$-simplices $T_{0}, T_{1}, T_{2}, \dots \in \subsimplex_{n}(\calT)$ such that $( \patch_{\calT}(T_{0}) \cup \patch_{\calT}(T_{1}) \cup \dots \cup \patch_{\calT}(T_{m}) ) \cap \patch_{\calT}(T_{m+1})$ is a simplicial complex of dimension $n-1$. Notice that the last intersection is automatically a subcomplex of the boundary complex of the last simplex $T_{m}$, and is thus manifold like. 


% \begin{lemma}
%     If an $n$-dimensional simplicial complex $\calT$ has a shelling $T_{0}, T_{1}, T_{2}, \dots$, then it is manifold-like.
%     In particular, $\patch_{\calT}(T_{0}) \cup \patch_{\calT}(T_{1}) \cup \dots \cup \patch_{\calT}(T_{m})$ is manifold-like for every $m \geq 0$.
% \end{lemma}
% \begin{proof}    
% \end{proof}

We notion of shelling is taken from Ziegler's book~\cite{ziegler2012lectures}

% TODO: Ziegler, Lemma 8.7: if a complex has a shelling, then this gives a shelling of the stars 

% 

A simplicial $n$-dimensional complex $\calT$ is called shellable if its $n$-simplices can be arranged in linear order $T_0, T_1, \dots$ in such a way that the subcomplex $( \cup_{i=0}^{k-1} T_i ) \cap T_k$ has dimension $n-1$ for all $k > 0$.


\begin{remark}
    A shellable simplicial complex that triangulates a manifold has a very restricted topology. 
    The Mayer-Vietoris theorem implies restrictions on the homology groups of simplicial complexes iteratively constructed via shelling. 

    Suppose that $\calT$ is a strongly connected $n$-dimensional simplicial complex that triangulates a manifold, and suppose that its boundary complex $\partial\calT$ is either empty or strongly connected.  
    Suppose furthermore that $T$ is an $n$-simplex, $T \notin \calT$, whose boundary complex intersects with $\partial\calT$ at a non-empty simplicial complex $\calS$ of dimension $n-1$. In particular, $\calS$ is either the whole boundary complex of $T$ or a patch around a proper subsimplex of $T$. We write $\calT'$ be the  simplicial complex that contains $\calT \cup T$.
    We exclude that case $n \leq 1$ since otherwise the discussion is trivial.
    
    According to the simplicial Mayer-Vietoris theorem, there exists an exact sequence 
    \begin{align*}
        \begin{CD}
            \dots \longrightarrow H_{k}(\calS) \longrightarrow H_{k}(\calT \oplus T) \longrightarrow H_{k}(\calT') \longrightarrow H_{k-1}(\calS) \longrightarrow\dots 
        \end{CD}
    \end{align*}
    We notice that $\calS$, $\calT$, $T$ and $\calT'$ are each connected, and hence their zeroth homology groups are isomorphic to $\bbZ$. 
    By the nature of the mappings in the Mayer-Vietoris sequence, 
    \color{red}which uses some specific knowledge about the arrows\color{black}, 
    we see that 
    \begin{align*}
        \begin{CD}
            0 \longrightarrow H_{0}(\calS) \longrightarrow H_{0}(\calT) \oplus H_{0}(T) \longrightarrow H_{0}(\calT') \longrightarrow 0 
        \end{CD}
    \end{align*}
    is an exact sequence. 
    Moreover, $H_{k}(\calS) = H_{k}(T) 0$ for $0 < k < n-1$. Hence, for $1 < k < n-1$,
    the Mayer-Vietoris sequence includes the exact sequence 
    \begin{align*}
        \begin{CD}
            0 \longrightarrow H_{k}(\calT \oplus T) \longrightarrow H_{k}(\calT') \longrightarrow 0 
        \end{CD}
    \end{align*}
    and we conclude that $H_{k}(\calT) = 0$ for $0 < k < n-1$.
    Finally, the Mayer-Vietoris sequence includes the exact sequences 
    \begin{align*}
        \begin{CD}
            0 \longrightarrow H_{n}(\calT \oplus T) \longrightarrow H_{n}(\calT') \longrightarrow H_{n-1}(\calS) \longrightarrow H_{n-1}(\calT \oplus T) \longrightarrow H_{n-1}(\calT') \longrightarrow 0 
        \end{CD}
    \end{align*}
    % Here, if $n=1$, it already follows that $H_{n}(\calT \oplus T) \simeq H_{n}(\calT')$.
    % % We know that  $H_{0}(\calT') \simeq H_{0}(\calT) \simeq H_{0}(T) \simeq H_{0}(\calS) \simeq \bbZ$ because the respective simplicial complexes are path-connected. 
    % Hence $H_{1}(\calT) \oplus H_{1}(T) \simeq H_{1}(\calT')$. 
    % one easily sees that $H_{0}(\calT') \simeq \bbZ$ and $H_{1}(\calT) \oplus H_{1}(T) \simeq H_{1}(\calT')$. 
    Since $\calT$ and $T$ are triangulations of manifolds with non-empty boundary, their $n$-th simplicial homology groups vanish. 
    In the case that $\calS$ is isomorphic to disk,
    then $H_{n}(\calT') \simeq H_{n}(\calT \oplus T)$ are trivial and $H_{n-1}(\calT') \simeq H_{n-1}(\calT \oplus T)$ follows.
    Consider now the case that $\calS$ is isomorphic to a sphere.
    Since the boundary complex of $\calT$ is strongly connected and non-branching, it must coincide with $\calS$. Hence $\calT'$ triangulates a manifold without boundary, and thus $H_{n}(\calT') \simeq \bbZ$. 
    \color{red}By some handwaving argument, $H_{n}(\calT') \longrightarrow H_{n-1}(\calS)$ is an isomorphism.\color{black}
    Hence $H_{n-1}(\calT) \rightarrow H_{n-1}(\calT')$ is an isomorphism.
    
    We conclude that the simplicial homology groups of a shellable $n$-dimensional simplicial complex $\calT$ that triangulates a manifold satisfy 
    \[
        H_0(\calT) \simeq \bbZ, 
        \quad 
        H_1(\calT) \simeq \dots \simeq H_{n-1}(\calT) \simeq 0.
    \]
    Moreover, $H_n(\calT) \simeq \bbZ$ if $\calT$ has no boundary and $H_n(\calT) \simeq 0$ otherwise. 
    
    % then $H_{n}(\calT') \simeq H_{n}(\calT \oplus T)$ and $H_{n-1}(\calT') \simeq H_{n-1}(\calT \oplus T)$ follow immediately.
    % Moreover, Thus $H_{n}(\calT') = H_{n}(\calT) \oplus H_{n}(\calS)$.
    % We conclude that any shellable simplicial complex has the homology groups of a disk or a sphere. 
    % NB: the zeroth homology is always free, and the n-th homology group, being the kernel of a mapping free abelian group, is free as well.
    % \begin{align*}
    %     \begin{CD}
    %         0 \longrightarrow H_{1}(\calT) \oplus H_{1}(T) \longrightarrow H_{1}(\calT') \longrightarrow H_{0}(\calS) \longrightarrow H_{0}(\calT) \oplus H_{0}(T) \longrightarrow H_{0}(\calT') \longrightarrow 0 
    %     \end{CD}
    % \end{align*}
\end{remark}



\section{Constructive estimate of $p$-Poincar\'e constants}

Let us assume that $\Omega \subseteq \bbR^{n}$ is an open set. 
Given any $p \in [1,\infty]$, we let $L^p(\Omega)$ denote the Lebesgue space over $\Omega$ with integrability exponent $p$, and we write $\bfL^p(\Omega) := L^p(\Omega)^n$ for the corresponding Lebesgue space of vector fields. 
We also write $W^{1,p}(\Omega)$ for the first-order Sobolev space over $\Omega$ with integrability exponent $p$. 

We say that a domain $\Omega \subseteq \bbR^{n}$ satisfies the \emph{Poincar\'e--Friedrichs inequality} with exponent $p \in [1,\infty]$
if there exists a constant $C_{{\rm PF},\Omega,p} \geq 0$ such that the following holds:
for every vector field $\bff \in \nabla W^{1,p}(\Omega)$ there exists $u \in W^{1,p}(\Omega)$
such that $\nabla u = \bff$ and 
\begin{align}\label{math:inequalitypf:gradient}
    \| u \|_{L^{p}(\Omega)}
    \leq 
    C_{{\rm PF},\Omega,p} 
    \| \bff \|_{L^{p}(\Omega)}
    .
\end{align}
Equivalently, for all $u \in W^{1,p}(\Omega)$ we have 
\begin{align}
    \min_{ c \in \bbR } \| u - c \|_{L^{p}(\Omega)}
    \leq 
    C_{{\rm PF},\Omega,p} 
    \| \nabla u \|_{L^{p}(\Omega)}
    .
\end{align}
We call $C_{{\rm PF},\Omega,p}$ the \emph{Poincar\'e--Friedrichs constant} with exponent $p$. 
The main interest in this inequality is that it implies an upper bound for the generalized inverse of the gradient operator $\nabla : W^{1,p}(\Omega) \rightarrow L^{p}(\Omega)^{n}$.
\\


Before we proceed, we wish to clarify the relationship between the Poincar\'e--Friedrichs inequality, in the sense introduced above, with other inequalities that are known are Poincar\'e inequality or also Friedrichs inequality in the literature. 
Given $p \in [1,\infty]$ and an open set $\Omega \subseteq \bbR^{n}$ of finite measure, 
we say that $\Omega$ satisfies the Poincar\'e inequality with exponent $p$ 
if there exists $C_{{\varnothing},\Omega,p} \geq 0$ such that 
for all $u \in W^{1,p}(\Omega)$
\begin{align}
    \| u - u_{\Omega} \|_{L^{p}(\Omega)}
    \leq 
    C_{\varnothing,\Omega,p} 
    \| \nabla u \|_{L^{p}(\Omega)}
    ,
\end{align}
where $u_{\Omega}$ is the \emph{average} of $u$ over $\Omega$, that is,
\begin{align*}
    u_{\Omega} := |\Omega|^{-1} \int_{\Omega} u.
\end{align*}
Clearly, this Poincar\'e inequality implies the Poincar\'e--Friedrichs inequality and we have $C_{{\rm{PF}},\Omega,p} \leq C_{\varnothing,\Omega,p}$. 
Towards a converse inequality, 
let us first observe that the average of any $v \in W^{1,p}(\Omega)$ with $p < \infty$ satisfies the bound 
\begin{align*}
    \| v_\Omega \|_{L^{p}(\Omega)}^{p}
    = 
    \int_{\Omega} \left( |\Omega|^{-1} \int_{\Omega} |v(x)| \right)^{p}
    \leq 
    \int_{\Omega} \left( |\Omega|^{-1} \int_{\Omega} |v(x)|^{p} \right)
    = 
    \| v \|_{L^{p}(\Omega)}^{p}
    .
\end{align*}
Here, we have used Jensen's inequality. 
In the case $p = \infty$, any $v \in L^{\infty}(\Omega)$ satisfies $\| v_\Omega \|_{L^{\infty}(\Omega)} \leq \| v \|_{L^{\infty}(\Omega)}$. 
We therefore combine 
\begin{align*}
    \| v - v_\Omega \|_{L^{p}(\Omega)} 
    \leq
    2
    \| v \|_{L^{p}(\Omega)},
    \quad 
    v \in L^{p}(\Omega)
    .
\end{align*}
% \begin{align*}
%     \color{Emerald}
%     \| u - u_\Omega \|_{L^{p}(\Omega)}^{p}
%     \leq 
%     2^{p-1} 
%     \| u \|_{L^{p}(\Omega)}^{p}
%     +
%     2^{p-1} 
%     \| u_\Omega \|_{L^{p}(\Omega)}^{p}
%     \leq 
%     2^{p} 
%     \| u \|_{L^{p}(\Omega)}^{p}
%     .
% \end{align*}
Hence the Poincar\'e--Friedrichs inequality implies the Poincar\'e inequality with $C_{\varnothing,\Omega,p} \leq 2 C_{{\rm PF},\Omega,p}$. 

In the special case $p=2$, we always have $\| u - u_\Omega \|_{L^{2}(\Omega)} \leq \| u \|_{L^{2}(\Omega)}$ for any $v \in L^{2}(\Omega)$,
and therefore it even follows that $C_{\varnothing,\Omega,2} \leq C_{{\rm PF},\Omega,2}$. 
This follows from the orthogonality constant functions to average-free functions in $L^2(\Omega)$,
and it also follows from the projection estimate (see, e.g.,~\cite{xu2003some}).
We use a generalization of the projection estimate that was studied by Stern~\cite{stern2015banach} to obtain improved estimates for all $L^p$ spaces with $1 \leq p \leq \infty$:
since taking the average is a the projection onto the constants functions with unit norm, it now follows that 
\begin{align*}
    \| v - v_\Omega \|_{L^{p}(\Omega)}
    \leq 
    \min\left( 2, 2^{|2/p-1|} \right)
    \| v \|_{L^{p}(\Omega)}
    = 
    2^{|2/p-1|} 
    \| v \|_{L^{p}(\Omega)}
    ,
    \quad 
    v \in L^p(\Omega)
    .
\end{align*}
We have $1 \leq 2^{|2/p-1|} \leq 2$ for $1 \leq p \leq \infty$.
The upper bound is only attained in the limit cases $p = 1$ and $p = \infty$, and the lower bound is only attained if $p = 2$, which reproduces the improved estimate for the Hilbert space case.
The main consequence for us is the estimate 
$C_{\varnothing,\Omega,p} \leq 2^{|2/p-1|} C_{{\rm PF},\Omega,p}$.
\color{red} Question: can the estimate above be further improved for general $p$? Are there known results in the literature? \color{black}

We conclude that our notion of Poincar\'e--Friedrichs constant is equivalent to the notion of Poincar\'e constant in the literature, up to a numerical factor that only depends on $1 \leq p \leq \infty$.
Our particular notion of Poincar\'e--Friedrichs inequality, which we interpret as an upper bound for the operator norm of a generalized inverse of the gradient is more natural for our discussion because later sections will develop analogous inequalities for the curl and the divergence operators. 

\begin{remark}
    Let us further remark why the above notion of Poincar\'e--Friedrichs inequality suits our discussion better than the Poincar\'e inequality. 
    We want to generalize the discussion to the curl and divergence operators. 
    The kernel of the gradient is the one-dimensional space of constant functions, and is thus complemented in the Lebesgue spaces with a canonical choice of projection. 
    By contrast, the curl and divergence operators have infinite-dimensional kernels. 
    Hence, it is not clear a priori whether these kernels are complemented subspaces and admit a projection onto them, not to mention a canonical projection. 
    % The kernel of those operators is infinite-dimensional, whereas the gradient only has a one-dimensional kernel. 
    % When discussing Banach spaces, there is no canonical orthogonal projection on the kernel, unlike in the Hilbert space case, 
    % which is why the Poincar\'e--Friedrichs inequality seems to be the more natural approach.
\end{remark}


% See the collection at Lemma 3.24
% https://hal.science/hal-03226049/file/volI_hal.pdf


We now collect examples for Poincar\'e--Friedrich inequalities for important special cases; see also~\cite{ern2021finite} for a short overview. Over convex bounded domains, it is known~\cite{bebendorf2003note,acosta2004optimal} that 
\begin{align}\label{math:acostaduran}
    \| u - u_{\Omega} \|_{L^{1}(\Omega)}
    \leq 
    \frac{\diam(\Omega)}{2}
    \| \nabla u \|_{L^{1}(\Omega)}
    ,
    \quad 
    u \in W^{1,2}(\Omega)
    ,
    \\
    \| u - u_{\Omega} \|_{L^{2}(\Omega)} \label{math:bebendorf}
    \leq 
    \frac{\diam(\Omega)}{\pi}
    \| \nabla u \|_{L^{2}(\Omega)}
    ,
    \quad 
    u \in W^{1,2}(\Omega)
    .
\end{align}
These two estimates are the best possible in the cases $p=1$ and $p=2$, respectively, in terms of the diameter alone. 
Moreover, when $1 < p < \infty$, we know~\cite{chua2006estimates} that
\begin{align}\label{math:chuawheeden}
    \| u - u_{\Omega} \|_{L^{p}(\Omega)}
    \leq 
    C_{{\rm CW},p}
    \diam(\Omega)
    \| \nabla u \|_{L^{p}(\Omega)}
    ,
    \quad 
    u \in W^{1,p}(\Omega)
    ,
\end{align}
where 
\begin{align}
    C_{{\rm CW},p} 
    := 
    \sup\limits_{ v \in C^\infty([0,1]) \setminus \bbR } 
    \frac{ 
        \| v - v_{[0,1]} \|_{L^{p}([0,1])} 
    }{ 
        \| \nabla v \|_{L^{p}([0,1])} 
    }
    \leq 
    \sqrt[p]{p} 2^{1-\frac 1 p}
    =
    2
    \left( \frac p 2 \right)^{\frac 1 p}
    .
\end{align}
In addition to that,
according to~\cite[Theorem~1]{esposito2013poincare}, when $2 \leq p < \infty$, one can show that 
\begin{align}\label{math:esposito:pf}
    \min\limits_{ c \in \bbR }
    \| u - c \|_{L^{p}(\Omega)}
    \leq 
    C_{\rm{ENT},p}
    \diam(\Omega)
    \| \nabla u \|_{L^{p}(\Omega)}
    ,
    \quad 
    u \in W^{1,p}(\Omega)
    ,
\end{align}
where 
\begin{align}
    C_{\rm{ENT},p}
    :=
    \frac{ p \sin(\pi/p) }{ 2\pi \sqrt[p]{p-1} }
    .
\end{align}
The constant $C_{\rm{ENT},p}$ is the best possible. 
Note that the last inequalities imply, again when $2 \leq p < \infty$, the Poincar\'e inequalities
\begin{align}\label{math:esposito:poincare}
    \| u - u_{\Omega} \|_{L^{p}(\Omega)}
    \leq 
    2^{1-\frac 2 p}C_{\rm{ENT},p}
    \diam(\Omega)
    \| \nabla u \|_{L^{p}(\Omega)}
    ,
    \quad 
    u \in W^{1,p}(\Omega)
    .
\end{align}
The main feature in proving these results is that the best constant in the Poincar\'e inequality is already the constant in the $1$-dimensional case. 

\begin{remark}
    Let us compare the different estimates for the Poincar\'e inequality in the case $2 \leq p$. 
    We observe 
    \begin{align*}
        2^{1-\frac 2 p}
        C_{\rm{ENT},p}
        =
        2 
        \frac{ p \sin(\pi/p) }{ 2\pi \sqrt[p]{p-1} \cdot 4^{\frac 1 p} }
        =
        \frac{ p \sin(\pi/p) }{ 4^{\frac 1 p} \pi  \sqrt[p]{p-1}  }
        \leq 
        \frac{ p \sin(\pi/p) }{ 4^{\frac 1 p} \pi  }
        \leq 
        \frac{1}{ 4^{\frac 1 p} }
        .
    \end{align*}
    It follows that \eqref{math:esposito:poincare} is tighter estimate than \eqref{math:chuawheeden}.
    In the limit as $p$ goes to infinity, \eqref{math:esposito:poincare} implies the Poincar\'e inequality 
    \begin{align*}
        \| u - u_{\Omega} \|_{L^{\infty}(\Omega)}
        \leq 
        \diam(\Omega)
        \| \nabla u \|_{L^{\infty}(\Omega)}
        ,
        \quad
        u \in W^{1,\infty}(\Omega)
        %
    \end{align*}
    because the $L^{\infty}$-norm is the limit of the $L^{p}$-norm. 
    Of course, this Poincar\'e inequality implies a Poincar\'e--Friedrichs inequality with the same constant. 
%     Taking the \emph{informal} limit also suggest the inequality 
%     \begin{align*}
%         \min\limits_{ c \in \bbR }
%         \| u - c \|_{L^{\infty}(\Omega)}
%         \leq 
%         \frac{d}{2}
%         \| \nabla u \|_{L^{\infty}(\Omega)}
%         ,
%         \quad
%         u \in W^{1,\infty}(\Omega)
%         ,
%     \end{align*}
%     however, we generally cannot exchange the minimum and the limit, so that is strictly informal. 
\end{remark}


% https://www.ams.org/journals/proc/2004-132-01/S0002-9939-03-07004-7/S0002-9939-03-07004-7.pdf
% d/2 in the case $p = 1$ over convex domains 

% https://academic.oup.com/plms/article/93/1/197/1462187
% they formally require that f is Lipschitz. But convex domains are Lipschitz and hence Lipschitz is dense in all Sobolev spaces, right?





% either proceeding simplex by simplex, matching along faces 
% or proceeding patch by patch, matching over intersections
\begin{theorem}
    \color{red}Precise form of the inequality yet to be discussed, though the construction principle is clear.
\end{theorem}

\begin{proof}
 Let $u \in W^{1,p}(\Omega)$. 
 For each $F \in \calT$ of dimension $n-1$, 
 we let $u_F \in W^{1,p}(U_F)$ such that $\nabla u_F = \nabla u$ over $U_F$ and such that $\| u_F \|_{L^{p}(U_F)} \leq C_{{\rm{P}},F} \| \nabla u_F \|_{L^{p}(U_F)}$.
 
 Since $\calT$ is strongly connected, there exists an enumeration of $n$-simplices $T_0, T_1, \dots, T_M$ such that for any $1 \leq m \leq M$ there exists some fixed but arbitrary $0 \leq j < m$ such that $F_m := T_m \cap T_j$ is a face of dimension $n-1$. We write $\Omega_m := \cup_{j=0}^{m} T_m$. Hence $\Omega = \Omega_M$. 
 
 
%  We let $T \in \calT$ be the first $n$-simplex. 
%  There exists We already have 
 
 Suppose that $1 \leq m \leq M$ such that there exists $w_{m-1} \in W^{1,p}(\Omega_{m-1})$ with $\nabla w_{m-1} = \nabla u$ over $\Omega_m$. Hence $c_{\star} := w_{m-1} - u_{|\Omega_{m-1}}$ is a constant. 
 By assumption, $T_{m}$ shares the face $F_{m}$ with $T_{j}$. 
 Since $\nabla u_{F_{m}|T_j} = \nabla w_{m-1|T_j}$,
 there exists a constant $c_{m} := w_{m-1|T_j} - u_{F_{m}|T_j}$.
 We define $u'_{F_m} := u_{F_m} + c_{m} \in W^{1,p}(U_F)$.
 By construction, $\nabla u'_{F_m} = \nabla u_{F_m} = \nabla u_{|U_{F_m}}$ and $u_{F_{m}|T_j} = w_{m-1|T_j}$. 
 But that already implies $u'_{F_m} = u_{|F_m} - c_{\star}$. 
 As we define a measurable function $u'_{\star} \in W^{1,p}(\Omega_m)$ by extending $w_{m-1}$ with $u'_{F_m|T_m}$.
 Moreover, 
 \begin{gather*}
    \| u'_{F_m} \|_{L^{p}(T_m)}
    \leq 
    \| u_{F_m} \|_{L^{p}(T_m)}
    +
    \| c_{m} \|_{L^{p}(T_m)},
    \qquad 
    \| c_{m} \|_{L^{p}(T_m)}
    \leq 
    \frac{ \vol(T_m)^{\frac 1 p} }{ \vol(T_j)^{\frac 1 p} }
    \| c_{m} \|_{L^{p}(T_j)},
    \\ 
    \| c_{m} \|_{L^{p}(T_j)}
    \leq 
    \| w_{m-1}\|_{L^{p}(T_j)} + \| u_{F_{m}} \|_{L^{p}(T_j)} 
    .
 \end{gather*}
 In particular,
 \begin{align*}
    \| w_{m} \|_{L^{p}(T_m)}
    \leq 
    \| u_{F_m} \|_{L^{p}(T_m)}
    +
    \frac{ \vol(T_m)^{\frac 1 p} }{ \vol(T_j)^{\frac 1 p} }
    \| u_{F_{m}} \|_{L^{p}(T_j)}
    +
    \frac{ \vol(T_m)^{\frac 1 p} }{ \vol(T_j)^{\frac 1 p} }
    \| w_{m-1}\|_{L^{p}(T_j)}
    .
 \end{align*}
 In the special case $p < \infty$, we also find 
 \begin{align*}
    \| w_{m} \|_{L^{p}(T_m)}^{p}
    &\leq 
    3^{p-1}
    \| u_{F_m} \|_{L^{p}(T_m)}^{p}
    +
    3^{p-1}
    \frac{ \vol(T_m) }{ \vol(T_j) }
    \| u_{F_{m}} \|_{L^{p}(T_j)}^{p}
    +
    3^{p-1}
    \frac{ \vol(T_m)^{\frac 1 p} }{ \vol(T_j)^{\frac 1 p} }
    \| w_{m-1}\|_{L^{p}(T_j)}^{p}
    \\&\leq 
    3^{p-1}
    \max\left( 1, \frac{ \vol(T_m) }{ \vol(T_j) } \right)
    \| u_{F_m} \|_{L^{p}(U_{F_m})}^{p}
    +
    3^{p-1}
    \frac{ \vol(T_m) }{ \vol(T_j) }
    \| w_{m-1}\|_{L^{p}(T_j)}^{p}
    .
 \end{align*}
 Recursive application provides the desired result. 
\end{proof}

\begin{remark}
    The previous result depends on only a few parameters of the triangulation:
    the length of any traversal from the root simplex,
    the ratios of the volumes of adjacent simplices,
    the Poincar\'e constants on each face patch, and the Poincar\'e constant of the initial simplex. 
    The aforementioned local Poincar\'e constants can generally be estimated in terms of shape-parameters. 
    If the face patches of the triangulation are convex, then better estimates are possible. 
\end{remark}

% https://people.tamu.edu/~guermond//PUBLICATIONS/ern_guermond_m2an_2016.pdf 
% Lemma 5.5

\section{Constructive estimate of $p$-Poincar\'e--Friedrichs constants}
% Repeat for H(curl), H(div), and differential forms 

\section*{Acknowledgments}

\bibliographystyle{plain}
\bibliography{library}

\end{document}
