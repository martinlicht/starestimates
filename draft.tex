\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{fullpage}
\usepackage{hyperref}         % For hypertext links

\input{header}


\begin{document}








\mwl{MV: Why a second theorem? Difference of Theorem~\ref{theorem:poincarefriedrichsestimate:exterior:contraction} wrt Theorem~\ref{theorem:poincarefriedrichsestimate:exterior}? Which is better and when? Add more details to the estimates}
\mwl{MV: There is indeed $\diam(T)^{k}$, with the power $k$? Nothing like this appears in Lemma~\ref{lemma:PFexteriorsimplex}. Moreover, so far, all the constants $C_{{\PF},T,p}$, $C_{{\PF},T_1 \cup T_2,p}$ in Lemma~\ref{lemma:poincarefriedrichsoverfacepatch}, $C_{\PF,T,F,p}$ in Lemma~\ref{lemma:mixedbconsimplex}, or $C_{{\PF},k,\Omega,p}$ in Lemma~\ref{lemma:PFexteriorsimplex} had the diameter $\diam(T)$ inside, only the constants in Section~\ref{subsection: PX_convex} have it outside. Finally, $\Omega$ in the indices is missing, whereas $l$ is superfluous. We should unify.}









\begin{proof}
    By assumption, there exists a shelling $T_0, T_1, \dots, T_{M}$. 
    We write $X_m := \cup_{j=0}^{m} T_j$, $0 \leq m \leq M$, 
    which is by Lemma~\ref{lemma:shell_triang_man} a triangulated $n$-dimensional submanifold with boundary. 
    For $0 < m \leq M$, by the definition of shellability in Section~\ref{subsection:shellability}, 
    $T_{m}$ and $X_{m-1}$ share the interface $\Gamma_{m}$, which is a collection of faces of $T_{m}$. 
    It follows from Lemma~\ref{lemma:existenceofstar} that adding $T_{m}$ completes a star in $\calT$ around the simplex $S_{m} \in \calT$, 
    where $\Minako_{m-1} \subseteq X_{m-1}$ is the complement of $T_{m}$ in that newly completed star. 
    
    We will recursively construct $w \in W^{p}\Alt^{k}(\Omega)$ with $\cartan w = \cartan u$, satisfying the desired bound. 
    Let $u \in W^{p}\Alt^{k}(\Omega)$. 
    First, on $T_0$, from Lemma~\ref{lemma:PFexteriorsimplex}, 
    there exists $w_0 \in W^{p}\Alt^{k}(T_{0})$ satisfying $\cartan w_0 = \cartan u$ over $T_{0}$ together with 
    \begin{gather*}
        \| w_0 \|_{L^{p}(T_{0})} \leq C_{{\PF},k,T_{0},p} \| \cartan u \|_{L^{p}(T_{0})}.
    \end{gather*}
    We define $w_{|T_0} := w_0$. 
    Suppose now that $0 < m \leq M$ such that $w_{|X_{m-1}} \in W^{p}\Alt^{k}(X_{m-1})$ with $\cartan w = \cartan u$ over $X_{m-1}$. 
    This is true for $m = 1$. 
    We now define, as in Equations~(5.12) and~(5.14) of~\cite{ern2020stable} or Equations~(6.7) and~(6.9)~\cite{Chaum_Voh_p_rob_3D_H_curl_24},
    \begin{align} \label{equation:w''_ext_der}
        w_{|T_m} := u_{|T_m} + \Xi_{m}^{\ast}((w - u)|_{\Minako_{m-1}}),
    \end{align}
    where $\Xi_{m} : T_{m} \rightarrow \Minako_{m-1}$ is the reflection mapping
    as $\Xi_{1}$ in Proposition~\ref{proposition:starreflection} and the pullback is defined in~\eqref{equation:pullback}.
    Clearly, $w_{|T_m} \in W^{p}\Alt^{k}(T_{m})$. Moreover,
    \begin{align*}
        \trace_{\Gamma_{m}} w_{|T_m} = \trace_{\Gamma_{m}} w_{|X_{m-1}},
    \end{align*}
    since $u$ is trace continuous over $\Gamma_{m-1}$ and $\Xi_{m}$ is the identity along $\Gamma_{m-1}$, and
    \begin{align*}
        \cartan w = \cartan u \text{ over } T_m,
    \end{align*}
    since $\cartan w = \cartan u$ over $X_{m-1}$ and $\Xi_{m}^{\ast}$ preserves this. Thus
    \begin{align*}
        w_{|X_{m}} \in W^{p}\Alt^{k}(X_{m}) \text{ with } \cartan w_{m} = \cartan u \text{ over } X_{m}. 
    \end{align*}
    
    We want to estimate norms. 
    By construction,
    \begin{align*}
        \| w \|_{L^{p}(T_{m})}
        \leq  
        \| \Xi_{m}^{\ast}(w_{|\Minako_{m-1}}) \|_{L^{p}(T_{m})}
        + 
        \| u - \Xi_{m}^{\ast}(u_{|\Minako_{m-1}}) \|_{L^{p}(T_{m})}
        .
    \end{align*}
    Due to Lemma~\ref{lemma:mixedbconsimplex:exteriorderivative}, since $\trace_{\Gamma_{m-1}} (u_{|T_m} - \Xi_{m}^{\ast}(u_{|\Minako_{m-1}})) = 0$, we have
    \begin{align*}
        \| u - \Xi_{m}^{\ast}(u_{|\Minako_{m-1}}) \|_{L^{p}(T_{m})} 
        &
        \leq 
        C_{\PF,T_{m},\Gamma_{m},k,p} (\| \cartan u      \|_{L^{p}(T_{m})} 
        + \| \cartan (\Xi_{m}^{\ast}(u_{|\Minako_{m-1}})) \|_{L^{p}(T_{m})} )
        .
    \end{align*}
    We also use Proposition~\ref{proposition:pullbackestimate} to find 
    \begin{align*}
        \| \Xi_{m}^{\ast}(w_{|\Minako_{m-1}}) \|_{L^{p}(T_{m})}
        &\leq 
        \|\det(\Jacobian \Xi_{m}  )\|^{-\frac 1 p}_{L^{\infty}(\Minako_{m-1})} 
        \| \Jacobian \Xi_{m} \|^{k}_{L^{\infty}(T_{m})}
        \| w \|_{L^{p}(\Minako_{m-1})}
        ,
        \\
        \| \cartan (\Xi_{m}^{\ast}(w_{|\Minako_{m-1}})) \|_{L^{p}(T_{m})}
        &\leq 
        \|\det(\Jacobian \Xi_{m}  )\|^{-\frac 1 p}_{L^{\infty}(\Minako_{m-1})} 
        \| \Jacobian \Xi_{m} \|^{k+1}_{L^{\infty}(T_{m})}
        \| \cartan u \|_{L^{p}(\Minako_{m-1})}
        ,
    \end{align*}
	\begin{align*}
        \| \Xi_{m}^{\ast}(w_{|\Minako_{m-1}}) \|_{L^{p}(T_{m})}
        &\leq 
        |\det(\Jacobian \Xi_{m}  )|^{-\frac 1 p}_{L^{\infty}(\Minako_{m-1})} 
        \| \Jacobian \Xi_{m} \|^{k}_{L^{\infty}(T_{m})}
        \| w \|_{L^{p}(\Minako_{m-1})}
        ,
        \\
        \| \cartan (\Xi_{m}^{\ast}(w_{|\Minako_{m-1}})) \|_{L^{p}(T_{m})}
        &\leq 
        |\det(\Jacobian \Xi_{m}  )|^{-\frac 1 p}_{L^{\infty}(\Minako_{m-1})} 
        \| \Jacobian \Xi_{m} \|^{k+1}_{L^{\infty}(T_{m})}
        \| \cartan u \|_{L^{p}(\Minako_{m-1})}
        ,
    \end{align*}
    where we have employed that $\cartan w = \cartan u$ over $X_{m-1}$. 
    Using the properties of the reflection mapping in Proposition~\ref{proposition:starreflection}, the desired recursive estimate follows. 
\end{proof}





















\begin{proof}
    We begin with the following preparatory observations. 
    Consider any $n$-simplex $T$ with vertices $v_0, v_1, \dots, v_n$, where $v_0$ is the origin. 
    We let $A_{T} \in \bbR^{n \times n}$ be the matrix that maps the $i$-th unit vector to $v_i$.
    That matrix maps the reference simplex $\Delta^{n}$ onto $T$. 
    Then the mapping 
    \begin{align}
        F_T(x) 
        = 
        \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } x
    \end{align}
    maps $T$ onto a ``simplex with a curved face'' inside the Euclidean unit ball. Its inverse is
    \begin{align}
        F_T^{-1}(x) 
        = 
        \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } x
        .
    \end{align}
    We analyze its Lipschitz properties.
    % 
    In what follows, $y \in \bbR^{n}$. 
    On the one hand, 
    we compute the Jacobian at any $x \in \mathring T$:
    \begin{align*}
        \Jacobian F_T(x) \cdot y
        &= 
        \frac{ \|x\| y - x \|x\|^{-1} x^t y }{\|x\|^2} 
        \left( \vecone \cdot A_{T}^{-1} x \right)
        + 
        \frac{x}{\|x\|} \left( \vecone \cdot A_{T}^{-1} y \right)
        \\&= 
        \left( \Id - \|x\|^{-2} x \otimes x^t \right)
        \frac{ 1 }{ \|x\| } 
        \left( \vecone \cdot A_{T}^{-1} x \right)
        + 
        \frac{x}{\|x\|} \left( \vecone \cdot A_{T}^{-1} x \right)
        \\&= 
        \left( A_{T}^{-t} \vecone \cdot \hat x \right)
        \left( \Id - \hat x \otimes \hat x^t \right) y
        + 
        \left( A_{T}^{-t} \vecone \cdot y \right) \hat x 
        .
    \end{align*}
    This is an orthogonal sum of two vectors. Its norm satisfies:
\begin{align*}
        \| \Jacobian F_T(x) \cdot y \|^{2}
        &= 
        \left| A_{T}^{-t} \vecone \cdot \hat x \right|^{2}
        \| \left( \Id - \hat x \otimes \hat x^t \right) y \|^{2}
        + 
        \left| A_{T}^{-t} \vecone \cdot y \right|^{2} \| \hat x \|^{2}
        .
    \end{align*}
    The Euclidean operator norm satisfies 
    \begin{align*}
        \| \Jacobian F_T(x) \| 
        \leq 
        \sqrt 2 \left\| A_{T}^{-t} \vecone \right\|_{2}
        \leq 
        \sqrt{2n} \cdot \sigma_{\max}(A_{T}^{-1}) 
        .
    \end{align*}
    On the other hand, we can rewrite the Jacobian as:
    \begin{align*}
        \Jacobian F_T(x) \cdot y
        &= 
        \left( A_{T}^{-t} \vecone \cdot \hat x \right)
        y
        - 
        \left( A_{T}^{-t} \vecone \cdot \hat x \right)
        \left( \hat x \otimes \hat x^t \right) y
        + 
        \left( A_{T}^{-t} \vecone \cdot y \right) \hat x 
        \\&= 
        \left( A_{T}^{-t} \vecone \cdot \hat x \right)
        y
        - 
        \hat x 
        \left( 
            \left( A_{T}^{-t} \vecone \cdot \hat x \right) \hat x^{t}
            -
            \vecone^{t} A_{T}^{-1} 
        \right) y
        \\&= 
        \left( A_{T}^{-t} \vecone \cdot \hat x \right)
        y
        - 
        \hat x 
        \left( 
            \left( A_{T}^{-t} \vecone \cdot \hat x \right) \hat x
            -
            A_{T}^{-t} \vecone
        \right)^{t} y
        .
    \end{align*}
    Its inverse is found via the Woodbury formula: 
    % Its inverse is easily verified to be:
    \begin{align*}
        \Jacobian F_T(x)^{-1}
        &= 
        \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-1}
        \Id
        - 
        \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-2}
        \hat x 
        \left( 
            \left( A_{T}^{-t} \vecone \cdot \hat x \right) \hat x
            -
            A_{T}^{-t} \vecone
        \right)^{t} 
        \\&= 
        \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-1}
        \left( 
            \Id
            - 
            \hat x 
            \left( 
                % \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-1}
                % \left( A_{T}^{-t} \vecone \cdot \hat x \right) 
                \hat x
                -
                \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-1}
                A_{T}^{-t} \vecone
            \right)^{t}
        \right)
        \\&= 
        \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
        \left( 
            \Id
            - 
            \hat x 
            \left( 
                % \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-1}
                % \left( A_{T}^{-t} \vecone \cdot \hat x \right) 
                \hat x
                -
                \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
                A_{T}^{-t} \vecone
            \right)^{t}
        \right)
        \\&= 
        \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
        \left( 
            \Id - \hat x \otimes \hat x^{t}
            + 
            \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
            \hat x \otimes \vecone^{t} A_{T}^{-1}
        \right)
        .
    \end{align*}
    The inverse acts via multiplication with $\left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}$ on the span of $\hat x$.
    We notice the upper bound 
    \begin{align*}
        \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
        &= 
        \| A_{T}^{-1} \hat x \|^{-1}_{1}
        \\&\leq  
        \| A_{T}^{-1} \hat x \|^{-1}_{2}
        \leq 
        \sigma_{\min}( A_{T}^{-1} )^{-1}
        = 
        \sigma_{\max}( A_{T} )
        .
    \end{align*}
    This holds because $A_{T}^{-1} \hat x$ is in the positive quadrant.
    %, and its scalar product with $\vecone$ is minimized when it is colinear with a coordinate axis.
    If $y \in \bbR^{n}$ is orthogonal to $\hat x$, then 
    \begin{align*}
        \| \Jacobian F_T(x)^{-1} \cdot y \|^{2}
        &\leq 
%             \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-2}
%             \left\| 
%                 y
%             \right\|^{2}
%             +
%             \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-2}
%             \left| 
%                 \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
%                 \vecone^{t} A_{T}^{-1} y 
%             \right|^{2}
%             \\&\leq 
        \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-2}
        \left\| 
            y
        \right\|^{2}
        +
        \frac{ 
        \left| 
            \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
            \vecone^{t} A_{T}^{-1} y 
        \right|^{2}
        }{
        \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{2}
        }
        .
    \end{align*}
    The operator norm of that inverse is:
    \begin{align*}
        \| \Jacobian F_T(x)^{-1} \|
        \leq 
        \sigma_{\max}( A_{T} )
        \left( 1 + n \frac{ \sigma_{\max}(A_{T})^{2} }{ \sigma_{\min}(A_{T})^{2} } \right)^{\frac 1 2}
        .
    \end{align*}
    Since the domain and codomain of $F_{T}$ are convex, 
    this also implies bounds on the Lipschitz constants of $F_{T}$ and its inverse. 
\color{red}
    On the one hand, given $x, y \in T$, 
    where $\| y \|_{1} \leq \| x \|_{1}$ without loss of generality, we find 
    \begin{align*}
        &
        \left\| F_T(x) - F_T(y) \right\|_{2}
        \\&\qquad 
        \leq 
        \left\| 
            \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } x - \frac{ \| A_{T}^{-1} y \|_{1} }{ \|y\|_2 } y
        \right\|_{2}
        \\&\qquad 
        \leq 
        \left\| 
            \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } x - \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } y
        \right\|_{2}
        +
        \left\| 
            \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } y - \frac{ \| A_{T}^{-1} y \|_{1} }{ \|y\|_2 } y
        \right\|_{2}
        \\&\qquad 
        \leq 
        \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } 
        \left\| 
            x - y
        \right\|_{2}
        +
        \left| \|A_{T}^{-1} x\|_1 - \|A_{T}^{-1} y\|_1 \right|
        \\&\qquad 
        \leq 
        2\sqrt{n} \sigma_{\max}(A_{T}^{-1}) 
        \left\| x - y \right\|_{2}
        .
    \end{align*}
    On the one hand, given $x, y \in T$, 
    where $\| x \|_{2} \leq \| y \|_{2}$ without loss of generality, we find 
    \begin{align*}
        &
        \left\| F_T(x) - F_T(y) \right\|_{2}
        \\&\qquad 
        \leq 
        \left\| 
            \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } x - \frac{ \| A_{T}^{-1} y \|_{1} }{ \|y\|_2 } y
        \right\|_{2}
        \\&\qquad 
        \leq 
        \left\| 
            \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } x - \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } y
        \right\|_{2}
        +
        \left\| 
            \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } y - \frac{ \| A_{T}^{-1} y \|_{1} }{ \|x\|_2 } y
        \right\|_{2}
        +
        \left\| 
            \frac{ \| A_{T}^{-1} y \|_{1} }{ \|x\|_2 } y - \frac{ \| A_{T}^{-1} y \|_{1} }{ \|y\|_2 } y
        \right\|_{2}
        \\&\qquad 
        \leq 
        \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } 
        \left\| 
            x - y
        \right\|_{2}
        +
        \left| \|A_{T}^{-1} x\|_1 - \|A_{T}^{-1} y\|_1 \right|
        \frac{\|y\|}{\|x\|}
        +
        \|A_{T}^{-1} y\|_1 \|y\|_{2}
        \left| \frac{1}{\|x\|} - \frac{1}{\|y\|} \right|
        \\&\qquad 
        \leq 
        \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } 
        \left\| 
            x - y
        \right\|_{2}
        +
        \left| \|A_{T}^{-1} x\|_1 - \|A_{T}^{-1} y\|_1 \right|
        \frac{\|y\|}{\|x\|}
        +
        \|A_{T}^{-1} y\|_1 \|y\|_{2}
        \left| \frac{ \|y\|_{2} - \|x\|_{2} }{\|x\|_{2} \|y\|_{2}} \right|
        \\&\qquad 
        \leq 
        3 \sqrt{n} \sigma_{\max}(A_{T}^{-1}) 
        \left\| x - y \right\|_{2}
        .
    \end{align*}
    On the other hand, given $x, y \in F_T(T)$, 
    where $\| A_{T}^{-1} y \|_{1} \leq \| A_{T}^{-1} x \|_{1}$ without loss of generality, we find 
    \begin{align*}
        &
        \left\| F_T^{-1}(x) - F_T^{-1}(y) \right\|_{2}
        \\&\qquad 
        \leq 
        \left\| 
            \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } x - \frac{ \|y\|_2 }{ \| A_{T}^{-1} y \|_{1} } y
        \right\|_{2}
        \\&\qquad 
        \leq 
        \left\| 
            \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } x - \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } y
        \right\|_{2}
        +
        \left\| 
            \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } y - \frac{ \|y\|_2 }{ \| A_{T}^{-1} x \|_{1} } y
        \right\|_{2}
        +
        \left\| 
            \frac{ \|y\|_2 }{ \| A_{T}^{-1} x \|_{1} } y - \frac{ \|y\|_2 }{ \| A_{T}^{-1} y \|_{1} } y
        \right\|_{2}
        \\&\qquad 
        \leq 
        \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } 
        \left\| 
            x - y
        \right\|_{2}
        +
        \left| \|x\|_2 - \|y\|_2 \right|
        \frac{ \|y\|_2 }{ \| A_{T}^{-1} x \|_{1} }
        +
        \|y\|_2^{2}
        \left| 
        \frac{ \| A_{T}^{-1} y \|_{1} - \| A_{T}^{-1} x \|_{1} }{ \| A_{T}^{-1} x \|_{1} \| A_{T}^{-1} y \|_{1} }
        \right|
        \\&\qquad 
        \leq 
        \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{2} } 
        \left\| 
            x - y
        \right\|_{2}
        +
        \left| \|x\|_2 - \|y\|_2 \right|
        \frac{ \|y\|_2 }{ \| A_{T}^{-1} x \|_{2} }
        +
        \|y\|_2^{2}
        \left| 
        \frac{ \| A_{T}^{-1} y \|_{1} - \| A_{T}^{-1} x \|_{1} }{ \| A_{T}^{-1} x \|_{2} \| A_{T}^{-1} y \|_{2} }
        \right|
        \\&\qquad 
        \leq 
        \left( 2 + \sqrt{n} \frac{\sigma_{\max}(A_{T}^{-1}) }{ \sigma_{\min}(A_{T}^{-1}) } \right) \sigma_{\min}(A_{T}^{-1})^{-1} 
        \left\| x - y \right\|_{2}
        \\&\qquad 
        \leq 
        \left( 2 + \sqrt{n} \kappa(A_{T}) \right) \sigma_{\max}(A_{T})
        \left\| x - y \right\|_{2}
        .
    \end{align*}
    By convexity of the range of $F_T(T)$, 
    we obtain a bound on the operator norm of the Jacobian of $F_{T}^{-1}$. 
    We recall that $\sigma_{\max}(A_{T}^{-1}) = \sigma_{\min}(A_{T})^{-1}$ and $\sigma_{\min}(A_{T}^{-1})^{-1} = \sigma_{\max}(A_{T})$.
    \color{black}
\end{proof}        















\section{{Nonlinear and linear potentials, the Poincar\'e--Friedrichs and Poincar\'e inequalities, and {analytical} Poincar\'e--Friedrichs constants in the gradient case}} \label{section:poincare} 

\mwl{
In this section, we wish to explain why we employ linear potential operators to estimate the Poincar\'e--Friedrichs constants and we also address the difference of the Poincar\'e--Friedrichs inequality~\eqref{math:PF_gradient_2} with the Poincar\'e inequality where the mean value of $u$ is fixed to zero. We then review Poincar\'e--Friedrichs inequalities in the gradient case setting of Section~\ref{section:intro_grad}, with the emphasis on know results on analytical upper bounds for the constants. In particular, we take the opportunity to discuss bounded convex domains as a special case. 
This survey serves as a building block in constructing computable constants over triangulated domains in a combinatorial way below but we believe it is also of independent interest.

It is generally easier to obtain upper bounds Constructing and analyzing a potential operator is generally easier if the potential is linear. 
Constructing linear potential operators is generally easier 
We will extend that construction of the potential when we address Poincar\'e--Friedrichs inequalities for the curl and divergence operators. 

% Our particular notion of Poincar\'e--Friedrichs inequality, which we interpret as an upper bound for the operator norm of a generalized inverse of the gradient is more natural for our discussion because later sections will develop analogous inequalities for the curl and the divergence operators. 
}


In this section, we wish to explain why we employ linear potential operators to estimate the Poincar\'e--Friedrichs constants and we also address the difference of the Poincar\'e--Friedrichs inequality~\eqref{math:PF_gradient_2} with the Poincar\'e inequality where the mean value of $u$ is fixed to zero. We then review Poincar\'e--Friedrichs inequalities in the gradient case setting of Section~\ref{section:intro_grad}, with the emphasis on know results on analytical upper bounds for the constants. In particular, we take the opportunity to discuss convex domains as a special case. This survey serves as a building block in constructing computable constants over triangulated domains in a combinatorial way below but we believe it is also of independent interest.


\subsection{Nonlinear and linear potentials}

In the Banach setting $p \neq 2$, finding a norm-minimizing potential such as $\Phi_{\grad}( \bff )$ of~\eqref{math:pot_grad_def} for a given gradient $\bff$ is a nonlinear operation. Its existence may actually not be guaranteed unless $1 < p < \infty$. 
However, any \textit{linear} potential operator $\overline\Phi_{\grad} : \nabla W^{1,p}(\Omega) \rightarrow L^{p}(\Omega)$
satisfying $\nabla \overline\Phi_{\grad}( \bff ) = \bff$ for any $\bff \in \nabla W^{1,p}(\Omega)$ has the operator norm that \cye{gives} the upper bound 
\begin{align}\label{math:PF_P}
    \mwl{C_{\grad,\Omega,p} = } 
    \max\limits_{ u \in W^{1,p}(\Omega) \setminus \bbR } 
    \frac{ \| \Phi_{\grad}(\nabla u) \|_{L^{p}(\Omega)} }{ \| \nabla u \|_{\fooL^{p}(\Omega)} }
    \leq 
    \max\limits_{ u \in W^{1,p}(\Omega) \setminus \bbR } 
    \frac{ \| \overline\Phi_{\grad}(\nabla u) \|_{L^{p}(\Omega)} }{ \| \nabla u \|_{\fooL^{p}(\Omega)} } \cye{=: C_{\varnothing,\Omega,p}}
    .
\end{align}
This explains our interest in the construction of {\em linear potential operators}.

\subsection{Poincar\'e--Friedrichs and Poincar\'e inequalities}

\cye{In the setting of Section~\ref{section:intro_grad}, when $\Omega$ is of finite measure,} a natural \cye{(and unique, since the gradient potential constraint $\nabla \overline \Phi_{\grad}( \bff ) = \bff$ determines $\overline \Phi_{\grad}( \bff )$ up to a constant)} choice \cye{for a linear potential operator} is the average-free potential operator $\overline\Phi_{\grad} : \nabla W^{1,p}(\Omega) \rightarrow L^{p}(\Omega)$ that is prescribed by
\begin{align*}
    \overline\Phi_{\grad}( \nabla u ) \cye{:}= u - u_{\Omega},
    \quad 
    \forall 
    u \in W^{1,p}(\Omega)
    ,
\end{align*}
where $u_\Omega$ denotes the average of $u$ over the domain $\Omega$, that is,
\begin{align*}
    u_{\Omega} := \vol(\Omega)^{-1} \int_{\Omega} u(x) \;dx.
\end{align*}
This potential operator can also implicitly be defined by
\begin{align*}
    \overline \Phi_{\grad}( \bff ) 
    := 
    \argmin\limits_{ \substack{ u \in W^{1,p}(\Omega) \\ \int_\Omega u = 0 } } \| \nabla u - \bff \|_{\fooL^{p}(\Omega)},
    \quad 
    \forall 
    \bff \in \nabla W^{1,p}(\Omega)
    .
\end{align*} 
Its operator norm is the best constant $C_{\varnothing,\Omega,p} > 0$ in the {\em Poincar\'e inequality} (or also Poincar\'e--Wirtinger inequality)
\begin{align}\label{math:P_gradient}
    \| u - u_{\Omega} \|_{L^{p}(\Omega)}
    \leq 
    C_{\varnothing,\Omega,p} \| \nabla u \|_{\fooL^{p}(\Omega)},
    \quad 
    \forall 
    u \in W^{1,p}(\Omega)
    . 
\end{align}
Thus, rephrasing~\eqref{math:PF_P} in terms of~\eqref{math:PF_gradient_2} and~\eqref{math:P_gradient}, 
\begin{align*}
    C_{\grad,\Omega,p} \leq C_{\varnothing,\Omega,p}.
\end{align*}

Towards a converse inequality, 
let us first observe that the average of any $u \in W^{1,p}(\Omega)$ with $p < \infty$ satisfies the bound 
\begin{align} \label{math:aver_norm}
    \| u_\Omega \|_{L^{p}(\Omega)}^{p}
    = 
    \int_{\Omega} \left( \vol(\Omega)^{-1} \int_{\Omega} |u(x)| \;dx \right)^{p}
    \leq 
    \int_{\Omega} \vol(\Omega)^{-1} \int_{\Omega} |u(x)|^{p} \;dx
    = 
    \| u \|_{L^{p}(\Omega)}^{p}
    .
\end{align}
Here, we have used H\"older's or Jensen's inequality. 
In the case $p = \infty$, any $u \in L^{\infty}(\Omega)$ satisfies $\| u_\Omega \|_{L^{\infty}(\Omega)} \leq \| u \|_{L^{\infty}(\Omega)}$. 
We conclude that taking the average is a projection within Lebesgue spaces with unit norm. 
The triangle inequality now shows that 
\begin{align*}
    \| u - u_\Omega \|_{L^{p}(\Omega)} 
    \leq
    2
    \| u \|_{L^{p}(\Omega)},
    \quad 
    \forall
    u \in L^{p}(\Omega)
    .
\end{align*}
\begin{align*}
    \color{Emerald}
    \| u - u_\Omega \|_{L^{p}(\Omega)}^{p}
    \leq 
    2^{p-1} 
    \| u \|_{L^{p}(\Omega)}^{p}
    +
    2^{p-1} 
    \| u_\Omega \|_{L^{p}(\Omega)}^{p}
    \leq 
    2^{p} 
    \| u \|_{L^{p}(\Omega)}^{p}
    .
\end{align*}
\mwl{Via an application of the triangle inequality, }Thus, the Poincar\'e--Friedrichs inequality implies the Poincar\'e inequality with 
\begin{align*}
    C_{\grad,\Omega,p} \leq 2 C_{\varnothing,\Omega,p}.
\end{align*}
In the special case $p=2$, taking the average is an orthogonal projection, 
and so this improves to $\| u - u_\Omega \|_{L^{2}(\Omega)} \leq \| u \|_{L^{2}(\Omega)}$ for any $u \in L^{2}(\Omega)$. 
Hence,
\begin{align*}
    C_{\varnothing,\Omega,2} = C_{\grad,\Omega,2}. 
\end{align*}
\mwl{
This improvement follows from the orthogonality of constant functions to average-free functions in $L^2(\Omega)$,
and it also follows from the projection estimate (see, e.g.,~\cite{xu2003some}).
Stern's generalized projection estimate~\cite[Theorem~4.1,Remark~5.1]{stern2015banach} implies improved estimate for all $L^{p}$ spaces with $1 \leq p \leq \infty$:
since taking the average is a the projection onto the constants functions with unit norm, it now follows that 
}
From~\eqref{math:aver_norm}, Stern's generalized projection estimate~\cite[Theorem~4.1, Remark~5.1]{stern2015banach} implies improved estimate for all $L^{p}$ spaces with $1 \leq p \leq \infty$ as 
\begin{align*}
    \| u - u_\Omega \|_{L^{p}(\Omega)}
    \leq 
    \min\left( 2, 2^{|2/p-1|} \right)
    \| u \|_{L^{p}(\Omega)}
    = 
    2^{|2/p-1|} 
    \| u \|_{L^{p}(\Omega)}
    ,
    \quad 
    \forall 
    u \in L^{p}(\Omega)
    .
\end{align*}
Here, we have used $1 \leq 2^{|2/p-1|} \leq 2$ for $1 \leq p \leq \infty$.
The upper bound is only attained in the limit cases $p = 1$ and $p = \infty$, and the lower bound is only attained if $p = 2$, where we reproduce the improved estimate for the Hilbert space case.
We thus conclude 
\begin{align}\label{math:p_vs_pf}
    C_{\grad,\Omega,p} \leq 2^{|2/p-1|} C_{\varnothing,\Omega,p}.
\end{align}
In summary, our notion of Poincar\'e--Friedrichs constant is equivalent to the notion of Poincar\'e constant in the literature, up to a numerical factor that only depends on $1 \leq p \leq \infty$ and that is at most $2$.

%%%% 




















The remainder of this manuscript is structured as follows.
We review Poincar\'e--Friedrichs constants for the gradient over convex domains in Section~\ref{section:poincare}.
We review basic notions of triangulations in Section~\ref{section:triangulations}.
We develop computable upper bounds for the Poincar\'e--Friedrichs constants for the gradient over face-connected triangulated domains in Section~\ref{section:gradient}.
We review the Sobolev spaces in vector calculus and the calculus of differential forms in Section~\ref{section:calculus}.
Regularized potential operators over convex sets are discussed in Section~\ref{section:potentialoperator}.
We then review the notion of shellable triangulations of manifolds in Section~\ref{section:advancedtriangulations}.
We construct an important geometric reflection operator in Section~\ref{section:extension}
and we finally provide computable upper bounds for Poincar\'e--Friedrichs constants for the exterior derivative over shellable triangulations in Section~\ref{section:poincarefriedrichs}.
We present numerical examples in Section~\ref{section:numericalexamples}. 








We shift gears and move from a combinatorial study of triangulations to an analytical study:
we introduce quantitative measures for the geometric quality of triangulations. 
These indicate of the regularity of simplex shapes. 
All these quantities have in common that they can be computed from purely local information. 
Most of such \emph{shape measures} in the literature are based on geometric features, 
but it will also be helpful to use indicators based on affine transformations associated with the mesh. %;this is because the properties of these transformations are what shows up in our estimates. 
While there are many equivalent shape measures, we use the ones that most immediate appear in our proofs.








\begin{itemize}
        \item 
        We introduce a bi-Lipschitz mapping 
        \begin{align*}
            \Psi : |\calR'| \rightarrow |\calK|
        \end{align*}
        in the following manner. Let ${G} \in \calR'$ be an $n$-dimensional simplex and let $x \in {G}$ be non-zero. There exists a simplex $K \in \calK$ that intersects the ray $\bbR_0^+ \cdot x$.
        We define 
        \begin{align*}
            \Psi(x) 
            = 
            \frac{ \| A_{{G}}^{-1} x \|_{1} }{ \| A_{K}^{-1} x \|_{1} } x
            .
        \end{align*}
        One easily verifies that this defines a continuous mapping $\Psi$. 
        By the same line of thought, we see that it is invertible with inverse 
        \begin{align*}
            \Psi^{-1}(x) 
            = 
            \frac{ \| A_{K}^{-1} x \|_{1} }{ \| A_{{G}}^{-1} x \|_{1} } x
            .
        \end{align*}
        We analyze its Jacobian. 
        First, by assumption,
        \begin{align*}
            \Psi(x) 
            = 
            \frac{ A_{{G}}^{-t} \vecone \cdot x }{ A_{K}^{-t} \vecone \cdot x } x
            .
        \end{align*}
        In what follows, $y \in \bbR^n$. We observe 
        \begin{align*}
            \Jacobian \Psi(x) \cdot y 
            &= 
            \frac{ 
                ( A_{{G}}^{-t} \vecone \cdot y ) 
                ( A_{K}^{-t} \vecone \cdot x )
                -
                ( A_{{G}}^{-t} \vecone \cdot x )
                ( A_{K}^{-t} \vecone \cdot y ) 
            }{ 
                ( A_{K}^{-t} \vecone \cdot x )^2
            } 
            x
            + 
            \frac{ A_{{G}}^{-t} \vecone \cdot x }{ A_{K}^{-t} \vecone \cdot x } y
            \\&= 
            \frac{ 
                ( A_{{G}}^{-t} \vecone \cdot y ) 
            }{ 
                ( A_{K}^{-t} \vecone \cdot  x )
            } 
            x
            -
            \frac{ 
                ( A_{{G}}^{-t} \vecone \cdot x )
                ( A_{K}^{-t} \vecone \cdot y ) 
            }{ 
                ( A_{K}^{-t} \vecone \cdot  x )^2
            } 
            x
            + 
            \frac{ A_{{G}}^{-t} \vecone \cdot x }{ A_{K}^{-t} \vecone \cdot  x } y
            \\&= 
            \frac{ 
                ( A_{{G}}^{-t} \vecone \cdot y ) 
            }{ 
                ( A_{K}^{-t} \vecone \cdot  x )
            } 
            x
            +
            \frac{ A_{{G}}^{-t} \vecone \cdot x }{ A_{K}^{-t} \vecone \cdot  x } 
            \left( 
                y
                -
                \frac{ 
                    ( A_{K}^{-t} \vecone \cdot y ) 
                }{ 
                    ( A_{K}^{-t} \vecone \cdot  x ) 
                } 
                x
            \right)
            .
        \end{align*}
        We see that the last summand is an oblique projection of $y$. 
        The vector $A_{K}^{-1} x$ has length at least $\sigma_{\min}( A_{K}^{-1} ) \| x \|$ and the product with $\vecone$ is smallest when the vector is colinear with one of the coordinate axes. We conclude that 
        \[
             A_{K}^{-t} \vecone \cdot x 
             = 
             \vecone \cdot A_{K}^{-1} x 
             \geq 
             \sigma_{\min}( A_{K}^{-1} ) \| x \|.
        \]
        Together with the Xu-Zikatanov inequality, we obtain the upper bound 
        \begin{align*}
            \matnorm{ \Jacobian \Psi(x) }
            &\leq 
            \sqrt{n}
            \frac{ \sigma_{\max}( A_{{G}}^{-1} ) }{ \sigma_{\min}( A_{K}^{-1} ) }
            \left( 
            1
            + 
            n
            \frac{ \sigma_{\max}( A_{{G}}^{-1} ) \sigma_{\max}( A_{K}^{-1} ) }{ \sigma_{\min}( A_{K}^{-2} ) }
            \right) 
            .
        \end{align*}
        By completely analogous arguments, we find 
        \begin{align*}
            \matnorm{ \Jacobian \Psi^{-1}(x) }
            &\leq 
            \sqrt{n}
            \frac{ \sigma_{\max}( A_{K}^{-1} ) }{ \sigma_{\min}( A_{{G}}^{-1} ) }
            \left( 
            1
            + 
            n
            \frac{ \sigma_{\max}( A_{K}^{-1} ) \sigma_{\max}( A_{{G}}^{-1} ) }{ \sigma_{\min}( A_{{G}}^{-2} ) }
            \right) 
            .
        \end{align*}
        It follows that 
        \begin{align*}
            \Xi := \Psi \circ \Theta
        \end{align*}
        is a mapping from ${G}$ onto $U = \overline{\patch_{\calT}(S) \setminus {G}}$.
        It preserves the interface from ${G}$ onto $U$. 
        
        \item 
        \color{red}
        We show that every function that is piecewise Lipschitz with respect to the triangulation $\calK$ must be Lipschitz over all of $|\calK|$. 
        We use a technique similar to Lemma~\ref{lemma:stars_are_shellable}. 
        After application of a piecewise linear Lipschitz mapping, 
        we can assume that $|\calK|$ is convex without loss of generality. 
        Any function piecewise Lipschitz with respect to $\calK$ must be Lipschitz over $|\calK|$. 
        
        A similar argument applies to the triangulation $\calR'$. 
        We conclude that $\Xi$ is bi-Lipschitz. 
        \color{black}
        
        \item 
        \color{red}
        We collect several geometric facts. 
        
        
        \item 
        We need to estimate the singular values of the transformation matrices within the bisected simplices. 
        Each bisection step reduces the diameter by at most a factor of one half,
        and it reduces the volume always by a factor of one half. 
        We use the estimates in Lemma~\ref{lemma:measurerelationships}.
        When $K \in \calK \cup \calS'r$, then 
        \begin{align*}
             \sigma_{\max}( A_{K}^{-1} )
             &\leq 
             \Czwei{n} \geometricshapemeasure(K) \diam(K)
             \leq 
             2 \Czwei{n} \geometricshapemeasure(\calT) \diam(K)^{-1}
             \\
             \sigma_{\min}( A_{K}^{-1} )^{-1}
             &= 
             \sigma_{\max}( A_{K} ) 
             \leq 
             \Ceins{n} \diam(K),
             \\ 
             \geometricshapemeasure( A_{K} )
             &\leq 
             \Cdrei{n} \geometricshapemeasure(K) \leq 2 \Cdrei{n} \geometricshapemeasure(\calT)
             .
        \end{align*}
        When ${G} \in \calR'$ is not our original simplex, then 
        \begin{align*}
             \sigma_{\max}( A_{{G}}^{-1} )
             &\leq 
             \Czwei{n} \geometricshapemeasure({G}) \diam({G})
             \leq 
             4 \Czwei{n} \geometricshapemeasure(\calT) \diam(G)^{-1},
             \\
             \sigma_{\min}( A_{{G}}^{-1} )^{-1}
             &= 
             \sigma_{\max}( A_{{G}} ) 
             \leq 
             \Ceins{n} \diam({G}),
             \\ 
             \geometricshapemeasure( A_{{G}} )
             &\leq 
             \Cdrei{n} \geometricshapemeasure({G}) \leq 4 \Cdrei{n} \geometricshapemeasure(\calT)
             .
        \end{align*}
        All the diameters above are comparable up to a factor of $\diameterratio(\calT)$.
        In summary,
        \begin{gather*}
            \matnorm{ \Jacobian \Theta_{|K}      } \leq 2 \Cdrei{n} \geometricshapemeasure(\calT)
            ,
            \qquad 
            \matnorm{ \Jacobian \Theta_{|K}^{-1} } \leq 2 \Cdrei{n} \geometricshapemeasure(\calT)
            ,
            \\
            \matnorm{ \Jacobian \Xi(x) }
            \leq 
            \sqrt{n}
            4 
            \geometricshapemeasure(\calT) 
            \Ceins{n} 
            \Czwei{n} 
            \diameterratio(\calT) % \frac{ \diam(K) }{ \diam(G) }
            \left( 
                1
                + 
                n
                2 \Cdrei{n} \geometricshapemeasure(\calT)
                4 
                \geometricshapemeasure(\calT) 
                \Ceins{n} 
                \Czwei{n} 
                \diameterratio(\calT) % \frac{ \diam(K) }{ \diam(G) }
            \right) 
            2 \Cdrei{n} \geometricshapemeasure(\calT)
            ,
            \\
            \matnorm{ \Jacobian \Xi^{-1}(x) }
            \leq 
            \sqrt{n}
            2 
            \geometricshapemeasure(\calT) 
            \Ceins{n} 
            \Czwei{n} 
            \diameterratio(\calT) % \frac{ \diam(G) }{ \diam(K) }
            \left( 
                1
                + 
                n
                2 \Cdrei{n} \geometricshapemeasure(\calT)
                2 
                \geometricshapemeasure(\calT) 
                \Ceins{n} 
                \Czwei{n} 
                \diameterratio(\calT) % \frac{ \diam(G) }{ \diam(K) }
            \right) 
            2 \Cdrei{n} \geometricshapemeasure(\calT)
            .
        \end{gather*}
\end{itemize}





 \mwl{First estimate, alternative description}
    We use a recursive argument.
    Suppose that $0 < m \leq M$ such that there exists $w_{\iota(m)} \in W^{1,p}(\Omega_{\iota(m)})$ with $c_{0} = u - w_{\iota(m)}$.
    In particular, $\nabla w_{\iota(m)} = \nabla u$ over $\Omega_{\iota(m)}$. 
    By assumption, $T_{m}$ shares the face $F_{m}$ with $T_{\iota(m)}$. 
    % Let $\hat T$ be the reference simplex.
    % We fix affine diffeomorphisms $\varphi : \hat T \rightarrow T_{j(m)}$ and $\vartheta : \hat T \rightarrow T_{m+1}$,
    % each of which maps the convex closure of $v_0, \dots, v_{n-1}$ onto the common face $F_{m}$.
    %
    We define $w'_{m} := w_{\iota(m)} \circ \Xi \in W^{1,p}(T_{m})$,
    where $\Xi : T_{m} \rightarrow T_{\iota(m)}$ is the unique affine diffeomorphism that leaves $F_{m}$ invariant. 
    %
    By construction, $w'_{m} \in W^{1,p}(T_{m})$ with 
    \begin{align*}
        \trace_F w_{\iota(m)} = \trace_F w'_{m}
        .
    \end{align*}
    %Write $w''_{m} = u - w'_{m} \in W^{1,p}(T_{m})$. Then 
    There exists $w''_{m} \in W^{1,p}(T_{m})$ such that 
    \begin{align*}
        \nabla w''_{m} = \nabla u_{|T_{m+1}} - \nabla w'_{m}, 
        \quad 
        \trace_{F_{m}} w''_{m} = 0.
    \end{align*}
    This is true because 
    \begin{align*}
        \trace_{F_{m}}( \nabla u - \nabla w'_{m} ) 
        &= 
        \trace_{F_{m}} \nabla u - \trace_{F_{m}} \nabla w'_{m}
        \\&= 
        \nabla \trace_{F_{m}} u - \nabla \trace_{F_{m}} w'_{m}
        = 
        \nabla \trace_{F_{m}} u - \nabla \trace_{F_{m}} w_{\iota(m)}
        = 
        0
        .
    \end{align*}
    Setting $w_{m} := w_{\iota(m)}$ over $\Omega_{\iota(m)}$ and $w_{m} := w'_{m} + w''_{m}$ over $T_{m}$, 
    we find 
    \begin{gather*}
        \nabla w_{m} = \nabla w'_{m} + \nabla w''_{m} = \nabla w'_{m} + \nabla u - \nabla w'_{m} = \nabla u,
        % \end{gather*}
        \\
        % \begin{gather*}
        \trace_{F_{m}} w_{m} = \trace_{F_{m}} w'_{m} = \trace_{F_{m}} w_{\iota(m)}.
    \end{gather*}
    That means that $w_{m} \in W^{1,p}(\Omega_{m})$ with $\nabla w_{m} = \nabla u$ over $\Omega_{m}$. 
    In particular, $c_{0} = u - w_{m}$. 
    Lemma~\ref{lemma:mixedbconsimplex} gives 
    \begin{align*}
        \| w''_{m} \|_{L^{p}(T_{m})} 
        &
        \leq 
        C_{\PF,T_{m},F_{m},p} \| \nabla u - \nabla w'_{m} \|_{L^{p}(T_{m})}.
        \\&
        \leq 
        C_{\PF,T_{m},F_{m},p} \| \nabla u      \|_{L^{p}(T_{m})} 
        + 
        C_{\PF,T_{m},F_{m},p} \| \nabla w'_{m} \|_{L^{p}(T_{m})} 
        .
    \end{align*}
    We also employ Lemma~\ref{lemma:volumecomparison} to find 
    \begin{align*}
        \| \nabla w'_{m} \|_{L^{p}(T_{m})}
        &
        \leq 
        |\det(\Jacobian \Xi  )|^{-\frac 1 p} 
        \matnorm{ \Jacobian \Xi   }
        \cdot 
        \| \nabla w_{\iota(m)} \|_{L^{p}(T_{\iota(m)})}
        \\&
        \leq 
        \volumeratio(\calT)^{\frac 1 p} \reflectionestimate(\calT)
        \cdot 
        \| \nabla w_{\iota(m)} \|_{L^{p}(T_{\iota(m)})}
        .
    \end{align*}
    Putting this all together, we use 
    \begin{align*}
        &
        \| w_{m} \|_{L^{p}(T_{m})}
        \\&
        \leq  
        \| w'_{m} \|_{L^{p}(T_{m})}
        + 
        \| w''_{m} \|_{L^{p}(T_{m})}
        \\&
        \leq  
        \volumeratio(\calT)^{\frac 1 p} 
        \| w_{\iota(m)} \|_{L^{p}(T_{\iota(m)})} 
        + 
        C_{\PF,T_{m},F_{m},p} 
        \left( 
            \| \nabla u \|_{L^{p}(T_{m})} 
            + 
            \| \nabla w'_{m} \|_{L^{p}(T_{m})} 
        \right) 
    \end{align*}
    and 
    \begin{align*}
        \| \nabla w'_{m} \|_{L^{p}(T_{m})} 
        &
        \leq  
        \volumeratio(\calT)^{\frac 1 p} \reflectionestimate(\calT)
        % C_{\PF,T_{m},F_{m},p} 
        \| \nabla w_{\iota(m)} \|_{L^{p}(T_{\iota(m)})} 
        \leq  
        \volumeratio(\calT)^{\frac 1 p} \reflectionestimate(\calT)
        % C_{\PF,T_{m},F_{m},p} 
        \| \nabla u \|_{L^{p}(T_{\iota(m)})} 
        .
    \end{align*}
    The existence of $w \in W^{1,p}(\Omega)$ satisfying the recursive estimate follows. 

        \begin{align*}
        \| w_{m} \|_{L^{p}(T_m)}
%         &\leq 
%         \volumeratio(\calT)^{\frac m p}
%         C_{\PF,T_{0},p} 
%         \| \nabla u \|_{L^{p}( T_{0} )}
%         +
%         \sum_{l=1}^{m} 
%         \volumeratio(\calT)^{\frac {m-l} p}
%         C_{\PF,T_{l},F_{l},p} 
%         \| \nabla u \|_{L^{p}(T_{l})} 
%         \\&\qquad 
%         +
%         \sum_{l=1}^{m} 
%         \volumeratio(\calT)^{\frac {m-l} p} \reflectionestimate(\calT)
%         C_{\PF,T_{l},F_{l},p} 
%         \| \nabla u \|_{L^{p}(T_{l-1})} 
%         \\
        &\leq 
        \volumeratio(\calT)^{\frac m p}
        C_{\PF,T_{0},p} 
        \| \nabla u \|_{L^{p}( T_{0} )}
        \\&\quad 
        +
        \sum_{l=1}^{m} 
        \volumeratio(\calT)^{\frac {m-l} p}
        C_{\PF,T_{l},F_{l},p} 
        \left( 
            \| \nabla u \|_{L^{p}(T_{l})} 
            +
            \volumeratio(\calT)^{\frac {1} p}
            \reflectionestimate(\calT)
            \| \nabla u \|_{L^{p}(T_{l-1})} 
        \right)
        .
    \end{align*}
    \begin{align*}
        \| \cye{w} \|_{L^{p}(T_{\cye{M}})}
%         &\leq 
%         \rho(\calT)^{\frac \cye{M} p}
%         C_{\PF,T_{0},p} 
%         \| \nabla u \|_{L^{p}( T_{0} )}
%         +
%         \sum_{l=1}^{\cye{M}} 
%         \rho(\calT)^{\frac {\cye{M}-l} p}
%         C_{\PF,T_{l},F_{l},p} 
%         \| \nabla u \|_{L^{p}(T_{l})} 
%         \\&\qquad 
%         +
%         \sum_{l=1}^{\cye{M}} 
%         \rho(\calT)^{\frac {\cye{M}-l} p} \xi(\calT)
%         C_{\PF,T_{l},F_{l},p} 
%         \| \nabla u \|_{L^{p}(T_{l-1})} 
%         \\
        &\leq 
        \sum_{l=1}^{\cye{M}} 
        \rho(\calT)^{\frac {\cye{M}-l} p}
        C_{\PF,T_{l},F_{l},p} 
        \left( 
            \| \nabla u \|_{L^{p}(T_{l})} 
            +
            \rho(\calT)^{\frac {1} p}
            \xi(\calT)
            \| \nabla u \|_{L^{p}(T_{l-1})} 
        \right)
        \\&\quad 
        + \rho(\calT)^{\frac{\cye{M}}{p}}
        C_{\PF,T_{0},p} 
        \| \nabla u \|_{L^{p}( T_{0} )}
        .
    \end{align*}

    Let $T \in \calT$ be any $n$-simplex. 
    Now, let $T \in \calT$ be any $n$-simplex. 
    By assumption, there exists a \cye{face} path $T_0, T_1, \dots, T_M = T$, composed of $n$-simplices \cye{from $\calT$}. 
    
    For any $1 \leq m \leq M$ we let $F_m := T_m \cap T_{m-1}$ be a face of dimension $n-1$ \cye{shared by the $n$-simplices $T_m$ and $T_{m-1}$}. 
    \cye{Recall the notation $U_{F_m} := T_m \cup T_{m-1}$.}
    For any $1 \leq m \leq M$, \cye{recall that} $F_m := T_m \cap T_{m-1}$ \cye{is}  a face of dimension $n-1$ \cye{shared by the $n$-simplices $T_m$ and $T_{m-1}$}. 
    
    
    By assumption, there exists a strong path $T_0, T_1, \dots, T_M = T$, composed of $n$-simplices. 
    
    \todo[inline]{MV: Why a second theorem? We should explain the difference of Theorem~\ref{theorem:poincarefriedrichsestimate:gradzwei} wrt Theorem~\ref{theorem:poincarefriedrichsestimate:grad}. Which is better and when?}

    \begin{figure}[t]
\begin{center}
\begin{tikzpicture}
    \coordinate (A) at (0,0);   \coordinate (B) at (2,0); \coordinate (C) at (1,1.5);
    \coordinate (D) at (0,2.9); \coordinate (E) at (2.5,3); \coordinate (F) at (3,1.25); 
    \draw[fill=gray!50] (A) -- (B) -- (C) -- cycle; 
    \draw[fill=white  ] (A) -- (C) -- (D) -- cycle; 
    \draw[fill=white  ] (C) -- (D) -- (E) -- cycle; 
    \draw[fill=white  ] (B) -- (C) -- (F) -- cycle; 
\end{tikzpicture}
\quad
\begin{tikzpicture}
    \coordinate (A) at (0,0);   \coordinate (B) at (2,0); \coordinate (C) at (1,1.5);
    \coordinate (D) at (0,2.9); \coordinate (E) at (2.5,3); \coordinate (F) at (3,1.25); 
    \draw[fill=gray!25] (A) -- (B) -- (C) -- cycle; 
    \draw[fill=gray!50] (A) -- (C) -- (D) -- cycle; 
    \draw[fill=white  ] (C) -- (D) -- (E) -- cycle; 
    \draw[fill=white  ] (B) -- (C) -- (F) -- cycle; 
\end{tikzpicture}
\quad
\begin{tikzpicture}
    \coordinate (A) at (0,0);   \coordinate (B) at (2,0); \coordinate (C) at (1,1.5);
    \coordinate (D) at (0,2.9); \coordinate (E) at (2.5,3); \coordinate (F) at (3,1.25); 
    \draw[fill=gray!25] (A) -- (B) -- (C) -- cycle; 
    \draw[fill=gray!25] (A) -- (C) -- (D) -- cycle; 
    \draw[fill=gray!50] (C) -- (D) -- (E) -- cycle; 
    \draw[fill=white  ] (B) -- (C) -- (F) -- cycle; 
\end{tikzpicture}
\quad
\begin{tikzpicture}
    \coordinate (A) at (0,0);   \coordinate (B) at (2,0); \coordinate (C) at (1,1.5);
    \coordinate (D) at (0,2.9); \coordinate (E) at (2.5,3); \coordinate (F) at (3,1.25); 
    \draw[fill=gray!25] (A) -- (B) -- (C) -- cycle; 
    \draw[fill=gray!25] (A) -- (C) -- (D) -- cycle; 
    \draw[fill=gray!25] (C) -- (D) -- (E) -- cycle; 
    \draw[fill=gray!50] (B) -- (C) -- (F) -- cycle; 
\end{tikzpicture}
\end{center}
\caption{Exhausting a domain step by step as in Theorem~\ref{theorem:poincarefriedrichsestimate:grad} and \ref{theorem:poincarefriedrichsestimate:gradzwei}.
The dark gray triangle is the one being currently added, and the light gray triangles constitute the subdomain assembled so far.}
\label{figure:exhausting}
\end{figure}

\begin{remark}
    Theorem~\ref{theorem:poincarefriedrichsestimate:grad} depends on only a few parameters of the triangulation:
    the length of any traversal from the root simplex, the ratios of the volumes of adjacent simplices,
    the Poincar\'e--Friedrichs constants on each face patch, and the Poincar\'e--Friedrichs constant of the initial simplex. 
    The aforementioned local Poincar\'e--Friedrichs constants can generally be estimated in terms of shape-parameters. 
    If the face patches of the triangulation are convex, then better estimates are possible. 
\end{remark}

We write $\Omega_{m} \subseteq \bbR^{n}$ for the domain with $\overline\Omega_m := \cup_{j=0}^{m} T_m$, 
    which is a triangulated $n$-dimensional submanifold with boundary.
    \cye{\sout{We finally write $\Omega_m := \cup_{j=0}^{m} T_m$, which is a triangulated $n$-dimensional submanifold with boundary.}}
    \todo[inline]{MV: False, $\Omega_m$ is not necessarily a triangulated $n$-dimensional submanifold with boundary, see the 7-triangles example standing for $\Omega_m$ (then the 8th one gives $\Omega_{m+1} = \Omega$). As discussed online, we fortunately do not need here a submanifold with boundary (but we will need it and have it for shellable triangulations.) Actually, here we do not need $\Omega_m$ at all.}

    \mwl{Where to place that construction?}
 We construct the potential recursively. 
 We have seen that $c_{0} = w_{0} - u_{|\Omega_{0}}$ is a constant. 
 Assume that $1 \leq m \leq M$ such that there exists $w_{\iota(m)} \in W^{1,p}(\Omega_{\iota(m)})$ 
 such that $c_{0} = w_{\iota(m)} - u_{|\Omega_{\iota(m)}}$ is the constant above. 
 % Note that this assumption is already satisfied when $m=1$.
 Hence $\nabla w_{\iota(m)} = \nabla u$ over $\Omega_{\iota(m)}$. 
 By assumption, $T_{m}$ shares the face $F_{m}$ with $T_{{\iota(m)}}$. 
 Since $$\nabla w_{F_{m}|T_{{\iota(m)}}} = \nabla w_{\iota(m)|T_{{\iota(m)}}},$$
 there exists a constant $$c_{m} := w_{\iota(m)|T_{{\iota(m)}}} - w_{F_{m}|T_{{\iota(m)}}}.$$
 We define $w'_{F_m} := w_{F_m} + c_{m} \in W^{1,p}(U_F)$.
 By construction, $$\nabla w'_{F_m} = \nabla w_{F_m} = \nabla u_{|U_{F_m}}$$ 
 and 
 $w'_{F_{m}|T_{{\iota(m)}}} = w_{\iota(m)|T_{{\iota(m)}}}$. 
 But that already implies $w'_{F_m} = w_{|F_m} - c_{0}$. 
 Defining $w_{m} \in W^{1,p}(\Omega_m)$ by extending $w_{\iota(m)}$ with $w'_{F_m|T_m}$,
 we have $c_{0} = w_{m} - u_{|\Omega_{m}}$. 

  
 
 \mwl{Closure}
 We obtain the desired estimate. 
 Repeating this argument produces $w \in L^{p}(\Omega)$ 
 such that for all $n$-simplices $T \in \calT$ we have the restriction $w_{|T} \in W^{1,p}(T)$ with $w_{|T} = u + c_{0}$.
 In particular, $w \in W^{1,p}(\Omega)$ with $\nabla w = \nabla u$.
 
 
 
 
 
 
 
 
 
\begin{figure}
    \centering
    \begin{tabular}{c}\begin{tikzpicture}
        \coordinate (O) at (0, 0);
        \coordinate (A) at ({cos(0)}, {sin(0)});
        \coordinate (B) at ({cos(60)}, {sin(60)});
        \coordinate (C) at ({cos(120)}, {sin(120)});
        \coordinate (D) at ({cos(180)}, {sin(180)});
        \coordinate (E) at ({cos(240)}, {sin(240)});
        \coordinate (F) at ({cos(300)}, {sin(300)});
        \fill[gray!20] (A) -- (B) -- (O) -- (F) -- cycle;
        \draw (A) -- (B) -- (C) -- (D) -- (E) -- (F) -- cycle;
        \draw[dashed] (O) -- (A); \draw[dotted] (O) -- (B); \draw (O) -- (C); \draw (O) -- (D); \draw (O) -- (E); \draw (O) -- (F);
    \end{tikzpicture}\\ (1) \end{tabular}
    \begin{tabular}{c}\begin{tikzpicture}
        \coordinate (O) at (0, 0);
        \coordinate (A) at ({cos(0)}, {sin(0)});
        \coordinate (B) at ({cos(60)}, {sin(60)});
        \coordinate (C) at ({cos(120)}, {sin(120)});
        \coordinate (D) at ({cos(180)}, {sin(180)});
        \coordinate (E) at ({cos(240)}, {sin(240)});
        \coordinate (F) at ({cos(300)}, {sin(300)});
        \fill[gray!20] (A) -- (B) -- (O) -- (F) -- cycle;
        \draw[dotted] (A) -- (B); \draw (B) -- (C) -- (D) -- (E) -- (F) -- (A);
        \draw[dashed] (O) -- (A); \draw (O) -- (B); \draw (O) -- (C); \draw (O) -- (D); \draw (O) -- (E); \draw (O) -- (F);
    \end{tikzpicture}\\ (2) \end{tabular}
    \begin{tabular}{c}\begin{tikzpicture}
        \coordinate (O) at (0, 0);
        \coordinate (A) at ({cos(0)}, {sin(0)});
        \coordinate (B) at ({cos(60)}, {sin(60)});
        \coordinate (C) at ({cos(120)}, {sin(120)});
        \coordinate (D) at ({cos(180)}, {sin(180)});
        \coordinate (E) at ({cos(240)}, {sin(240)});
        \coordinate (F) at ({cos(300)}, {sin(300)});
        \fill[gray!20] (A) -- (B) -- (O) -- (F) -- cycle;
        \draw (A) -- (B) -- (C) -- (D) -- (E) -- (F) -- cycle;
        \draw[dashed] (O) -- (A); \draw (O) -- (B); \draw[dotted] (O) -- (C); \draw (O) -- (D); \draw (O) -- (E); \draw (O) -- (F);
    \end{tikzpicture}\\ (3) \end{tabular}
    \begin{tabular}{c}\begin{tikzpicture}
        \coordinate (O) at (0, 0);
        \coordinate (A) at ({cos(0)}, {sin(0)});
        \coordinate (B) at ({cos(60)}, {sin(60)});
        \coordinate (C) at ({cos(120)}, {sin(120)});
        \coordinate (D) at ({cos(180)}, {sin(180)});
        \coordinate (E) at ({cos(240)}, {sin(240)});
        \coordinate (F) at ({cos(300)}, {sin(300)});
        \fill[gray!20] (A) -- (B) -- (O) -- (F) -- cycle;
        \draw (A) -- (B) -- (C) -- (D) -- (E) -- (F) -- cycle;
        \draw[dashed] (O) -- (A); \draw (O) -- (B); \draw (O) -- (C); \draw[dotted] (O) -- (D); \draw (O) -- (E); \draw (O) -- (F);
    \end{tikzpicture}\\ (4) \end{tabular}
    \caption{Examples and counterexamples for building a manifold-like $1$-patching of a $2$-dimensional manifold-like triangulation. 
    (1) We have already added the edge patch along the dashed line and we add the edge patch along the dotted line.
    (2) The new edge patch may already be a subset of the subtriangulation
    (3) An inadmissible choice because the new edge patch has no overlap with current subtriangulation, though the next subtriangulation would be manifold-like
    (4) An inadmissible choice because the new edge patch has no overlap with current subtriangulation and the next subtriangulation would not be manifold-like.}\label{figure:illustrationpatching}
\end{figure}

% \begin{figure}
%     \centering
%     \begin{tabular}{c}\begin{tikzpicture}[scale=0.5]
%         \coordinate (O) at (0, 0);
%         \coordinate (A) at ({0.8*cos(  0)}, {0.8*sin(  0)});
%         \coordinate (B) at ({0.8*cos(120)}, {0.8*sin(120)});
%         \coordinate (C) at ({0.8*cos(240)}, {0.8*sin(240)});
%         \coordinate (X) at ({3.0*cos( 60)}, {3.0*sin( 60)});
%         \coordinate (Y) at ({3.0*cos(180)}, {3.0*sin(180)});
%         \coordinate (Z) at ({3.0*cos(300)}, {3.0*sin(300)});
%         \draw (A) -- (B) -- (C) -- cycle; \draw (X) -- (Y) -- (Z) -- cycle;
%         \draw[fill=gray!20] (X) -- (Y) -- (B) -- cycle;
%         \draw[fill=gray!20] (Y) -- (Z) -- (C) -- cycle;
%         \draw[fill=gray!20] (Z) -- (X) -- (A) -- cycle;
%         \draw[fill=gray!20] (A) -- (X) -- (B) -- cycle;
%         \draw[fill=gray!20] (B) -- (Y) -- (C) -- cycle;
%         \draw[fill=gray!20] (C) -- (Z) -- (A) -- cycle;
%     \end{tikzpicture}\\ (1) \end{tabular}
%     \begin{tabular}{c}\begin{tikzpicture}[scale=0.5]
%         \coordinate (O) at (0, 0);
%         \coordinate (A) at ({3.0*cos(  0)}, {3.0*sin(  0)});
%         \coordinate (B) at ({3.0*cos(120)}, {3.0*sin(120)});
%         \coordinate (C) at ({3.0*cos(240)}, {3.0*sin(240)});
%         \coordinate (X) at ({3.0*cos( 60)}, {3.0*sin( 60)});
%         \coordinate (Y) at ({3.0*cos(180)}, {3.0*sin(180)});
%         \coordinate (Z) at ({3.0*cos(300)}, {3.0*sin(300)});
%         \draw (O) -- (A);
%         \draw (O) -- (B);
%         \draw (O) -- (C);
%         \draw (O) -- (X);
%         \draw (O) -- (Y);
%         \draw (O) -- (Z);
%         %
%     \end{tikzpicture}\\ (2) \end{tabular}
%     \begin{tabular}{c}\begin{tikzpicture}[scale=0.5]
%         \tikzset{z={(90:1cm)}, y={(-30:1cm)}, x={(210:1cm)}}
%         % \tikzset{z={(90:1cm)}, y={(-10:1cm)}, x={(250:1cm)}}
% 
%         \coordinate (O) at (0, 0);
%         \coordinate (A) at ({3.0*cos(  0)}, {3.0*sin(  0)});
%         \coordinate (B) at ({3.0*cos(120)}, {3.0*sin(120)});
%         \coordinate (C) at ({3.0*cos(240)}, {3.0*sin(240)});
%         \coordinate (X) at ({3.0*cos( 60)}, {3.0*sin( 60)});
%         \coordinate (Y) at ({3.0*cos(180)}, {3.0*sin(180)});
%         \coordinate (Z) at ({3.0*cos(300)}, {3.0*sin(300)});
%         \coordinate (T) at ({0}, {0}, {3});
% 
%         \draw[thick, fill=gray!30] (O) -- (C) -- (T) -- cycle;
%         \draw[thick, fill=gray!30] (O) -- (Y) -- (T) -- cycle;
%         \draw[thick, fill=gray!30] (O) -- (Z) -- (T) -- cycle;
%         \draw[thick, fill=gray!30] (O) -- (A) -- (T) -- cycle;
%         \draw[thick, fill=gray!30] (O) -- (B) -- (T) -- cycle;
%         \draw[thick, fill=gray!30] (O) -- (X) -- (T) -- cycle;
% 
%     \end{tikzpicture}\\ (3) \end{tabular}
%     \caption{Example of a connected $2$-dimensional manifold triangulation, which triangulates an annulus, that does neither admit a manifold-like $0$-patching nor manifold-like $1$-patching.}\label{figure:annuluscounterexample}
% \end{figure}
 






        \color{blue}
        We study the singular values of the matrix 
        \begin{align*}
            \begin{pmatrix}
            -1                 & 0
            \\ 
            -2 \|b_z\|/\|h_z\| & 1
            \end{pmatrix}
            =
            \begin{pmatrix}
            -1             & 0
            \\ 
            -2 \tan(\beta) & 1
            \end{pmatrix}
            =
            \begin{pmatrix}
            0             & \tan(\beta)
             \\ 
            -\tan(\beta) & 0
            \end{pmatrix}
            +
            \begin{pmatrix}
            -1           & -\tan(\beta)
             \\ 
            \tan(\beta) & 1
            \end{pmatrix}
            .
        \end{align*}
        It follows that $\det(\Theta_{|K}) = 1$. 
        Its singular values satisfy 
        \begin{align*}
            ( \sigma_{\max} + \sigma_{\min} )/2
            =
            \tan(\beta)
            ,
            \qquad 
            ( \sigma_{\max} - \sigma_{\min} )/2
            =
            \sqrt{ 1 + \tan^{2}(\beta) }
            .
        \end{align*}
        We arrive at 
        \begin{align*}
            \sigma_{\max} = \sqrt{ 1 + \tan^{2}(\beta) } + \tan(\beta)
            ,
            \qquad 
            \sigma_{\min} = \sqrt{ 1 + \tan^{2}(\beta) } - \tan(\beta)
            .
        \end{align*}
\begin{align*}
    \lambda^2 = \frac{1}{2} \left( a + c \pm \sqrt{ a^2 - 2 a c + c^2 + 4b^2 } \right)
\end{align*}
\begin{align*}
    \lambda 
    &= 
    \frac{1}{\sqrt 2} \sqrt{ (1+t^2) + 1 \pm \sqrt{ (1+t^2)^2 - 2 (1+t^2)   +   1 + 4t^2 } } 
    \\
    &= 
    \frac{1}{\sqrt 2} \sqrt{ t^2 + 2 \pm \sqrt{ 1 + 2t^2 + t^4 - 2 - 2 t^2 + 1 + 4t^2 } } 
    \\
    &= 
    \frac{1}{\sqrt 2} \sqrt{ t^2 + 2 \pm \sqrt{          + t^4                 + 4t^2 } } 
    \\
    &= 
    \frac{1}{\sqrt 2} \sqrt{ t^2 + 2 \pm t \sqrt{ t^2 + 4 } } 
    .
\end{align*}
\begin{align*}
    \lambda = \frac{1}{\sqrt 2} \sqrt{ t^2 + 2 \pm t \sqrt{ t^2 + 4 } } 
\end{align*}
\begin{align*}
    \left( t^2 + 2 + t \sqrt{ t^2 + 4 } \right)
    \left( t^2 + 2 - t \sqrt{ t^2 + 4 } \right)
    =
    t^{4} + 4 t^{2} + 4
    -
    t^{2} ( t^{2} + 4 )
    =
    4
\end{align*}
\begin{align*}
    \frac{1}{\sqrt 2} \sqrt{ t^2 + 2 \pm t \sqrt{ t^2 + 4 } } 
    &=
    \sqrt{1+a^2/4} \pm a/2
    \\
    \frac 1 2 \left( t^2 + 2 \pm t \sqrt{ t^2 + 4 } \right)
    &=
    1+a^2/4
    \pm
    a \sqrt{1+a^2/4}
    + 
    a^2/4
    \\&=
    1
    +
    2a^2/4
    \pm
    a \sqrt{1+a^2/4}
    \\
    1 + \frac{t^2}{2} \pm t \sqrt{ \frac{t^2}{4} + 1 } 
    &=
    1
    +
    a^2/2
    \pm
    a \sqrt{1+a^2/4}
    .
\end{align*}
\color{black}




















        \item 
        % \todo{Combine all this to get the final transformation.}
        The last simplicial complex that we introduce is called $\calK$,
        and it is the simplicial complex obtained from $\patch_{\calT}(S)$ via barycentric refinement of $S$. 
        
        We let $\calK$ the simplicial complex obtained from $\patch_{\calT}(S)$ via barycentric refinement of $S$. 
        Using our initial observations, we obtain homeomorphisms 
        \begin{align*}
            \Psi_{\calK } : |\calK| \rightarrow \calB,
            \qquad 
            \Psi_{\calR'} : |\calR'| \rightarrow \calB.
        \end{align*}
        Both $\Psi_{\calK}$ and $\Psi_{\calR'}$ map $T$ onto the same subset of the unit ball.
        Consequently, the image under $\Psi_{\calK}$ of $\overline{|\calK| \setminus T}$
        onto the image under $\Psi_{\calR'}$ of $|\calR^{c}|$.
        It follows that 
        \begin{align*}
            \Xi_{S} := \Psi_{\calK}^{-1} \Psi_{\calR'} \Theta
        \end{align*}
        is a mapping from $T$ onto $\overline{\patch_{\calT}(S) \setminus T}$.
        We estimate the Jacobians: 
        \begin{align*}
            \| \Jacobian \Xi_{S} \| 
            \leq 
            \sup_{ K \in \calK  }
            \left( 1 + n \kappa(A_{K})^{2} \right)^{\frac 1 2}
            \sigma_{\max}(A_{K}) 
            %
            \sup_{ K \in \calR' } 
            \sqrt{2n} 
            \sigma_{\max}(A_{K}^{-1}) 
            %
            \sup_{ K \in \calR  } \kappa(A_{K})
            \\
            \| \Jacobian \Xi_{S}^{-1} \| 
            \leq 
            \sup_{ K \in \calK  }
            \sqrt{2n} 
            \sigma_{\max}(A_{K}^{-1}) 
            %
            \sup_{ K \in \calR' } 
            \left( 1 + n \kappa(A_{K})^{2} \right)^{\frac 1 2}
            \sigma_{\max}(A_{K}) 
            %
            \sup_{ K \in \calR  } \kappa(A_{K})
            .
        \end{align*}
        \color{red}
        Each bisection step reduces the diameter by at most a factor of one half,
        and it reduces the volume always by a factor of one half. 
        Via the estimates in Lemma~\ref{lemma:affinetransform}, we thus find 
        \begin{align*}
            \| \Jacobian \Xi_{S} \| 
            &\leq 
            2 \left( \sqrt{n} + 1 \right) 
            \sup_{ K \in \calK  }
            \Ceins{n} \diam(K) 
            \sup_{ K \in \calR' } 
            \Czwei{n} \kappa(K) \diam(K)^{-1}
            \sup_{ K \in \calR  } \kappa(A_{K})
            \\&\leq 
            32 \left( \sqrt{n} + 1 \right) 
            \theta(\calT)
            \Ceins{n} 
            \Czwei{n} 
            \kappa(\calT) 
            \alpha(\calT)
            \\
            \| \Jacobian \Xi_{S}^{-1} \| 
            &\leq 
            2 \left( \sqrt{n} + 1 \right) 
            \sup_{ K \in \calK  }
            \Czwei{n} \kappa(K) \diam(K)^{-1}
            \sup_{ K \in \calR' } 
            \Ceins{n} \diam(K)
            \sup_{ K \in \calR  } \kappa(A_{K})
            \\
            &\leq 
            32 \left( \sqrt{n} + 1 \right) 
            \theta(\calT)
            \Ceins{n} 
            \Czwei{n} 
            \kappa(\calT) 
            \alpha(\calT)
            .
        \end{align*}
        Together with the definition of $\theta(\calT)$, the desired result follows. 
%         \color{red}
%         Each bisection halves the volume of the triangles. Thus,
%         \begin{align*}
%             \| \Jacobian \Xi_{S} \| 
%             &\leq 
%             2 
%             \sup_{ K \in \patch_{\calT}(S) }
%             2 \sigma_{\max}(A_{K}) 
%             4 
%             \left( \sqrt{n} + 1 \right) \sigma_{\max}(A_{T}^{-1}) 
%             4 
%             \kappa(A_{T})
%             \\&\leq 
%             64
%             \left( \sqrt{n} + 1 \right) 
%             \kappa(A_{T})
%             \sigma_{\max}(A_{T}^{-1}) 
%             \sup_{ K \in \patch_{\calT}(S) }
%             \sigma_{\max}(A_{K}     ) 
%             \\
%             \| \Jacobian \Xi_{S}^{-1} \| 
%             &\leq 
%             2 \left( \sqrt{n} + 1 \right) 
%             \sup_{ K \in \patch_{\calT}(S) }
%             \sigma_{\max}(A_{K}) 
%             \sigma_{\max}(A_{T}^{-1}) 
%             4 \kappa(A_{T})
%             \\&\leq 
%             64
%             \left( \sqrt{n} + 1 \right) 
%             \kappa(A_{T})
%             \sigma_{\max}(A_{T}^{-1}) 
%             \sup_{ K \in \patch_{\calT}(S) }
%             \sigma_{\max}(A_{K}     ) 
%             .
%         \end{align*}
%         We use 
%         \begin{gather*}
%             \sup_{ K \in \patch_{\calT}(S) }
%             \sigma_{\max}(A_{K}) 
%             \leq 
%             \Ceins{n} 
%             \sup_{ K \in \patch_{\calT}(S) }
%             \diam(K)
%             \leq 
%             \Ceins{n} 
%             \theta(\calT)
%             \sigma_{\max}(A_{T}) 
%             .
%         \end{gather*}
%         \color{black}
        % That establishes the final estimate. 
%         \item 
%         Suppose that $S = \{v_0\}$ is a single vertex. 
%         We construct a transformation from the vertex star around $S$ onto the Euclidean unit ball. 
%         Without loss of generality, $S$ is at the origin. 
%         For any $T \in \patch_{\calT}(S)$, we let $F_T$ be the transformation. 
%         We define $F$ over $|\patch_{\calT}(S)|$ piecewise. 
%         \todo{Complete}
%         
        
%         \item 
%         Let $\calU$ be the simplicial complex of dimension $n-1$ that contains precisely those facets of $T$ that do not contain $S$.
%         We write $Y := F( |\calU| )$. 
%         \todo{Shape of the outer patch $Y$, star-shaped geometry}
%         
%         \item 
%         We let $\sphere{n}_{\star} := \sphere{n} \setminus \{e_{n+1}\} \subseteq \bbR^{n+1}$ be the unit sphere without the North pole. 
%         Suppose that $\bar x \in \sphere{n}$ is a point on the unit sphere and $\bar x \neq e_{n+1}$. 
%         We define its stereographic projection as 
%         \begin{align*}
%             \pi( \bar x ) 
%             = 
%             \sum_{i=1}^{n} \frac{x_i}{1 - x_{n+1}} e_{i}
%             .
%         \end{align*}
%         This is a mapping $\pi : \sphere{n}_{\star} \rightarrow \bbR^{n}$. 
%         Its inverse is defined as follows: given $y \in \bbR^{n}$, we have 
%         \begin{align*}
%             \pi^{-1}( y )
%             = 
%             \sum_{i=1}^{n} \frac{2 y_i}{1 + \| y \|^2} e_{i}
%             +
%             \frac{1 - \| y \|^2}{1 + \| y \|^2} e_{n+1}
%             .
%         \end{align*}
%         \item 
%         Mirroring the unit sphere along the equator is expressed in stereographic coordinates by the involution 
%         \begin{align*}
%             \mu : \bbR^{n} \rightarrow \bbR^{n},
%             \qquad 
%             y \mapsto \frac{y}{\| y \|}.
%         \end{align*}
%         \item 
%         \begin{align*}
%             G(y) := \| y \| \cdot \phi\left( \frac{y}{\|y\|} \right)^{-1} \frac{y}{\|y\|}
%         \end{align*}
%         \item 
%         We combine these mappings:
%         \begin{align*}
%             Q : \sphere{n} \rightarrow \sphere{n}, \qquad x \mapsto \pi^{-1} G^{-1} \mu G \pi(x)
%         \end{align*}
%         We want to analyze its Lipschitz properties. \todo{Stuff}
%         \item
%         We have constructed a bi-Lipschitz mapping from the Euclidean unit sphere into itself.
%         We use the following result~\cite[Theorem~3]{alestalo2018radial}:
%         if $f : \sphere{n} \rightarrow \sphere{n}$ is any $L$-Lipschitz mapping from the Euclidean unit sphere into itself, 
%         then the radial extension $f : \ball{n} \rightarrow \ball{n}$ is an $L$-Lipschitz mapping from the Euclidean unit ball into itself.
%         Consequently, \todo{write out}
%         \item 
%         In total, we thus have 
%         \begin{align*}
%             Q' := F^{-1} \pi^{-1} G^{-1} \mu G \pi F
%             .
%         \end{align*}




        \item 
        We begin with the following preparatory observations. 
        Consider any $n$-simplex $T$ with vertices $v_0, v_1, \dots, v_n$, where $v_0$ is the origin. 
        We let $A_{T} \in \bbR^{n \times n}$ be the matrix that maps the $i$-th unit vector to $v_i$.
        That matrix maps the reference simplex $\Delta^{n}$ onto $T$. 
        Then the mapping 
        \begin{align}
            F_T(x) 
            = 
            \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } x
        \end{align}
        maps $T$ onto a ``simplex with a curved face'' inside the Euclidean unit ball. Its inverse is
        \begin{align}
            F_T^{-1}(x) 
            = 
            \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } x
            .
        \end{align}
        We analyze its Lipschitz properties.
        % 
        In what follows, $y \in \bbR^{n}$. 
        On the one hand, 
        we compute the Jacobian at any $x \in \mathring T$:
        \begin{align*}
            \Jacobian F_T(x) \cdot y
            &= 
            \frac{ \|x\| y - x \|x\|^{-1} x^t y }{\|x\|^2} 
            \left( \vecone \cdot A_{T}^{-1} x \right)
            + 
            \frac{x}{\|x\|} \left( \vecone \cdot A_{T}^{-1} y \right)
            \\&= 
            \left( \Id - \|x\|^{-2} x \otimes x^t \right)
            \frac{ 1 }{ \|x\| } 
            \left( \vecone \cdot A_{T}^{-1} x \right)
            + 
            \frac{x}{\|x\|} \left( \vecone \cdot A_{T}^{-1} x \right)
            \\&= 
            \left( A_{T}^{-t} \vecone \cdot \hat x \right)
            \left( \Id - \hat x \otimes \hat x^t \right) y
            + 
            \left( A_{T}^{-t} \vecone \cdot y \right) \hat x 
            .
        \end{align*}
        This is an orthogonal sum of two vectors. Its norm satisfies:
        \begin{align*}
            \| \Jacobian F_T(x) \cdot y \|^{2}
            &= 
            \left| A_{T}^{-t} \vecone \cdot \hat x \right|^{2}
            \| \left( \Id - \hat x \otimes \hat x^t \right) y \|^{2}
            + 
            \left| A_{T}^{-t} \vecone \cdot y \right|^{2} \| \hat x \|^{2}
            .
        \end{align*}
        The Euclidean operator norm satisfies 
        \begin{align*}
            \| \Jacobian F_T(x) \| 
            \leq 
            \sqrt 2 \left\| A_{T}^{-t} \vecone \right\|_{2}
            \leq 
            \sqrt{2n} \cdot \sigma_{\max}(A_{T}^{-1}) 
            .
        \end{align*}
        On the other hand, we can rewrite the Jacobian as:
        \begin{align*}
            \Jacobian F_T(x) \cdot y
            &= 
            \left( A_{T}^{-t} \vecone \cdot \hat x \right)
            y
            - 
            \left( A_{T}^{-t} \vecone \cdot \hat x \right)
            \left( \hat x \otimes \hat x^t \right) y
            + 
            \left( A_{T}^{-t} \vecone \cdot y \right) \hat x 
            \\&= 
            \left( A_{T}^{-t} \vecone \cdot \hat x \right)
            y
            - 
            \hat x 
            \left( 
                \left( A_{T}^{-t} \vecone \cdot \hat x \right) \hat x^{t}
                -
                \vecone^{t} A_{T}^{-1} 
            \right) y
            \\&= 
            \left( A_{T}^{-t} \vecone \cdot \hat x \right)
            y
            - 
            \hat x 
            \left( 
                \left( A_{T}^{-t} \vecone \cdot \hat x \right) \hat x
                -
                A_{T}^{-t} \vecone
            \right)^{t} y
            .
        \end{align*}
        Its inverse is found via the Woodbury formula: 
        % Its inverse is easily verified to be:
        \begin{align*}
            \Jacobian F_T(x)^{-1}
            &= 
            \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-1}
            \Id
            - 
            \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-2}
            \hat x 
            \left( 
                \left( A_{T}^{-t} \vecone \cdot \hat x \right) \hat x
                -
                A_{T}^{-t} \vecone
            \right)^{t} 
            \\&= 
            \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-1}
            \left( 
                \Id
                - 
                \hat x 
                \left( 
                    % \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-1}
                    % \left( A_{T}^{-t} \vecone \cdot \hat x \right) 
                    \hat x
                    -
                    \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-1}
                    A_{T}^{-t} \vecone
                \right)^{t}
            \right)
            \\&= 
            \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
            \left( 
                \Id
                - 
                \hat x 
                \left( 
                    % \left( A_{T}^{-t} \vecone \cdot \hat x \right)^{-1}
                    % \left( A_{T}^{-t} \vecone \cdot \hat x \right) 
                    \hat x
                    -
                    \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
                    A_{T}^{-t} \vecone
                \right)^{t}
            \right)
            \\&= 
            \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
            \left( 
                \Id - \hat x \otimes \hat x^{t}
                + 
                \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
                \hat x \otimes \vecone^{t} A_{T}^{-1}
            \right)
            .
        \end{align*}
        The inverse acts via multiplication with $\left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}$ on the span of $\hat x$.
        We notice the upper bound 
        \begin{align*}
            \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
            &= 
            \| A_{T}^{-1} \hat x \|^{-1}_{1}
            \\&\leq  
            \| A_{T}^{-1} \hat x \|^{-1}_{2}
            \leq 
            \sigma_{\min}( A_{T}^{-1} )^{-1}
            = 
            \sigma_{\max}( A_{T} )
            .
        \end{align*}
        This holds because $A_{T}^{-1} \hat x$ is in the positive quadrant.
        %, and its scalar product with $\vecone$ is minimized when it is colinear with a coordinate axis.
        If $y \in \bbR^{n}$ is orthogonal to $\hat x$, then 
        \begin{align*}
            \| \Jacobian F_T(x)^{-1} \cdot y \|^{2}
            &\leq 
%             \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-2}
%             \left\| 
%                 y
%             \right\|^{2}
%             +
%             \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-2}
%             \left| 
%                 \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
%                 \vecone^{t} A_{T}^{-1} y 
%             \right|^{2}
%             \\&\leq 
            \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-2}
            \left\| 
                y
            \right\|^{2}
            +
            \frac{ 
            \left| 
                \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{-1}
                \vecone^{t} A_{T}^{-1} y 
            \right|^{2}
            }{
            \left( \vecone \cdot A_{T}^{-1} \hat x \right)^{2}
            }
            .
        \end{align*}
        The operator norm of that inverse is:
        \begin{align*}
            \| \Jacobian F_T(x)^{-1} \|
            \leq 
            \sigma_{\max}( A_{T} )
            \left( 1 + n \frac{ \sigma_{\max}(A_{T})^{2} }{ \sigma_{\min}(A_{T})^{2} } \right)^{\frac 1 2}
            .
        \end{align*}
        Since the domain and codomain of $F_{T}$ are convex, 
        this also implies bounds on the Lipschitz constants of $F_{T}$ and its inverse. 











\color{red}
        On the one hand, given $x, y \in T$, 
        where $\| y \|_{1} \leq \| x \|_{1}$ without loss of generality, we find 
        \begin{align*}
            &
            \left\| F_T(x) - F_T(y) \right\|_{2}
            \\&\qquad 
            \leq 
            \left\| 
                \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } x - \frac{ \| A_{T}^{-1} y \|_{1} }{ \|y\|_2 } y
            \right\|_{2}
            \\&\qquad 
            \leq 
            \left\| 
                \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } x - \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } y
            \right\|_{2}
            +
            \left\| 
                \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } y - \frac{ \| A_{T}^{-1} y \|_{1} }{ \|y\|_2 } y
            \right\|_{2}
            \\&\qquad 
            \leq 
            \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } 
            \left\| 
                x - y
            \right\|_{2}
            +
            \left| \|A_{T}^{-1} x\|_1 - \|A_{T}^{-1} y\|_1 \right|
            \\&\qquad 
            \leq 
            2\sqrt{n} \sigma_{\max}(A_{T}^{-1}) 
            \left\| x - y \right\|_{2}
            .
        \end{align*}
        On the one hand, given $x, y \in T$, 
        where $\| x \|_{2} \leq \| y \|_{2}$ without loss of generality, we find 
        \begin{align*}
            &
            \left\| F_T(x) - F_T(y) \right\|_{2}
            \\&\qquad 
            \leq 
            \left\| 
                \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } x - \frac{ \| A_{T}^{-1} y \|_{1} }{ \|y\|_2 } y
            \right\|_{2}
            \\&\qquad 
            \leq 
            \left\| 
                \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } x - \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } y
            \right\|_{2}
            +
            \left\| 
                \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } y - \frac{ \| A_{T}^{-1} y \|_{1} }{ \|x\|_2 } y
            \right\|_{2}
            +
            \left\| 
                \frac{ \| A_{T}^{-1} y \|_{1} }{ \|x\|_2 } y - \frac{ \| A_{T}^{-1} y \|_{1} }{ \|y\|_2 } y
            \right\|_{2}
            \\&\qquad 
            \leq 
            \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } 
            \left\| 
                x - y
            \right\|_{2}
            +
            \left| \|A_{T}^{-1} x\|_1 - \|A_{T}^{-1} y\|_1 \right|
            \frac{\|y\|}{\|x\|}
            +
            \|A_{T}^{-1} y\|_1 \|y\|_{2}
            \left| \frac{1}{\|x\|} - \frac{1}{\|y\|} \right|
            \\&\qquad 
            \leq 
            \frac{ \| A_{T}^{-1} x \|_{1} }{ \|x\|_2 } 
            \left\| 
                x - y
            \right\|_{2}
            +
            \left| \|A_{T}^{-1} x\|_1 - \|A_{T}^{-1} y\|_1 \right|
            \frac{\|y\|}{\|x\|}
            +
            \|A_{T}^{-1} y\|_1 \|y\|_{2}
            \left| \frac{ \|y\|_{2} - \|x\|_{2} }{\|x\|_{2} \|y\|_{2}} \right|
            \\&\qquad 
            \leq 
            3 \sqrt{n} \sigma_{\max}(A_{T}^{-1}) 
            \left\| x - y \right\|_{2}
            .
        \end{align*}
        On the other hand, given $x, y \in F_T(T)$, 
        where $\| A_{T}^{-1} y \|_{1} \leq \| A_{T}^{-1} x \|_{1}$ without loss of generality, we find 
        \begin{align*}
            &
            \left\| F_T^{-1}(x) - F_T^{-1}(y) \right\|_{2}
            \\&\qquad 
            \leq 
            \left\| 
                \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } x - \frac{ \|y\|_2 }{ \| A_{T}^{-1} y \|_{1} } y
            \right\|_{2}
            \\&\qquad 
            \leq 
            \left\| 
                \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } x - \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } y
            \right\|_{2}
            +
            \left\| 
                \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } y - \frac{ \|y\|_2 }{ \| A_{T}^{-1} x \|_{1} } y
            \right\|_{2}
            +
            \left\| 
                \frac{ \|y\|_2 }{ \| A_{T}^{-1} x \|_{1} } y - \frac{ \|y\|_2 }{ \| A_{T}^{-1} y \|_{1} } y
            \right\|_{2}
            \\&\qquad 
            \leq 
            \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{1} } 
            \left\| 
                x - y
            \right\|_{2}
            +
            \left| \|x\|_2 - \|y\|_2 \right|
            \frac{ \|y\|_2 }{ \| A_{T}^{-1} x \|_{1} }
            +
            \|y\|_2^{2}
            \left| 
            \frac{ \| A_{T}^{-1} y \|_{1} - \| A_{T}^{-1} x \|_{1} }{ \| A_{T}^{-1} x \|_{1} \| A_{T}^{-1} y \|_{1} }
            \right|
            \\&\qquad 
            \leq 
            \frac{ \|x\|_2 }{ \| A_{T}^{-1} x \|_{2} } 
            \left\| 
                x - y
            \right\|_{2}
            +
            \left| \|x\|_2 - \|y\|_2 \right|
            \frac{ \|y\|_2 }{ \| A_{T}^{-1} x \|_{2} }
            +
            \|y\|_2^{2}
            \left| 
            \frac{ \| A_{T}^{-1} y \|_{1} - \| A_{T}^{-1} x \|_{1} }{ \| A_{T}^{-1} x \|_{2} \| A_{T}^{-1} y \|_{2} }
            \right|
            \\&\qquad 
            \leq 
            \left( 2 + \sqrt{n} \frac{\sigma_{\max}(A_{T}^{-1}) }{ \sigma_{\min}(A_{T}^{-1}) } \right) \sigma_{\min}(A_{T}^{-1})^{-1} 
            \left\| x - y \right\|_{2}
            \\&\qquad 
            \leq 
            \left( 2 + \sqrt{n} \kappa(A_{T}) \right) \sigma_{\max}(A_{T})
            \left\| x - y \right\|_{2}
            .
        \end{align*}
        By convexity of the range of $F_T(T)$, 
        we obtain a bound on the operator norm of the Jacobian of $F_{T}^{-1}$. 
        We recall that $\sigma_{\max}(A_{T}^{-1}) = \sigma_{\min}(A_{T})^{-1}$ and $\sigma_{\min}(A_{T}^{-1})^{-1} = \sigma_{\max}(A_{T})$.
        \color{black}
        











\begin{proof}
    We let $\hat F_0$ be the convex closure of the first $n$ unit vectors. 
    We let $\hat F_1, \dots, \hat F_n$ be the remaining faces of the reference simplex 
    such that the $i$-th coordinate equals zero along $\hat F_i$.

    Let $\varphi : \Delta^{n} \rightarrow T$ be an affine diffeomorphism 
    that maps the faces $\hat F_{0}, \hat F_{1}, \dots, \hat F_{l}$ onto the boundary patch $\Gamma$. 
    We let $\Upsilon^{n}$ be constructed by reflecting $\Delta^{n}$ across the coordinate axes $l+1$ through $n$.
    The boundary $\partial\Upsilon^{n}$ is the reflection of the faces $\hat F_{0}, \hat F_{1}, \dots, \hat F_{l}$ under that process. 
    Obviously, $\Upsilon^{n}$ is convex with diameter $2$. 


    Let $f = \cartan u$ with $u \in \bfW^{p}\Lambda^{k}(T)$.
    We set $\hat f := \varphi^{\ast} f$ and $\hat u = \varphi^{\ast} u$, 
    so that $\hat u \in \cartan \bfW^{p}\Lambda^{k}(\Delta^{n})$ and $\cartan \hat u = \hat f$.

    We construct $\tilde u \in L^{p}(\Upsilon^{n})$ as the reflection $\hat u$ across the coordinate axes $l+1$ through $n$, and we build $\tilde f \in L^{p}(\Upsilon^{n})$ analogously.
    Then $\tilde u \in \bfW^{p}(\Upsilon^{n})$ with $\cartan \tilde u = \tilde f$. 

    The operator norm bound of the potential operator shows 
    \begin{align*}
        \| \tilde u \|_{L^{p}(\Upsilon^{n})} 
        &\leq 
        n A(n,\ell) \frac{ \vol_{n}(B_2(0)) }{|\Upsilon^{n}|} 2 
        \| \tilde f \|_{L^{p}(\Upsilon^{n})}
        \\&
        \leq 
        2 n A(n,\ell) \vol_{n}(B_1(0)) \frac{ n! \cdot 2^{n} }{2^{n-l}} 
        \| \tilde f \|_{L^{p}(\Upsilon^{n})}
        .
    \end{align*}
    We use the pullback estimates 
    \begin{gather*}
        \| \tilde u \|_{L^{p}(\Upsilon^{n})} 
        \leq 
        \| \Jacobian\varphi \|_{\infty}^{k}
        |\det\varphi^{-\frac{1}{p}}|
        \cdot 
        \| \tilde u \|_{L^{p}(\Upsilon^{n})} 
        ,
        \\
        \| \tilde f \|_{L^{p}(\Upsilon^{n})} 
        \leq 
        2^{n-l}
        \| \hat f \|_{L^{p}(\hat T)} 
        \leq 
        2^{n-l}
        \| \Jacobian\varphi^{-1} \|_{\infty}^{k+1}
        |\det\varphi^{\frac{1}{p}}|
        \cdot 
        \| f \|_{L^{p}(T)} 
        .
    \end{gather*}
\end{proof}





\begin{remark}
    For reference, how the extension should work:
    suppose that $u \in H(\Omega)$ and let $f = du$.
    Suppose we have $u_1 \in H(T_1)$ with $du_1 = du$ over $T_1$. 
    We built $u'_2 \in H(T_2)$ such that 
    \begin{align*}
        \trace_F u_1 = \trace_F u'_2
    \end{align*}
    We let $u''_2 \in H(T_2)$ such that 
    \begin{align*}
        d u''_2 = f - d u'_2, \quad \trace_F u''_2 = 0
    \end{align*}
    Such $u''_2$ exists because 
    \begin{align*}
        \trace_F( f_2 - d u'_2 ) 
        &= 
        \trace_F f_1 - \trace_F d u'_2
        \\&= 
        \trace_F f_1 - \trace_F d u'_2
        \\&= 
        \trace_F d u_1 - \trace_F d u'_2
        \\&= 
        d \trace_F u_1 - d \trace_F u'_2
        \\&= 
        d \trace_F u_1 - d \trace_F u_1
        = 0
        .
    \end{align*}
    Setting $u_2 = u'_2 + u''_2$, we find 
    \begin{align*}
        d u_2 = d u'_2 + d u''_2 = d u'_2 + f - d u'_2 = f,
        \\
        \trace_F u_2 = \trace_F u'_2 = \trace_F u_1.
    \end{align*}
    That requires an extension from given partial boundary data. 
    Possible approaches:
    \begin{itemize}
        \item Reflect a neighborhood and multiply with cut-off function.
        \item Take traces from patch and extend onto new simplex. 
    \end{itemize}
\end{remark}








\begin{lemma}\label{lemma:mixedbconsimplex}
    Let $T$ be an $n$-simplex and with a face $F$. 
    If $u \in W^{1,p}(T)$ such that $\trace_{F} u = 0$, then 
    \begin{align*}
        \| u \|_{L^{p}(T)}
        &
        \leq 
        C_{{\rm PF},T,F,p} \| \nabla u \|_{L^{p}(T)}
    \end{align*}
    where $C_{{\rm PF},T,F,p} > 0$ is a constant such that 
    \begin{align*}
        C_{{\rm PF},T,F,p}
        \leq 
        \left( C_{{\rm PF},T,p} + \left( C_{{\rm PF},T,p}^{p} + p \cdot \diam(T) C_{{\rm PF},T,p}^{p-1} \right)^{\frac 1 p} \right),  
        \quad 
        C_{{\rm PF},T,F,p}
        \leq 
        \diam(T)
        .
    \end{align*}
\end{lemma}
\begin{proof}
    There exists $w \in W^{1,p}(T)$ with $\nabla w = \nabla u$ and 
    \[
        \| w \|_{L^{p}(T)}
        \leq 
        C_{{\rm PF},T,p} 
        \| \nabla w \|_{\bfL^{p}(T)}
        .
    \]
    Then $w-u$ is constant, and thus $\gamma := \trace_{F} (w-u) = \trace_{F} w$. 
    We use that 
    \[
        \| \gamma \|_{L^{p}(T)}
        =
        \gamma \vol(T)^\frac{1}{p}
        =
        \left( \frac{ \vol(T) }{ \vol(F) } \right)^\frac{1}{p}
        \cdot 
        \gamma 
        \vol(F)^\frac{1}{p}
        \leq 
        \left( \frac{ \vol(T) }{ \vol(F) } \right)^\frac{1}{p}
        \| \gamma \|_{L^{p}(F)}
        .
    \]
    Using a trace inequality~\cite[Lemma~2.8]{veeser2012poincare} when $1 \leq p < \infty$, we find 
    \begin{align*}
        \| \gamma \|_{L^{p}(F)}^{p}
        &
        \leq 
        \frac{ \vol(F) }{ \vol(T) }
        \| w \|_{L^{p}(T)}^{p}
        +
        p
        \cdot 
        \diam(T)
        \frac{ \vol(F) }{ \vol(T) }
        \| w \|_{L^{p}(T)}^{p-1}
        \| \nabla w \|_{L^{p}(T)}
        \\&
        \leq 
        \left( \frac{ \vol(F) }{ \vol(T) } \right)
        \left( C_{{\rm PF},T,p}^{p} + p \cdot C_{{\rm PF},T,p}^{p-1} \right) 
        \diam(T)^{p}
        \| \nabla w \|_{L^{p}(T)}^{p}
        \\&
        \leq 
        \left( \frac{ \vol(F) }{ \vol(T) } \right)
        \left( C_{{\rm PF},T,p}^{p} + p \cdot \diam(T) C_{{\rm PF},T,p}^{p-1} \right) 
        %\diam(T)^{p}
        \| \nabla w \|_{L^{p}(T)}^{p}
        .
    \end{align*}
    Recall that $u = w - \gamma$. The first inequality follows. 
    
    The second inequality follows from Rademachers theorem when $p = \infty$.
    Let assume that $1 \leq p < \infty$. 
    Suppose that $u \in C^{\infty}(T)$ with support disjoint from $F$.
    Without loss of generality, $F$ lies in the span of the first $n-1$ coordinates and the $n$-th coordinate is non-negative over $T$. 
    We write $\bfg \in \bfL^{\infty}(T)$ be the trivial extension of $u$ outside of $T$.
    With the fundamental theorem of calculus and H\"olders inequality: 
    \begin{align*}
        &
        \int_{\Omega} |u(x_{1},\dots,x_{n-1},x_{n})|^{p} dx_1 \dots dx_{n-1} dx_{n}
        \\&
        \leq
        \int_{\Omega} \left| \int_{0}^{x_n} \partial_{n} u(x_{1},\dots,x_{n-1},y) dy \right|^{p} dx_1 \dots dx_{n-1} dx_{n}
        \\&
        \leq
        \int_{\Omega} \int_{0}^{x_n} x_{n}^{p-1} \left| \partial_{n} u(x_{1},\dots,x_{n-1},y) \right|^{p} dy dx_1 \dots dx_{n-1} dx_{n}
        \\&
        \leq
        \int_{\Omega} \int_{0}^{D} D^{p-1} \left| \bfg(x_{1},\dots,x_{n-1},y) \right|^{p} dy dx_1 \dots dx_{n-1} dx_{n}
        \leq 
        D^{p} 
        \int_{\Omega} |\nabla u|^{p} dx
        .
    \end{align*}
    That $\|u\|_{L^{p}(\Omega)} \leq \diam(T) \|\nabla u\|_{L^{p}(\Omega)}$ for all $W^{1,p}(T)$ whose members have vanishing trace along $F$ follows from approximation via members of $u \in C^{\infty}(T)$ whose support is disjoint from $F$. 
    
    Very briefly verify that density argument: 
    There exists $\varphi : \hat T \rightarrow T_{m+1}$ mapping the convex closure of the $n$ unit vectors onto the face $F$.
    We let $\hat u := u \circ \varphi$ and define $\hat g \in \bfL^p(\hat T)$ via $\hat g := \nabla ( u \circ \varphi )$. 
    Then $\nabla \hat u = \hat g$. 
    % 
    Let $\hat U$ be the unit ball of the $\ell^1$ metric, which contains $\hat T$.
    We let $\tilde u$ be the extension of $\hat u$ onto $\hat U$ by reflection across the coordinate axes.
    We define $\tilde g = \nabla \tilde u$
    and see that $\tilde g$ is the extension of $\hat g$ onto $\hat U$ by reflection across the coordinate axes. 
    By construction $\tilde u$ vanishes at the boundary of $\hat U$,
    and we approximate $\tilde u$ in $W^{1,p}(\hat U)$ via a sequence in $C^{\infty}_{c}(\hat U)$. 
    
    
    There exists $\varphi : \hat T \rightarrow T_{m+1}$ mapping the convex closure of the $n$ unit vectors onto the face $F$.
    We let $\hat u := u \circ \varphi$ and define $\hat g \in \bfL^p(\hat T)$ via $\hat g := \nabla ( u \circ \varphi )$. 
    Then $\nabla \hat u = \hat g$. 
    % 
    Let $\hat U$ be the unit ball of the $\ell^1$ metric, which contains $\hat T$.
    We let $\tilde u$ be the extension of $\hat u$ onto $\hat U$ by reflection across the coordinate axes.
    We define $\tilde g = \nabla \tilde u$
    and see that $\tilde g$ is the extension of $\hat g$ onto $\hat U$ by reflection across the coordinate axes. 
    By construction $\tilde u$ vanishes at the boundary of $\hat U$, and thus Friedrichs inequality satisfies 
    \begin{gather*}
        \| \tilde u \|_{L^{p}(\hat U)} 
        \leq 
        2 
        \| \tilde g \|_{\bfL^{p}(\hat U)}
        .
    \end{gather*}
    In addition to that, 
    \begin{gather*}
        \| u \|_{L^{p}(T_{m+1})}
        \leq 
        |\det(\Dif \varphi)|^{\frac 1 p} 
        \| \hat u \|_{L^{p}(\hat T)}
        \leq 
        |\det(\Dif \varphi)|^{\frac 1 p} 
        \| \tilde u \|_{L^{p}(\hat U)}
        ,
        \\
        \| \tilde g \|_{\bfL^{p}(\hat U)}
        \leq 
        2^{\frac n p}
        \| \hat g \|_{\bfL^{p}(\hat T)}
        \leq 
        2^{\frac n p}
        |\det(\Dif \varphi_1)|^{-\frac 1 p} \| \Dif \varphi \| \cdot 
        \| \nabla u \|_{\bfL^{p}(T)}
        .
    \end{gather*}
    The second inequality follows.
\end{proof}







Given $a \in \Omega$, we introduce the potential operator 
\begin{align*}
    \Poinc_{\ell,a} u(x) 
    &:= 
    (x-a)\lrcorner \int_{0}^{1} t^{\ell-1} u\left(a+t(x-a)\right)\,dt\;
    .
\end{align*}
By definition,
\begin{align*}
    \Poinc_{\ell} u(x) 
    =
    \int_{\Omega} \Poinc_{\ell,a} u(x) \,da\;
    .
\end{align*}
We study the interaction of the potential operator with the exterior derivative in more detail.
Suppose that $u \in C^{\infty}(\bbR^n,\Alt^{\ell})$ with $\supp u \subseteq \overline\Omega$.
We rewrite the potential,
\begin{align*}
    \Poinc_{\ell,a} u(x) 
    &= 
    (x-a)\lrcorner \int_{0}^{1} t^{\ell-1} u\left(a+t(x-a)\right)\,dt\,da\;
    \\&
    = 
    (x-a)\lrcorner 
    \sum_{\sigma \in \Sigma(k,n)}
    \int_{0}^{1} 
    t^{\ell-1} u_{\sigma}\left(a+t(x-a)\right) \cartanx^{\sigma} dt 
    \\&
    = 
    \sum_{\sigma \in \Sigma(k,n)} \sum_{i=1}^{k}
    \int_{0}^{1} 
    t^{\ell-1} u_{\sigma}\left(a+t(x-a)\right) (-1)^{i-1} (x-a)_{\sigma(i) } \cartanx^{\sigma-\sigma(i)} dt 
    ,
\end{align*}
and compute its exterior derivative:
\begin{align*}
    \cartan \Poinc_{\ell,a} u(x) 
    &= 
    \ell
    \sum_{\sigma \in \Sigma(k,n)} \sum_{i=1}^{k}
    \int_{0}^{1} 
    t^{\ell-1} u_{\sigma}\left(a+t(x-a)\right) \cartanx^{\sigma-\sigma(i)} dt 
    \\&\qquad
    + 
    \sum_{\sigma \in \Sigma(k,n)} \sum_{i=1}^{k} \sum_{j=1}^{n}
    \int_{0}^{1} 
    t^{\ell} \frac{ \partial u_{\sigma} }{\partial x_{j}}\left(a+t(x-a)\right) (-1)^{i-1} (x-a)_{\sigma(i) } \cartanx^{j} \wedge \cartanx^{\sigma-\sigma(i)} dt 
    .
\end{align*}
We write the exterior derivative of $u$ as 
\begin{align*}
    \cartan u(x)
    =
    \sum_{\sigma \in \Sigma(k,n)} \sum_{j=1}^{n}
    \frac{ \partial u }{\partial x_{j}}(x) \cartanx^{j} \wedge \cartanx^{\sigma} dt 
    ,
\end{align*}
and apply the potential operator to this result, which gives 
\begin{align*}
    \Poinc_{\ell+1,a} \cartan u(x)
    &=
    (x-a)\lrcorner 
    \sum_{\sigma \in \Sigma(k,n)} \sum_{j=1}^{n}
    \int_{0}^{1} t^{\ell} \frac{ \partial u_{\sigma} }{\partial x_{j}}\left(a+t(x-a)\right) dt 
    \;\cartanx^{j} \wedge \cartanx^{\sigma}
    \\&
    = 
    \sum_{\sigma \in \Sigma(k,n)} \sum_{j=1}^{n}
    \int_{0}^{1} t^{\ell} \frac{ \partial u_{\sigma} }{\partial x_{j}}\left(a+t(x-a)\right) dt (x-a)_{j}
    \;\cartanx^{\sigma}
    \\&\qquad 
    - 
    \sum_{\sigma \in \Sigma(k,n)} \sum_{i=1}^{k} \sum_{j=1}^{n}
    (-1)^{i-1}
    \int_{0}^{1} t^{\ell} \frac{ \partial u_{\sigma} }{\partial x_{j}}\left(a+t(x-a)\right) dt 
    (x-a)_{\sigma(i)} \cartanx^{j} \wedge \cartanx^{\sigma-\sigma(i)}
    .
\end{align*}
We add the exterior derivative of the potential and the potential of the exterior derivative.
Taking into account cancellations, this gives the identity 
\begin{align*}
    &
    \cartan \Poinc_{\ell,a} u(x)
    +
    \Poinc_{\ell+1,a} \cartan u(x)
    \\&
    =
    \ell
    \sum_{\sigma \in \Sigma(k,n)} \sum_{i=1}^{k}
    \int_{0}^{1} 
    t^{\ell-1} u_{\sigma}\left(a+t(x-a)\right) \cartanx^{\sigma-\sigma(i)} dt 
    \\&\qquad
    + 
    \sum_{\sigma \in \Sigma(k,n)} \sum_{i=1}^{k} \sum_{j=1}^{n}
    \int_{0}^{1} 
    t^{\ell} \frac{ \partial u_{\sigma} }{\partial x_{j}}\left(a+t(x-a)\right) (-1)^{i-1} (x-a)_{\sigma(i) } \cartanx^{j} \cartanx^{\sigma-\sigma(i)} dt 
    \\&\qquad
    +
    \sum_{\sigma \in \Sigma(k,n)} \sum_{j=1}^{n}
    \int_{0}^{1} t^{\ell} \frac{ \partial u_{\sigma} }{\partial x_{j}}\left(a+t(x-a)\right) dt (x-a)_{j}
    \cartanx^{\sigma}
    \\&\qquad
    - 
    \sum_{\sigma \in \Sigma(k,n)} \sum_{i=1}^{k} \sum_{j=1}^{n}
    (-1)^{i-1}
    \int_{0}^{1} t^{\ell} \frac{ \partial u_{\sigma} }{\partial x_{j}}\left(a+t(x-a)\right) dt 
    (x-a)_{\sigma(i)} \cartanx^{j} \wedge \cartanx^{\sigma-\sigma(i)}
    \\&
    =
    \sum_{\sigma \in \Sigma(k,n)} \sum_{i=1}^{k}
    \int_{0}^{1} 
    \ell t^{\ell-1} u_{\sigma}\left(a+t(x-a)\right) \cartanx^{\sigma-\sigma(i)} dt 
    \\&\qquad
    +
    \sum_{\sigma \in \Sigma(k,n)} \sum_{j=1}^{n}
    \int_{0}^{1} t^{\ell} \frac{ \partial u_{\sigma} }{\partial x_{j}}\left(a+t(x-a)\right) (x-a)_{j} dt
    \cartanx^{\sigma}
    \\&
    =
    \sum_{\sigma \in \Sigma(k,n)} 
    \int_{0}^{1} \frac{\partial}{\partial t} \left( t^{\ell} u_{\sigma}\left(a+t(x-a)\right) \right) dt \cartanx^{\sigma}
    \\&
    =
    \sum_{\sigma \in \Sigma(k,n)} 
    u_{\sigma}(x) \cartanx^{\sigma}
    =
    u(x)
    .
\end{align*}
In particular, if $\cartan u = 0$, then $\cartan \Poinc_{\ell,a} u = u$.






% Develop construction of complexes via adding patches 
\subsection{Patch coverings}

We are interested in exhausting a simplicial complex in a controlled manner. 
Suppose that $\calT$ is a manifold-like $n$-dimensional simplicial complex. 
We call $n$-simplices $S,T \in \calT$ \emph{face-connected} if there exists a sequence $S_0=S,S_1,\dots,T=S_m$ such that $S_{i} \cap S_{i-1}$ is a face for all $1 \leq i \leq m$. Clearly, face-connected is an equivalence relation. A \emph{connected component} of $\calT$ is an equivalence class under the face-connected relation, and we call $\calT$ connected if all its $n$-simplices are face-connected. 
In a manifold-like simplicial complex, two $n$-simplices have non-empty intersection if and only if they are face-connected. 

It is a consequence of Lemma~\ref{lemma:characterizationofmanifoldcomplexes} that,
if $\calT$ is a manifold-like simplicial complex, then $\patch_{\calT}(S)$ is connected for all $S \in \calT$.
Moreover, a manifold-like simplicial complex $\calT$ is connected if and only if $\bigcup\calT$ is a connected topological space. 

We let \emph{$k$-patching} refer to enumerations $S_1, S_2, \dots$ of $\subsimplex_{k}(\calT)$
such that for any $0 \leq m$, the union 
$\calU_{m} := \patch_{\calT}(S_0) \cup \patch_{\calT}(S_1) \cup \patch_{\calT}(S_2) \cup \dots \cup \patch_{\calT}(S_m)$
shares an $n$-simplex with the patch $\patch_{\calT}(S_{m+1})$.
We call the $k$-patching \emph{manifold-like} if $\calU_{m}$ is manifold-like for all $0 \leq m$.
Clearly, a $k$-patching only exists if $k < n$ and if $\calT$ is connected. 
We refer the reader to Figure~\ref{figure:illustrationpatching} for an illustration.

\begin{lemma}
    A connected manifold-like $n$-dimensional simplicial complex $\calT$ admits a $k$-patching for any $k < n$.
\end{lemma}
\begin{proof}
    We define an undirected graph by letting $\subsimplex_{k}(\calT)$ be the set of nodes 
    and connecting any $S, S' \in \subsimplex_{k}(\calT)$ if there exists $T \in \subsimplex_{k+1}(\calT)$ with $S, S' \subseteq T$. 
    Note that in this case $\patch_{\calT}(S) \cap \patch_{\calT}(S') = \patch_{\calT}(T)$. 
    Since $\calT$ is connected, the graph $\calG$ is connected. 
    
    We let $S_0, S_1, S_2, \dots$ be an enumeration of the $k$-simplices generated by a breadth-first traversal of the graph $\calG$,
    starting at some arbitrary but fixed $S_0 \in \calT$. 
    Since $\calG$ is locally finite and connected, 
    this breadth-first traversal includes all $k$-simplices of $\calT$.
    
    Let $m \in \bbZ$ with $m \geq 1$. If $S_m$ has distance $d \in \bbN$ from $S_1$ in the graph $\calG$,
    then there exists $0 \leq l \leq m$ such that $S_l$ has distance $d-1$ from $S_1$ and is connected to $S_m$. 
    It follows that the sequence $S_0, S_1, S_2, \dots$ is a $k$-patching of $\calT$. 
\end{proof}

The preceding lemma is generally not true when the $k$-patching is required to be manifold-like,
as can be verified from some simple examples;~see Figure~\ref{figure:annuluscounterexample}.

\color{Emerald}
\begin{align}
    \min\limits_{ c \in \bbR }
    \| u - c \|_{L^{p}(\Omega)}
    \leq 
    % 2^{ - \frac{p-1}{p}}
    %2^{ - 1 + \frac{1}{p}}
    \frac{1}{ 2^{ 1 - \frac{1}{p} } }
    \diam(\Omega)
    \| \nabla u \|_{L^{p}(\Omega)}
    ,
    \quad 
    u \in W^{1,p}(\Omega)
    ,
\end{align}

\begin{proof}
    Given $z \in \Omega$, we define 
    \[
        w(x,z) 
        := 
        \int_0^1 \bff( z + t(x-z) ) \cdot (x-z)
        =
        u(x) - u(z)
        .
    \]
    Subsequently,
    \begin{align*}
        w(x) = |\Omega|^{-1} \int_{\Omega} w(x,z) dz.
    \end{align*}
    Clearly, $\nabla_{x} u(x) = \nabla_{x} w(x,z) = \nabla_{x} w(x)$.
    Next, 
    \begin{align*}
        \int_{\Omega} | w(x) |^{p} dx
        &\leq 
        \int_{\Omega} |\Omega|^{-1} \int_{\Omega} | w(x,z) |^{p} dz dx
        \\&\leq 
        \int_{\Omega} |\Omega|^{-1} \int_{\Omega} \int_0^1 | \bff( z + t(x-z) ) \cdot (x-z) |^{p} dz dx
        \\&= 
        |\Omega|^{-1} \int_{\Omega} \int_{\Omega} \int_0^{D/|x-z|} | \bff( z + t(x-z) ) \cdot (x-z) |^{p} dz dx
        .
    \end{align*}

\end{proof}
\color{black}

\begin{lemma}
    Suppose that $T, T'$ are two $n$-simplices whose intersection is a common face $F := T_1 \cap T_2$. Then 
    \begin{align*}
        \| u - u_{\Omega} \|_{L^p(\Omega)} 
        &
        \leq 
        \frac{2}{((n-1)!)^n }
        \left( \frac{\diam(T)^n}{\vol(T)} \right)^n
        \left( \frac{\diam(T')^n}{n! \vol(T')} \right)^n
        \diam(\Omega)
        \| \nabla u \|_{L^p(\Omega)} 
    \end{align*}
    for any $u \in W^{1,p}(\Omega)$ with $p \in [1,\infty)$.
\end{lemma}
\begin{proof}
    Suppose a tetrahedron $T$ has vertices $v_0,v_1,\dots,v_n$ and let $F_0,F_1\dots,F_n$ be the faces opposite to those vertices. 
    The height $h(T,k)$ of the vertex $v_k$ in $T$ equals 
    \[
        h(T,k) := n \frac{\vol(T)}{\vol(F_k)}
    \]
    A lower bound for the height in terms of the volume and diameter of $T$ is 
    \[
        h(T,k) 
        = 
        n \frac{\vol(T)}{\diam(T)^n}
        \cdot 
        \frac{\diam(T)^n}{\vol(F_k)}
        \geq 
        n \frac{\vol(T)}{\diam(T)^n}
        \cdot 
        (n-1)! \frac{\diam(T)^n}{\diam(T)^{n-1}}
        \geq 
        \frac{\vol(T)}{\diam(T)^n}
        \cdot 
        n! \diam(T) 
        .
    \]
    Any subsimplex $S$ of $T$ adjacent to $v_k$ thus satisfies 
    \[
        \diam(S)
        \geq 
        \frac{\vol(T)}{\diam(T)^n}
        \cdot 
        n! \diam(T) 
        .
    \]
    We let $w \in F_0$ be the barycenter in the face opposite to $v_0$. 
    Then the convex combination of $w$ and any of the faces $F_1,\dots,F_n$ defines simplices $S_1,\dots,S_n$ which satisfy 
    \[
        \vol(S_1) = \dots = \vol(S_n) = \frac{\vol(T)}{n}
        .
    \]
    Consequently, 
    the height $h_k := $ of the vertex $w$ in $S_k$ equals 
    \[
        h_k := n \frac{\vol(S_k)}{\vol(F_k)} = \frac{\vol(T)}{\vol(F_k)}
    \]
    It follows that $T$ is star-shaped with respect to the intersection of $T$
    with the ball around $w$ of radius $h$, where $h := \min_{1 \leq k \leq n} h_k$.
    A lower bound for height in terms of the volume and diameter of $T$ is 
    \[
        h_k 
        = 
        \frac{\vol(T)}{\diam(T)^n}
        \cdot 
        \frac{\diam(T)^n}{\vol(F_k)}
        \geq 
        \frac{\vol(T)}{\diam(T)^n}
        \cdot 
        (n-1)! \frac{\diam(T)^n}{\diam(T)^{n-1}}
        \geq 
        \frac{\vol(T)}{\diam(T)^n}
        \cdot 
        (n-1)! \diam(T) 
        .
    \]
    Let now $T'$ be another $n$-simplex with vertices $v_0',v_1,\dots,v_n$.
    We construct $h'$ analogous to above and $h'' := \min(h,h')$. 
    Hence $\Omega := T \cup T'$ is star-shaped with respect to a ball around $w$ of radius $h''$.
    Using a result by Farweg and Rosteck,
    \begin{align*}
        \| u - u_{\Omega} \|_{L^p(\Omega)} 
        &
        \leq 
        2 \diam(\Omega)^n
        \omega_n^{ 1 - \frac 1 n }
        \frac{|\Omega|^{\frac{1}{n}}}{|\Ball(w,h'')|}
        \| \nabla u \|_{L^p(\Omega)} 
        \\&
        \leq 
        2 \diam(\Omega)^n
        \omega_n^{ - \frac 1 n }
        \frac{|\Omega|^{\frac{1}{n}}}{(h'')^n}
        \| \nabla u \|_{L^p(\Omega)} 
        .
    \end{align*}
    Without loss of generality, $\diam(T) \leq \diam(T')$. Now, 
    \begin{align*}
        \| u - u_{\Omega} \|_{L^p(\Omega)} 
        &
        \leq 
        \left( \frac{\diam(T)^n}{\vol(T)} \right)^n
        2 \diam(\Omega)^n
        \omega_n^{ - \frac 1 n }
        \frac{|\Omega|^{\frac{1}{n}}}{((n-1)!)^n \diam(T)^n }
        \| \nabla u \|_{L^p(\Omega)} 
        \\&
        \leq 
        \frac{2}{((n-1)!)^n }
        \left( \frac{\diam(T)^n}{\vol(T)} \right)^n
        \frac{ \diam(T')^n }{ \diam(T)^n }
        \diam(T')
        \| \nabla u \|_{L^p(\Omega)} 
        .
    \end{align*}
    We know that 
    \begin{align*}
        \diam(T')
        \leq 
        \frac{\diam(T')^n}{n! \vol(T')}
        \diam(F)
        \leq 
        \frac{\diam(T')^n}{n! \vol(T')}
        \diam(T)
        .
    \end{align*}
    The final estimate is
    \begin{align*}
        \| u - u_{\Omega} \|_{L^p(\Omega)} 
        &
        \leq 
        \frac{2}{((n-1)!)^n }
        \left( \frac{\diam(T)^n}{\vol(T)} \right)^n
        \left( \frac{\diam(T')^n}{n! \vol(T')} \right)^n
        \diam(\Omega)
        \| \nabla u \|_{L^p(\Omega)} 
        .
    \end{align*}
    This finishes the proof. 
\end{proof}


We use the following trace inequality, which can be found in the literature. 

\begin{lemma}\label{lemma:traceinequality}
    Let $p \in [1,\infty)$ and let $T$ be an $n$-dimensional simplex with a face $F$. Then 
    \begin{align*}
        \| u \|_{L^{p}(F)}^{p}
        \leq 
        \frac{|F|}{|T|} 
        \| u \|_{L^{p}(T)}^{p}
        +
        p \cdot \diam(T) 
        \frac{|F|}{|T|} 
        \| u \|_{L^{p}(T)}^{p-1}
        \| \nabla u \|_{\bfL^{p}(T)}
        .
    \end{align*}
    for all $u \in W^{1,p}(T)$. Moreover, 
    \begin{align*}
        \| u \|_{L^{\infty}(F)}
        \leq 
        \| u \|_{L^{\infty}(T)}
        .
    \end{align*}
    for all $u \in W^{1,\infty}(T)$. \qed
\end{lemma}

\begin{remark}
    Lemma~\cite{veeser2012poincare} has been stated by Veeser and Verfürth~\cite[Lemma 2.8]{veeser2012poincare} when $1 \leq p < \infty$. 
    The case $p = \infty$ is obvious because functions in $W^{1,\infty}(T)$ are already Lipschitz. 
    \color{red}\textbf{The following is probably wrong} 
    However, note that for any $p \in [1,\infty)$ and $u \in W^{1,p}(T)$ we have 
    \begin{align*}
        \| u \|_{L^{p}(F)}
        &\leq 
        \| u \|_{L^{p}(T)}^{\frac{p-1}{p}}
        \left(
            \frac{|F|}{|T|}
            \| u \|_{L^{p}(T)}
            +
            p \cdot \diam(T)
            \frac{|F|}{|T|}
            \| \nabla u \|_{\bfL^{p}(T)}
        \right)^{\frac{1}{p}}
        \\&\leq 
        \| u \|_{L^{p}(T)}^{\frac{p-1}{p}}
        \left( \frac{|F|}{|T|} \right)^{\frac 1 p}
        \left(
            \| u \|_{L^{p}(T)}^{\frac{1}{p}}
            +
            \sqrt[p]{p} \cdot \diam(T)^{\frac 1 p} 
            \| \nabla u \|_{\bfL^{p}(T)}^{\frac 1 p} 
        \right)
        .
    \end{align*}
    The limit as $p$ goes to infinity leads to the inequality as stated in the preceding lemma,
    which is therefore the natural limit case of the aforementioned trace inequality.
\end{remark}


\begin{lemma}
    Let $T_1$ and $T_{2}$ be two $n$-simplices such that $F = T_1 \cap T_2$ is a common subsimplex of dimension $n-1$. Then 
    \color{red} Here we estimate the Poincar\'e constant over a face patch.
\end{lemma}

\color{red}
Possible approaches: 
\begin{itemize}
 \item Take the trace jump (requires trace inequality with explicit constant) and extend the resulting constant function
 \item The union is star-shaped with respect to some (hopefully large) convex set, then use inequality for that situation (available in literature)
 \item Reflection trick
 \item Paper by Veeser and Verfuerth?
\end{itemize}
Most importantly, all constants must be explicitly computable!
We can do all these methods and compare the results. 
\color{black}
    
\begin{proof}
    We write $U := T_1 \cup T_2$. Let $u \in W^{1,p}(U)$.
    Suppose $u_1 \in W^{1,p}(T_1)$ and $u_2 \in W^{1,p}(T_2)$
    satisfy $\nabla u_1 = \nabla u_{|T_1}$ and $\nabla u_2 = \nabla u_{|T_2}$.
    Then there exists a constant $c \in \bbR$ such that $c = \trace_{T_1,F} u_1 - \trace_{T_1,F} u_2$.
    Consequently, if we define $u_2' = u_2 + c$, then we obtain a function $u = u_1 \cup u_2' \in W^{1,p}(T)$. 
    Notice that 
    \begin{align*}
        \| u \|_{L^{p}(U)}^{p}
        &\leq 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        \| u'_2 \|_{L^{p}(T_2)}^{p}
        \\
        &\leq 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        \left( 
            \| u_2 \|_{L^{p}(T_2)}
            +
            \left(\frac{|T_2|}{|F|}\right)^{\frac 1 p}
            \| c \|_{L^{p}(F)}
        \right)^{p}
    \end{align*}
    \begin{align*}
        \color{red}
        \| u'_2 \|_{L^{p}(T_2)}
        \leq 
        \| u_2 \|_{L^{p}(T_2)}
        +
        \| c \|_{L^{p}(T_2)}
        = 
        \| u_2 \|_{L^{p}(T_2)}
        +
        \left(\frac{|T_2|}{|F|}\right)^{\frac 1 p}
        \| c \|_{L^{p}(F)}
        .
    \end{align*}
    Recall that 
    \begin{align*}
        \| v \|_{L^{p}(F)}^{p}
        \leq 
        \frac{|F|}{|T|} 
        \| v \|_{L^{p}(T)}^{p}
        +
        p \cdot \diam(T) 
        \frac{|F|}{|T|} 
        \| v \|_{L^{p}(T)}^{p-1}
        \| \nabla v \|_{\bfL^{p}(T)}
        ,
        \quad 
        v \in W^{1,p}(T)
        .
    \end{align*}
    Now 
    \begin{align*}
        \| c \|_{L^{p}(F)}^{p}
        &\leq 
        2^{p-1}
        \| u_1 \|_{L^{p}(F)}^{p}
        +
        2^{p-1}
        \| u_2 \|_{L^{p}(F)}^{p}
    \end{align*}
    We thus proceed with 
    \begin{align*}
        \| u_1 \|_{L^{p}(F)}^{p}
        +
        \| u_2 \|_{L^{p}(F)}^{p}
        &
        \leq 
        \frac{|F|}{|T_1|} 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        p \cdot \diam(T_1) 
        \frac{|F|}{|T_1|} 
        \| u_1 \|_{L^{p}(T_1)}^{p-1}
        \| \nabla u_1 \|_{\bfL^{p}(T_1)}
        \\&\quad\quad
        +
        \frac{|F|}{|T_2|} 
        \| u_2 \|_{L^{p}(T_2)}^{p}
        +
        p \cdot \diam(T_2) 
        \frac{|F|}{|T_2|} 
        \| u_2 \|_{L^{p}(T_2)}^{p-1}
        \| \nabla u_2 \|_{\bfL^{p}(T_2)}
    \end{align*}
    If $p = 1$, then we summarize this as 
    \begin{align*}
        \| u \|_{L^{1}(U)} 
        &\leq 
        \| u_1 \|_{L^{1}(T_1)} 
        +
        \| u'_2 \|_{L^{1}(T_2)} 
        \\
        &\leq 
        \| u_1 \|_{L^{1}(T_1)} 
        +
        \| u_2 \|_{L^{1}(T_2)}
        +
        \left(\frac{|T_2|}{|F|}\right)
        \| c \|_{L^{1}(F)}
        \\
        &\leq 
        \| u_1 \|_{L^{1}(T_1)} 
        +
        \| u_2 \|_{L^{1}(T_2)}
        +
        \left(\frac{|T_2|}{|F|}\right)
        \| u_1 \|_{L^{1}(F)} 
        +
        \left(\frac{|T_2|}{|F|}\right)
        \| u_2 \|_{L^{1}(F)} 
        \\
        &\leq 
        \| u_1 \|_{L^{1}(T_1)} 
        +
        \| u_2 \|_{L^{1}(T_2)}
        \\&\qquad 
        +
        \left(\frac{|T_2|}{|F|}\right)
        \frac{|F|}{|T_1|} 
        \| u_1 \|_{L^{1}(T_1)} 
        +
        \diam(T_1) 
        \left(\frac{|T_2|}{|F|}\right)
        \frac{|F|}{|T_1|} 
        \| \nabla u_1 \|_{\bfL^{1}(T_1)}
        \\&\quad\quad
        +
        \left(\frac{|T_2|}{|F|}\right)
        \frac{|F|}{|T_2|} 
        \| u_2 \|_{L^{1}(T_2)} 
        +
        \diam(T_2) 
        \left(\frac{|T_2|}{|F|}\right)
        \frac{|F|}{|T_2|} 
        \| \nabla u_2 \|_{\bfL^{1}(T_2)}
        \\
        &\leq 
        \| u_1 \|_{L^{1}(T_1)} 
        +
        \| u_2 \|_{L^{1}(T_2)}
        \\&\qquad 
        +
        \frac{|T_2|}{|T_1|} 
        \| u_1 \|_{L^{1}(T_1)} 
        +
        \diam(T_1) 
        \frac{|T_2|}{|T_1|} 
        \| \nabla u_1 \|_{\bfL^{1}(T_1)}
        \\&\quad\quad
        +
        \| u_2 \|_{L^{1}(T_2)} 
        +
        \diam(T_2) 
        \| \nabla u_2 \|_{\bfL^{1}(T_2)}
        \\
        &\leq 
        \left( 1 + \frac{|T_2|}{|T_1|} \right)
        \| u_1 \|_{L^{1}(T_1)} 
        +
        2
        \| u_2 \|_{L^{1}(T_2)}
        +
        \diam(T_1) 
        \frac{|T_2|}{|T_1|} 
        \| \nabla u_1 \|_{\bfL^{1}(T_1)}
        +
        \diam(T_2) 
        \| \nabla u_2 \|_{\bfL^{1}(T_2)}
        .
    \end{align*}
    When $1 < p < \infty$, then Young's inequality implies 
    \begin{align*}
        \| u_1 \|_{L^{p}(F)}^{p}
        +
        \| u_2 \|_{L^{p}(F)}^{p}
        &
        \leq 
        \frac{|F|}{|T_1|} 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        \frac{|F|}{|T_1|} 
        \| u_1 \|_{L^{p}(T_1)}^{q(p-1)}
        +
        \frac p q \cdot \diam(T_1)^{p}
        \frac{|F|}{|T_1|} 
        \| \nabla u_1 \|_{\bfL^{p}(T_1)}^{p}
        \\&\quad\quad
        +
        \frac{|F|}{|T_2|} 
        \| u_2 \|_{L^{p}(T_2)}^{p}
        +
        \frac{|F|}{|T_2|} 
        \| u_2 \|_{L^{p}(T_2)}^{q(p-1)}
        +
        \frac p q \cdot \diam(T_2)^{p} 
        \frac{|F|}{|T_2|} 
        \| \nabla u_2 \|_{\bfL^{p}(T_2)}^{p}
        \\
        &
        \leq 
        \frac{|F|}{|T_1|} 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        \frac{|F|}{|T_1|} 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        (p-1) \cdot \diam(T_1)^{p} 
        \frac{|F|}{|T_1|} 
        \| \nabla u_1 \|_{\bfL^{p}(T_1)}^{p}
        \\&\quad\quad
        +
        \frac{|F|}{|T_2|} 
        \| u_2 \|_{L^{p}(T_2)}^{p}
        +
        \frac{|F|}{|T_2|} 
        \| u_2 \|_{L^{p}(T_2)}^{p}
        +
        (p-1) \cdot \diam(T_2)^{p} 
        \frac{|F|}{|T_2|} 
        \| \nabla u_2 \|_{\bfL^{p}(T_2)}^{p}
        .
    \end{align*}
    \color{red}The last terms vanish in the limit $p \rightarrow 1$. 
    It is not clear whether $p=1$ emerges as a limit case: 
    we have gained an additional $p$-norm of $u$ but applying the Poincare inequality introduces the Poincare constant, 
    whereas there is no such dependence on the Poincare constant in the case $p=1$ above. 
    \color{black}
    In summary, 
    \begin{align*}
        2^{1-p}
        \left(\frac{|T_2|}{|F|}\right)
        \| c \|_{L^{p}(F)}^{p}
        &
        \leq 
        2
        \frac{|T_2|}{|T_1|} 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        (p-1) \cdot \diam(T_1)^{p} 
        \frac{|T_2|}{|T_1|} 
        \| \nabla u_1 \|_{\bfL^{p}(T_1)}^{p}
        \\&\quad\quad\quad\quad
        +
        2
        \| u_2 \|_{L^{p}(T_2)}^{p}
        +
        (p-1) \cdot \diam(T_2)^{p} 
        \| \nabla u_2 \|_{\bfL^{p}(T_2)}^{p}
        .
    \end{align*}
    We thus find 
    %{\tiny
    \begin{align*}
        \| u \|_{L^{p}(U)}^{p}
        &\leq 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        \| u'_2 \|_{L^{p}(T_2)}^{p}
        \\
        &\leq 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        \left( 
            \| u_2 \|_{L^{p}(T_2)}
            +
            \left(\frac{|T_2|}{|F|}\right)^{\frac 1 p}
            \| c \|_{L^{p}(F)}
        \right)^{p}
        \\
        &\leq 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        2^{p-1}
        \| u_2 \|_{L^{p}(T_2)}^{p}
        +
        2^{p-1}
        \left(\frac{|T_2|}{|F|}\right)
        \| c \|_{L^{p}(F)}^{p}
        \\
        % &\leq 
        % \| u_1 \|_{L^{p}(T_1)}^{p}
        % +
        % 2^{p-1}
        % \| u_2 \|_{L^{p}(T_2)}^{p}
        % +
        % 4^{p-1}
        % \left( 
        %     2 \max\left( 
        %         \frac{|T_2|}{|T_1|} 
        %         ,
        %         1
        %     \right)
        %     \| u_1 \cup u_2 \|_{L^{p}(U)}^{p}
        %     +
        %     (p-1) \cdot 
        %     \max\left( 
        %         \diam(T_1)^p \frac{|T_2|}{|T_1|} 
        %         ,
        %         \diam(T_2)^p 
        %         %
        %     \right) 
        %     \| \nabla u_1 \cup \nabla u_2 \|_{\bfL^{p}(U)}^{p}
        % \right)
        % \\
        &\leq 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        2^{p-1}
        \| u_2 \|_{L^{p}(T_2)}^{p}
        \\&\quad\quad\quad\quad
        +
        4^{p-1}
        2
        \frac{|T_2|}{|T_1|} 
        \| u_1 \|_{L^{p}(T_1)}^{p}
        +
        4^{p-1}
        (p-1) \cdot \diam(T_1)^{p} 
        \frac{|T_2|}{|T_1|} 
        \| \nabla u_1 \|_{\bfL^{p}(T_1)}^{p}
        \\&\quad\quad\quad\quad
        +
        4^{p-1}
        2
        \| u_2 \|_{L^{p}(T_2)}^{p}
        +
        4^{p-1}
        (p-1) \cdot \diam(T_2)^{p} 
        \| \nabla u_2 \|_{\bfL^{p}(T_2)}^{p}
    \end{align*}
    %}
    We can now apply the Poincar\'e--Friedrichs inequality over each simplex. Hence,
    \begin{align*}
        \| u \|_{L^{p}(U)}^{p}
        &\leq 
        C_1 D^{p} \| \nabla u_1 \|_{L^{p}(T_1)}^{p}
        +
        2^{p-1}
        C_2 D^{p} \| \nabla u_2 \|_{L^{p}(T_2)}^{p}
        \\&\quad\quad\quad\quad
        +
        4^{p-1}
        2
        Q
        C_1 D^{p} \| \nabla u_1 \|_{L^{p}(T_1)}^{p}
        +
        4^{p-1}
        (p-1) \cdot D^{p} 
        Q
        \| \nabla u_1 \|_{\bfL^{p}(T_1)}^{p}
        \\&\quad\quad\quad\quad
        +
        4^{p-1}
        2
        C_2 D^{p} \| \nabla u_2 \|_{L^{p}(T_2)}^{p}
        +
        4^{p-1}
        (p-1) \cdot D^{p} 
        \| \nabla u_2 \|_{\bfL^{p}(T_2)}^{p}
        \\
        &\leq 
        \left( 
            C_1 
            +
            4^{p-1}
            2
            Q
            C_1 
            +
            4^{p-1}
            (p-1)
            Q
        \right) 
        D^{p}
        \| \nabla u_1 \|_{L^{p}(T_1)}^{p}
        \\&\quad\quad\quad\quad
        +
        \left( 
        2^{p-1}
        C_2 
        +
        4^{p-1}
        2
        C_2 
        +
        4^{p-1}
        (p-1)
        \right) 
        D^{p}
        \| \nabla u_2 \|_{L^{p}(T_2)}^{p}
        \\
        &\leq 
        \left( 
            2^{p-1}
            C  
            +
            4^{p-1}
            2
            Q'
            C_1 
            +
            4^{p-1}
            (p-1)
            Q'
        \right) 
        D^{p} 
        \| \nabla u \|_{L^{p}(U)}^{p}
        .
    \end{align*}
    
    \color{red} Possibly the estimate can be tweaked to obtain nicer constants.
\end{proof}



%  
 % \color{red}We want to summarize the Lp norms so that the Poincare inequality over $U_F$ is applied only once. In the special cases $p=1$ and $p=\infty$, this works as above. Do we have a formula for general $p$ that contains these as limit cases? \color{black}
 % In the special case $p < \infty$, we use the finite-dimensional H\"older inequality to find 
 % \begin{align*}
 %    \| w_{m} \|_{L^{p}(T_m)}^{p}
 %    &\leq 
 %    3^{p-1}
 %    \| u_{F_m} \|_{L^{p}(T_m)}^{p}
 %    +
 %    3^{p-1}
 %    \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
 %    \| u_{F_{m}} \|_{L^{p}(T_{j(m)})}^{p}
 %    +
 %    3^{p-1}
 %    \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
 %    \| w_{m-1}\|_{L^{p}(T_{j(m)})}^{p}
 %    \\&\leq 
 %    3^{p-1}
 %    \max\left( 1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } \right)
 %    \| u_{F_m} \|_{L^{p}(U_{F_m})}^{p}
 %    +
 %    3^{p-1}
 %    \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
 %    \| w_{m-1}\|_{L^{p}(T_{j(m)})}^{p}
 %    ,
 % \end{align*}
 % and therefore
 % \begin{align*}
 %    \| w_{m} \|_{L^{p}(T_m)}
 %    &\leq 
 %    3^{\frac{p-1}{p}}
 %    \max\left( 1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } \right)^{\frac 1 p}
 %    \| u_{F_m} \|_{L^{p}(U_{F_m})} 
 %    +
 %    3^{\frac{p-1}{p}}
 %    \frac{ \vol(T_m)^{\frac 1 p} }{ \vol(T_{j(m)})^{\frac 1 p} }
 %    \| w_{m-1}\|_{L^{p}(T_{j(m)})} 
 %    .
 % \end{align*}
 % \color{blue}
 % In the special case $p < \infty$, we use the finite-dimensional H\"older inequality to find 
 % \begin{align*}
 %    \| w_{m} \|_{L^{p}(T_m)}^{p}
 %    &\leq 
 %    \left( 
 %        1 + 2 \frac{ \vol(T_m)^{\frac{1}{p-1}} }{ \vol(T_{j(m)})^{\frac{1}{p-1}} }
 %    \right)^{ p-1 }
 %    \left( 
 %        \| u_{F_m} \|_{L^{p}(T_m)}^{p}
 %        +
 %        \| u_{F_{m}} \|_{L^{p}(T_{j(m)})}^{p}
 %        +
 %        \| w_{m-1}\|_{L^{p}(T_{j(m)})}^{p}
 %    \right)
 %    ,
 % \end{align*}
 % and therefore
 % \begin{align*}
 %    \| w_{m} \|_{L^{p}(T_m)}
 %    &\leq 
 %    \left( 
 %        1 + 2 \frac{ \vol(T_m)^{\frac{1}{p-1}} }{ \vol(T_{j(m)})^{\frac{1}{p-1}} }
 %    \right)^{ \frac{p-1}{p} }
 %    \left( 
 %        \| u_{F_m} \|_{L^{p}(T_m)} 
 %        +
 %        \| u_{F_{m}} \|_{L^{p}(T_{j(m)})} 
 %        +
 %        \| w_{m-1}\|_{L^{p}(T_{j(m)})} 
 %    \right)
 %    .
 % \end{align*}
 % \color{black}
 
 
 



we have any of the following two conditions:
\begin{itemize}
 \item 
 there exists $\epsilon > 0$ 
 and a homeomorphism 
 \begin{align*}
    \phi : \Ball_\epsilon(x) \cap \underlying{\calT}  
    \rightarrow 
    \left\{ x \in \bbR^{n} \suchthat |x| \leq 1 \right\}
 \end{align*}
 such that $\phi(x) = 0$,
 \item 
 there exists $\epsilon > 0$ and a homeomorphism 
 \begin{align*}
    \phi : \Ball_\epsilon(x) \cap \underlying{\calT} 
    \rightarrow 
    \left\{ x \in \bbR^{n} \suchthat |x| \leq 1, x_n \leq 0 \right\}
 \end{align*}
 such that $\phi(x) = 0$.
\end{itemize}
This characterizes the union of the simplicial complex $\calT$ as a topological manifold with boundary. 















\subsection{On the topology of shellable triangulations}
    
A shellable simplicial complex that triangulates a manifold has a very restricted topology. 
The Mayer-Vietoris theorem implies restrictions on the homology groups of simplicial complexes iteratively constructed via shelling. 

    Suppose furthermore that $T$ is an $n$-simplex, $T \notin \calT$, 
    whose boundary complex intersects with $\partial\calT$ at a non-empty simplicial complex $\calS$ of dimension $n-1$. 
    In particular, $\calS$ is either the whole boundary complex of $T$ or a patch around a proper subsimplex of $T$. 
    We write $\calT'$ for the  simplicial complex that contains $\calT \cup T$.


Suppose that $\calT$ is a strongly connected $n$-dimensional simplicial complex that triangulates a manifold, and suppose that its boundary complex $\partial\calT$ is either empty or strongly connected.  
Suppose furthermore that $T$ is an $n$-simplex, $T \notin \calT$, whose boundary complex intersects with $\partial\calT$ at a non-empty simplicial complex $\calS$ of dimension $n-1$. In particular, $\calS$ is either the whole boundary complex of $T$ or a patch around a proper subsimplex of $T$. We write $\calT'$ be the  simplicial complex that contains $\calT \cup T$.
We exclude the case $n \leq 1$ since otherwise the discussion is trivial.

According to the simplicial Mayer-Vietoris theorem, there exists an exact sequence 
\begin{align*}
    \begin{CD}
        \dots \longrightarrow H_{k}(\calS) \longrightarrow H_{k}(\calT \oplus T) \longrightarrow H_{k}(\calT') \longrightarrow H_{k-1}(\calS) \longrightarrow\dots 
    \end{CD}
\end{align*}
We notice that $\calS$, $\calT$, $T$ and $\calT'$ are each connected, and hence their zeroth homology groups are isomorphic to ${G}$. 
By the nature of the mappings in the Mayer-Vietoris sequence, 
\color{red}which uses some specific knowledge about the arrows\color{black}, 
we see that 
\begin{align*}
    \begin{CD}
        0 \longrightarrow H_{0}(\calS) \longrightarrow H_{0}(\calT) \oplus H_{0}(T) \longrightarrow H_{0}(\calT') \longrightarrow 0 
    \end{CD}
\end{align*}
is an exact sequence. 
Moreover, $H_{k}(\calS) = H_{k}(T) = 0$ for $0 < k < n-1$. Hence, for $1 < k < n-1$,
the Mayer-Vietoris sequence includes the exact sequence 
\begin{align*}
    \begin{CD}
        0 \longrightarrow H_{k}(\calT \oplus T) \longrightarrow H_{k}(\calT') \longrightarrow 0 
    \end{CD}
\end{align*}
and we conclude that $H_{k}(\calT) = 0$ for $0 < k < n-1$.
Finally, the Mayer-Vietoris sequence includes the exact sequence 
\begin{align*}
    \begin{CD}
        0 \longrightarrow H_{n}(\calT \oplus T) \longrightarrow H_{n}(\calT') \longrightarrow H_{n-1}(\calS) \longrightarrow H_{n-1}(\calT \oplus T) \longrightarrow H_{n-1}(\calT') \longrightarrow 0 
    \end{CD}
\end{align*}

% Here, if $n=1$, it already follows that $H_{n}(\calT \oplus T) \simeq H_{n}(\calT')$.
% % We know that  $H_{0}(\calT') \simeq H_{0}(\calT) \simeq H_{0}(T) \simeq H_{0}(\calS) \simeq \bbZ$ because the respective simplicial complexes are path-connected. 
% Hence $H_{1}(\calT) \oplus H_{1}(T) \simeq H_{1}(\calT')$. 
% one easily sees that $H_{0}(\calT') \simeq \bbZ$ and $H_{1}(\calT) \oplus H_{1}(T) \simeq H_{1}(\calT')$. 
Since $\calT$ and $T$ are triangulations of manifolds with non-empty boundary, their $n$-th simplicial homology groups vanish. 
then $H_{n}(\calT') \simeq H_{n}(\calT \oplus T)$ are trivial and $H_{n-1}(\calT') \simeq H_{n-1}(\calT \oplus T)$ follows.
Consider now the case that $\calS$ is isomorphic to a sphere.
Since the boundary complex of $\calT$ is strongly connected and non-branching, it must coincide with $\calS$. Hence $\calT'$ triangulates a manifold without boundary, and thus $H_{n}(\calT') \simeq \bbZ$. 
\color{red}By some hand-waving argument, $H_{n}(\calT') \longrightarrow H_{n-1}(\calS)$ is an isomorphism.\color{black}
Hence $H_{n-1}(\calT) \rightarrow H_{n-1}(\calT')$ is an isomorphism.

In the case that $\calS$ is isomorphic to a disk, we have $H_{n-1}(\calS) = 0$,
and then $H_{n}(\calT') \simeq H_{n}(\calT \oplus T) = 0$ are trivial 
and $H_{n-1}(\calT') \simeq H_{n-1}(\calT \oplus T)$ follows.
Consider now the case that $\calS$ is isomorphic to a sphere.
Since the boundary complex of $\calT$ is strongly connected and non-branching, it must coincide with $\calS$. Hence $\calT'$ triangulates a manifold without boundary, and thus $H_{n}(\calT') \simeq {G}$. 
\color{red}By some hand-waving argument, $H_{n}(\calT') \longrightarrow H_{n-1}(\calS)$ is an isomorphism.\color{black}
Hence $H_{n-1}(\calT) \rightarrow H_{n-1}(\calT')$ is an isomorphism.


We conclude that the simplicial homology groups of a shellable $n$-dimensional simplicial complex $\calT$ that triangulates a manifold satisfy 
\begin{align*}
    H_0(\calT) \simeq \bbZ, 
    \quad 
    H_1(\calT) \simeq \dots \simeq H_{n-1}(\calT) \simeq 0.
\end{align*}
Moreover, $H_n(\calT) \simeq {G}$ if $\calT$ has no boundary and $H_n(\calT) \simeq 0$ otherwise. 
Moreover, $H_n(\calT) \simeq \bbZ$ if $\calT$ has no boundary and $H_n(\calT) \simeq 0$ otherwise. 

% then $H_{n}(\calT') \simeq H_{n}(\calT \oplus T)$ and $H_{n-1}(\calT') \simeq H_{n-1}(\calT \oplus T)$ follow immediately.
% Moreover, Thus $H_{n}(\calT') = H_{n}(\calT) \oplus H_{n}(\calS)$.
% We conclude that any shellable simplicial complex has the homology groups of a disk or a sphere. 
% NB: the zeroth homology is always free, and the n-th homology group, being the kernel of a mapping free abelian group, is free as well.
% \begin{align*}
%     \begin{CD}
%         0 \longrightarrow H_{1}(\calT) \oplus H_{1}(T) \longrightarrow H_{1}(\calT') \longrightarrow H_{0}(\calS) \longrightarrow H_{0}(\calT) \oplus H_{0}(T) \longrightarrow H_{0}(\calT') \longrightarrow 0 
%     \end{CD}
% \end{align*}

\begin{remark}    
    % % We know that  $H_{0}(\calT') \simeq H_{0}(\calT) \simeq H_{0}(T) \simeq H_{0}(\calS) \simeq {G}$ because the respective simplicial complexes are path-connected. 
    % Hence $H_{1}(\calT) \oplus H_{1}(T) \simeq H_{1}(\calT')$. 
    % one easily sees that $H_{0}(\calT') \simeq {G}$ and $H_{1}(\calT) \oplus H_{1}(T) \simeq H_{1}(\calT')$. 
     
    % then $H_{n}(\calT') \simeq H_{n}(\calT \oplus T)$ and $H_{n-1}(\calT') \simeq H_{n-1}(\calT \oplus T)$ follow immediately.
    % Moreover, Thus $H_{n}(\calT') = H_{n}(\calT) \oplus H_{n}(\calS)$.
    % We conclude that any shellable simplicial complex has the homology groups of a disk or a sphere. 
    % NB: the zeroth homology is always free, and the n-th homology group, being the kernel of a mapping free abelian group, is free as well.
    % \begin{align*}
    %     \begin{CD}
    %         0 \longrightarrow H_{1}(\calT) \oplus H_{1}(T) \longrightarrow H_{1}(\calT') \longrightarrow H_{0}(\calS) \longrightarrow H_{0}(\calT) \oplus H_{0}(T) \longrightarrow H_{0}(\calT') \longrightarrow 0 
    %     \end{CD}
    % \end{align*}
\end{remark}













\newpage\color{red}
 We want 
 \begin{align*}
    \| w_{m} \|_{L^{p}(T_m)}^{p}
    \leq
    \left( 
        1 
        + 
        2
        \frac{ \vol(T_m)^{\frac q p} }{ \vol(T_{j(m)})^{\frac q p} }
    \right)^{p/q}
    \left( 
        \| u_{F_m} \|_{L^{p}(T_m)}^{p}
        +
        \| u_{F_{m}} \|_{L^{p}(T_{j(m)})}^{p}
        +
        \| w_{m-1}\|_{L^{p}(T_{j(m)})}^{p}
    \right)
    .
 \end{align*}
 In the special case $p=1$ and $p=\infty$,
 \begin{align*}
    \| w_{m} \|_{L^{1}(T_m)}
    &\leq 
    \max\left(
        1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } 
    \right)
    \| u_{F_m} \|_{L^{1}(U_{F_m})}
    +
    \max\left(
        1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } 
    \right)
    \| w_{m-1}\|_{L^{1}(T_{j(m)})}
    .
    \\
    \| w_{m} \|_{L^{2}(T_m)}^{2}
    &\leq
    \left( 
        1 
        + 
        2
        \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
    \right)
    \left( 
        \| u_{F_m} \|_{L^{2}(T_m)}^{2}
        +
        \| u_{F_{m}} \|_{L^{2}(T_{j(m)})}^{2}
        +
        \| w_{m-1}\|_{L^{2}(T_{j(m)})}^{2}
    \right)
    .
    \\
    \| w_{m} \|_{L^{\infty}(T_m)}
    &\leq 
    3
    \max\left( 
        \| u_{F_m} \|_{L^{\infty}(U_{F_m})}
        ,
        \| w_{m-1}\|_{L^{\infty}(T_{j(m)})}
    \right)
    .
 \end{align*}
 \color{orange}
 \begin{align*}
    \| w_{m} \|_{L^{p}(T_m)}^{p}
    \leq
    \left( 
        2 
        + 
        \frac{ \vol(T_m)^{\frac q p} }{ \vol(T_{j(m)})^{\frac q p} }
    \right)^{p/q}
    \left( 
        \| u_{F_m} \|_{L^{p}(T_m)}^{p}
        +
        \| u_{F_{m}} \|_{L^{p}(T_{j(m)})}^{p}
        +
        \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
        \| w_{m-1}\|_{L^{p}(T_{j(m)})}^{p}
    \right)
    .
 \end{align*}
 In the special case $p=1$ and $p=\infty$, 
 \begin{align*}
    \| w_{m} \|_{L^{1}(T_m)}
    &\leq 
    \max\left(
        1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } 
    \right)
    \| u_{F_m} \|_{L^{1}(U_{F_m})}
    +
    \max\left(
        1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } 
    \right)
    \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
    \| w_{m-1}\|_{L^{1}(T_{j(m)})}
    .
    \\
    \| w_{m} \|_{L^{2}(T_m)}^{2}
    &\leq
    \left( 
        2 
        + 
        \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
    \right) 
    \left( 
        \| u_{F_m} \|_{L^{2}(T_m)}^{2}
        +
        \| u_{F_{m}} \|_{L^{2}(T_{j(m)})}^{2}
        +
        \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
        \| w_{m-1}\|_{L^{2}(T_{j(m)})}^{2}
    \right)
    \\
    \| w_{m} \|_{L^{\infty}(T_m)}
    &\leq 
    3
    \max\left( 
        \| u_{F_m} \|_{L^{\infty}(U_{F_m})}
        ,
        \| w_{m-1}\|_{L^{\infty}(T_{j(m)})}
    \right)
    .
 \end{align*}
 \color{JungleGreen}
 \begin{align*}
    \| w_{m} \|_{L^{p}(T_m)}^{p}
    &\leq
    \left( 
        3
    \right)^{p/q}
    \left( 
        \| u_{F_m} \|_{L^{p}(T_m)}^{p}
        +
        \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
        \| u_{F_{m}} \|_{L^{p}(T_{j(m)})}^{p}
        +
        \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
        \| w_{m-1}\|_{L^{p}(T_{j(m)})}^{p}
    \right)
    \\&
    \leq
    \left( 
        3
    \right)^{p/q}
    \left( 
        \max\left( 1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } \right)
        \| u_{F_{m}} \|_{L^{p}(T_m \cup T_{j(m)})}^{p}
        +
        \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
        \| w_{m-1}\|_{L^{p}(T_{j(m)})}^{p}
    \right)
    .
 \end{align*}
 In the special case $p=1$ and $p=\infty$, ????
 \begin{align*}
    \| w_{m} \|_{L^{1}(T_m)}
    &\leq 
    \left( 
        \max\left( 1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } \right)
        \| u_{F_{m}} \|_{L^{1}(T_m \cup T_{j(m)})}^{1}
        +
        \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
        \| w_{m-1}\|_{L^{1}(T_{j(m)})}^{1}
    \right)
    .
    \\
    \| w_{m} \|_{L^{2}(T_m)}^{2}
    &\leq
    3
    \left( 
        \max\left( 1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } \right)
        \| u_{F_{m}} \|_{L^{2}(T_m \cup T_{j(m)})}^{2}
        +
        \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
        \| w_{m-1}\|_{L^{2}(T_{j(m)})}^{2}
    \right)
    \\
    \| w_{m} \|_{L^{\infty}(T_m)}
    &\leq 
    3
    \max\left( 
        \| u_{F_m} \|_{L^{\infty}(U_{F_m})}
        ,
        \| w_{m-1}\|_{L^{\infty}(T_{j(m)})}
    \right)
    .
 \end{align*}
 \color{MidnightBlue}
 \begin{align*}
    \| w_{m} \|_{L^{p}(T_m)}^{p}
    &\leq
    \left( 
        2 
        + 
        \frac{ \vol(T_m)^{\frac q p} }{ \vol(T_{j(m)})^{\frac q p} }
    \right)^{p/q}
    \left( 
        \| u_{F_m} \|_{L^{p}(T_m)}^{p}
        +
        \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
        \| u_{F_{m}} \|_{L^{p}(T_{j(m)})}^{p}
        +
        \| w_{m-1}\|_{L^{p}(T_{j(m)})}^{p}
    \right)
    \\&
    \leq
    \left( 
        2 
        + 
        \frac{ \vol(T_m)^{\frac q p} }{ \vol(T_{j(m)})^{\frac q p} }
    \right)^{p/q}
    \left( 
        \max\left( 1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } \right)
        \| u_{F_{m}} \|_{L^{p}(T_m \cup T_{j(m)})}^{p}
        +
        \| w_{m-1}\|_{L^{p}(T_{j(m)})}^{p}
    \right)
    .
 \end{align*}
 In the special case $p=1$ and $p=\infty$, ????
 \begin{align*}
    \| w_{m} \|_{L^{1}(T_m)}
    &\leq 
    \max\left( 1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } \right)
    \left( 
        \max\left( 1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } \right)
        \| u_{F_{m}} \|_{L^{1}(T_m \cup T_{j(m)})} 
        +
        \| w_{m-1}\|_{L^{1}(T_{j(m)})} 
    \right)
    .
    \\
    \| w_{m} \|_{L^{2}(T_m)}^{2}
    &\leq 
    \left( 
        2 
        + 
        \frac{ \vol(T_m) }{ \vol(T_{j(m)}) }
    \right) 
    \left( 
        \max\left( 1, \frac{ \vol(T_m) }{ \vol(T_{j(m)}) } \right)
        \| u_{F_{m}} \|_{L^{2}(T_m \cup T_{j(m)})}^{2}
        +
        \| w_{m-1}\|_{L^{2}(T_{j(m)})}^{2}
    \right)
    \\
    \| w_{m} \|_{L^{\infty}(T_m)}
    &\leq 
    3
    \max\left( 
        \| u_{F_m} \|_{L^{\infty}(U_{F_m})}
        ,
        \| w_{m-1}\|_{L^{\infty}(T_{j(m)})}
    \right)
    .
 \end{align*}
 \color{black}
 
 
 
 
 
 
 
 We introduce the operator $B^{k}$, which can be written in several alternative forms
\begin{align*}
    B^{k} u(x) 
    &= 
    - |\Omega|^{-1}
    \int_{\Omega} \,(x-a) \lrcorner \int_1^\infty t^{{k}-1}\,u\left( a+t(x-a) \right) \,dt\,da
    \\&= 
    |\Omega|^{-1}
    \int_{\Omega} \,(x-a) \lrcorner \int_0^1 t^{-{k}-1}\,u\left( a+(x-a)/s \right) \,ds\,da
    .
\end{align*}
If $u \in C^{\infty}_{c}(\bbR^{n},\Alt^{k})$, 
then $B^{k} u$ is smooth with support in $\bbR^{n}\setminus\overline\Omega$ and $B^{k} u(x) = 0$ when $x \notin \Omega$. 
Since $\Omega$ is convex, $u \in C^{\infty}_{c}(\Omega,\Alt^{k})$ implies $\supp B^{k} u \subset\Omega$, 
Since $\Omega$ is bounded, $\supp u \subseteq \overline\Omega$ implies $\supp B^{k} u \subset\overline\Omega$. 
% The fact that $B^{k}$ indeed maps 
% $C^{\infty}_{c}(\bbR^{n},\Alt^{k})$ to $C^{\infty}_{c}(\bbR^{n},\Alt^{{k}-1})$ will be a the following theorem.

\begin{align*}
    \int_{\Omega}
    \left| B^{k} u(x) \right|^{p}
    dx
    &
    = 
    |\Omega|^{-1}
    \int_{\Omega}
    \int_{\Omega} 
    \int_0^1
    s^{(-{k}-1)p}\, |x-a|^{p} \left| u\left( a+(x-a)/s \right) \right|^{p} \,ds\,da
    dx
    \\&
    = 
    |\Omega|^{-1}
    \int_{\Omega}
    \int_{\Omega-a} 
    \int_{|z|/D}^{1}
    s^{(-{k}-1)p}\, |z|^{p} \left| u\left( a+z/s \right) \right|^{p} \,ds\,da
    dz
    \\&
    = 
    |\Omega|^{-1}
    \int_{\Omega}
    \int_{2\Omega} 
    \int_{|z|/D}^{1}
    s^{(-{k}-1)p}\, |z|^{p} \left| u\left( a+z/s \right) \right|^{p} \,ds\,da
    dz
    \\&
    = 
    |\Omega|^{-1}
    \int_{\Omega + z/s}
    \int_{2\Omega} 
    \int_{|z|/D}^{1} % y = a + z/s
    s^{(-{k}-1)p}\, |z|^{p} \left| u\left( y \right) \right|^{p} \,ds\,dy
    dz
    \\&
    = 
    |\Omega|^{-1}
    \int_{2\Omega}
    \int_{2\Omega} 
    \int_{|z|/D}^{1} % y = a + z/s
    s^{(-{k}-1)p}\, |z|^{p} \left| u\left( y \right) \right|^{p} \,ds\,dy
    dz
    .
\end{align*}



\begin{align*}
    G_\ell(x,y) 
    &\leq 
    \int_{0}^{\frac{D}{|x-y|}} \tau^{n-\ell} (\tau+1)^{\ell-1} \,d\tau
    \\
    &\leq 
    \frac{|x-y|}{D}
    \int_{0}^{\frac{D}{|x-y|}} \frac{D}{|x-y|} \tau^{n-\ell} (\tau+1)^{\ell-1} \,d\tau
    .
\end{align*}
\begin{align*}
    G_\ell(x,y)^{p} 
    &\leq 
    \frac{|x-y|}{D}
    \int_{0}^{\frac{D}{|x-y|}} \frac{D^{p}}{|x-y|^{p}} \tau^{pn-p\ell} (\tau+1)^{p\ell-p} \,d\tau
    \\&\leq 
    \frac{|x-y|}{D}
    \frac{D^{p}}{|x-y|^{p}} \int_{0}^{\frac{D}{|x-y|}} (\tau+1)^{pn-p} \,d\tau
    \\&\leq 
    \frac{D^{p-1}}{|x-y|^{p-1}} \left( \left( \frac{D}{|x-y|} + 1 \right)^{pn-p+1} - 1 \right)
    \\&\leq 
    \frac{D^{p-1}}{|x-y|^{p-1}} \left( 2^{pn-p+1} \left( \frac{D}{|x-y|} \right)^{pn-p+1} - 1 \right)
    \\&\leq 
    2^{pn-p+1} \frac{D^{pn}}{|x-y|^{pn}} - \frac{D^{p-1}}{|x-y|^{p-1}}
    .
\end{align*}





Moreover,  
\begin{align*}
    \int_{\Omega} \left| B_{\ell} u(x) \right|^{p} dx
    &=
    |\Omega|^{-1} 
    \int_{\Omega} 
    \int_{\Omega} 
    \left( 2^{pn-p+1} \frac{D^{pn}}{|x-y|^{pn}} - \frac{D^{p-1}}{|x-y|^{p-1}} \right)
    \left| (x-y)\lrcorner u(y) \right|^{p} 
    dy dx
    \\&=
    |\Omega|^{-1} 
    \int_{\Omega} 
    \int_{\Omega} \left( 2^{pn-p+1} D^{pn} |x-y|^{-pn+p} - D^{p-1} |x-y| \right) dx
    \left| u(y) \right|^{p} 
    dy
    .
\end{align*}






We use the radial integrals
\begin{align*}
    \int_{B_D(0)} |z|^{m} dz
    =
    \vol_{n-1}(S_1) \int_0^D r^{m} r^{n-1} dr
    =
    \vol_{n-1}(S_1) \int_0^D r^{m+n-1} dr
    =
    \vol_{n-1}(S_1) \frac{D^{m+n}}{m+n}
    .
\end{align*}







In order to see other properties of the operators, we apply a different change of variables. 
Let us write this in detail for the operator $R_{\ell}$. 
We substitute $y$ by the new variable $a=y+t(x-y)$.
Whence $da = (1-t)^n dy$ and $t(x-y) = a-y$ and $x-y = (a-y)/t$ and $x - (a-x)/t = y$
\begin{align*}
    \Poinc_{\ell} u(x) 
    &= 
    \int \int_{0}^{1} (t-1)^{n-\ell}t^{\ell-1} 
    \chi_{\Omega}\left(y+t(y-x)\right) 
    (x-y)\lrcorner u(y) \,dt\,dy 
    \\&= 
    \int \int_{0}^{1} (t-1)^{n-\ell}t^{\ell-1} 
    \chi_{\Omega}\left(y+(x-y)-(x-y)+t(y-x)\right) 
    (x-y)\lrcorner u(y) \,dt\,dy 
    \\&= 
    \int \int_{0}^{1} (t-1)^{n-\ell}t^{\ell-1} 
    \chi_{\Omega}\left(x+(t+1)(y-x)\right) 
    (x-y)\lrcorner u(y) \,dt\,dy 
    \\
    &= 
    \int \int_{0}^{1} (t-1)^{n-\ell}t^{\ell-1} (t+1)^{n}
    \chi_{\Omega}\left(a\right) 
    \frac{ x-a }{t+1}\lrcorner u( x + (a-x)/(t+1) ) \,dt\,dy 
\end{align*}
Then we substitute $1-s = 1/(t+1)$, that is, $s = t/(t+1)$:
Whence $t = \left( 1/s-1 \right)^{-1}$.
\begin{align*}
    \Poinc_{\ell} u(x) 
    &= 
    \int \int_{0}^{1} (t-1)^{n-\ell} \left( 1/s-1 \right)^{\ell-1} (t+1)^{n}
    \chi_{\Omega}\left(a\right) 
    \frac{ x-a }{t+1}\lrcorner u( x + (a-x)/(t+1) ) \,dt\,dy 
    \\
    &= 
    .
\end{align*}


Then we substitute $s = (t-1)/t$:
\begin{align*}
    &= 
    \int \int_{0}^{1} (t-1)^{n-\ell}t^{-n+\ell-1} 
    \chi_{\Omega}\left(a\right)
    \frac{(a-y)}{t} \lrcorner u(x+(a-x)/t) \,dt\,da 
    \\
    &= 
    \int \int_{0}^{1} (t-1)^{n-\ell}t^{\ell-1-n-1} \chi_{\Omega}\left(a\right)\, (x-a)\lrcorner u(x+(a-x)/t) \,dt\,da
    .
\end{align*}
Then we substitute $s = (t-1)/t$:
\begin{align*}
    \Poinc_{\ell} u(x) 
    &= 
    \int \int_{0}^{1} s^{n-\ell} (s-1)^{2} \chi_{\Omega}\left(a\right)\, (x-a)\lrcorner u( x+(s-1)(a-x) ) \frac{-1}{(s-1)^2}\,ds\,da
    \\
    &= 
    - \int \int_{0}^{1} s^{n-\ell} \chi_{\Omega}\left(a\right)\, (x-a)\lrcorner u( s(a-x) - a ) \,ds\,da
    \\
    &=
    - \int \chi_{\Omega}(a) \,(x-a)\lrcorner \int_{0}^{1} t^{\ell-1} u\left(a+t(x-a)\right)\,dt\,da\;
    .
\end{align*}
We copy a statement by McIntosh and Costabel:
\begin{align*}
    \Poinc_{\ell} u(x) 
    = 
    - \int \chi_{\Omega}(a) \,(x-a)\lrcorner \int_{0}^{1} t^{\ell-1} u\left(a+t(x-a)\right)\,dt\,da\;
    .
\end{align*}
$a = y + t(x-y)$
$s = \frac{t}{t-1}$
From that representation we can tell that whenever $u \in C^{\infty}(\bbR^{n})$ has support contained in $\overline\Omega$, we immediately have that $\Poinc_{\ell} u(x)$ is smooth with support contained in $\overline\Omega$ as well. 











From this form of $\Poinc_{\ell}$, because of the unbounded interval of integration in $t$, one cannot immediately conclude that $\Poinc_{\ell}$ maps ${C^\infty}$ functions to ${C^\infty}$ functions.
But if $u\in{C^\infty_c}(\bbR^n,\Alt^\ell)$, one sees that $\Poinc_{\ell} u$ is ${C^\infty}$ on 
$\bbR^n\setminus\supp\chi_{\Omega}$, and that 
$\Poinc_{\ell} u(x)=0$ unless $x$ lies in the starlike hull of $\supp u$ with respect to $B$. 
Thus if $\Omega$ is open and starlike with respect to $B$, then   
$u\in{C^\infty_c}(\Omega,\Alt^\ell)$ implies $\supp \Poinc_{\ell} u \subset\Omega$, and, if $\Omega$ is bounded, then
$u\in{C^\infty}_{\overline\Omega}(\bbR^n,\Alt^\ell)$ implies $\supp \Poinc_{\ell} u \subset\overline\Omega$. 
The fact that $\Poinc_{\ell}$ indeed maps 
${C^\infty_c}(\bbR^n,\Alt^\ell)$ to ${C^\infty_c}(\bbR^n,\Alt^{\ell-1})$ will be a consequence of Theorem~\ref{T:pseudo} below.




\subsection{Homotopy relations}

Cartan's formula for the Lie derivative of a differential form with respect to a vector field can be written as
$$
  \frac{d}{dt}F^*_t u = F^*_t \left(d(X_t\lrcorner u) + X_t\lrcorner du\right)\;,
$$
where $F^*_t$ denotes the pull-back by the flow $F_t$ associated with the vector field $X_t$. Here we consider the special case of the dilation flow with center $a$
$$
  F_t(x) = a+t(x-a) \quad\text{ with vector field } X_t=x-a\;,
$$
which gives a pull-back of
$$
  F^*_t u(x) = t^\ell \,u\left(a+t(x-a)\right) \quad \text{for an $\ell$-form } u \;.
$$
This leads to the formula
\begin{equation}
\label{eq:Cartan}
 \frac{d}{dt}(t^\ell u\left(a+t(x-a)\right) =
    d\Bigl(t^{\ell-1}(x-a)\lrcorner u\left(a+t(x-a)\right)\Bigr) +
    t^{\ell}(x-a)\lrcorner du\left(a+t(x-a)\right)
\end{equation}
which can also be verified elementarily from the formulas we gave in Section~\ref{S:notation}.

Integrating \eqref{eq:Cartan} from $0$ to $1$ and comparing with \eqref{eq:regPoincare}, 
we find the homotopy relations, valid for all $u\in{C^\infty_c}(\bbR^n,\Alt^\ell)$ 
\begin{equation}
\begin{aligned}
\label{eq:dR+Rd=1}
 dR_{\ell} u + R_{\ell+1} du &= u\; &&(1\le\ell\le n-1)\;;\\
 R_1 du &= u - \left(\chi_{\Omega},u\right)\; &&(\ell=0)\;;\\
 dR_nu &=u &&(\ell=n)\;.
\end{aligned}
\end{equation}
One could be tempted to integrate Cartan's formula from $1$ to $\infty$ and compare with \eqref{eq:Bogo}, thus formally obtaining a similar homotopy relation for $\Poinc_{\ell}$ directly. The result is indeed true except for $\ell=n$, but for a rigorous proof we prefer to use the duality relation \eqref{eq:dualRT} to deduce corresponding anticommutativity relations for $\Poinc_{\ell}$ from the relations \eqref{eq:dR+Rd=1} which are already proved. Here is what one obtains for $u\in{C^\infty_c}(\bbR^n,\Alt^\ell)$:
\begin{equation}
\begin{aligned}
\label{eq:dT+Td=1}
  d\Poinc_{\ell} u + \Poinc_{\ell+1} du &= u\; &&(1\le\ell\le n-1)\;;\\
  T_1 du &= u \; &&(\ell=0)\;;\\
 dT_n u &=u - (\int\! u)\star\chi_{\Omega}&&(\ell=n)\;.
\end{aligned}
\end{equation}
Here we consider $\chi_{\Omega}$ as an element of ${C^\infty_c}(\bbR^n,\Alt^0)$, so that for another $0$-form $u$ we have the $L^2$ scalar product $\left(\chi_{\Omega},u\right)=\int\chi_{\Omega}(a)u(a)da$, and $\star\chi_{\Omega}$ is the $n$-form $\chi_{\Omega}(x)dx_1\wedge\dots\wedge dx_n$. 

The formulas for the endpoints $\ell=0$ and $\ell=n$ correspond to the two extended de Rham complexes without boundary conditions and with compact support, see \eqref{eq:edRwobc} and \eqref{eq:edRwcs}. To see this, let us extend the definition of the exterior derivative by writing $\overline d$ for all the mappings of the complex
$$
 0 \to\bbR\to^\iota{C^\infty}(\overline\Omega,\Alt^0) \to^d {C^\infty}(\overline\Omega,\Alt^1)
 \to^d\cdots \to^d {C^\infty}(\overline\Omega,\Alt^n) \to 0
$$ 
and $\underline d$ for all the mappings of the complex
$$
 0 \to {C^\infty}_{\overline\Omega}(\bbR^n,\Alt^0) \to^d {C^\infty}_{\overline\Omega}(\bbR^n,\Alt^1) \to^d\cdots
 \to^d {C^\infty}_{\overline\Omega}(\bbR^n,\Alt^n) \to^{\iota^*} \bbR \to 0
$$
where $\iota$ is the inclusion mapping for constant functions and 
$\iota^*=(\star\iota)'$ denotes the integral $u\mapsto\int\!u$ for $n$-forms.

If we correspondingly extend the definitions of $R_{\ell}$ and $\Poinc_{\ell}$ by
$$
\begin{aligned}
  R_0u &:=\left(\chi_{\Omega},u\right)\,\text{ for $0$-forms }u\,, &
  R_{n+1} &:=0\,,\\
  T_{n+1}u &:= \star(u\chi_{\Omega}) \,\text{ for }u\in\bbR\,,  &
  T_0 &:= 0\,,
\end{aligned}
$$
then we can write the relations \eqref{eq:dR+Rd=1} and \eqref{eq:dT+Td=1} simply as
\begin{equation}\label{eq:R&T&d}
 \overline d\,R_{\ell} u + R_{\ell+1} \,\overline d u  = u
 \quad \text{ and }\quad
 \underline d\,\Poinc_{\ell} u + \Poinc_{\ell+1} \,\underline du = u\quad \text{ for all }\;
  0\le\ell\le n.
\end{equation}

 
 
 


We introduce the operator $B^{k}$, which is
\begin{equation}\label{eq:Bogo} % TODO: rewrite 
    B^{k} u(x) = - \int_{\Omega} \,(x-a) \lrcorner \int_1^\infty t^{{k}-1}\,u\left( a+t(x-a) \right) \,dt\,da.
\end{equation}
If $u \in C^{\infty}_{c}(\bbR^{n},\Alt^{k})$, 
then $B^{k} u$ is smooth with support in $\bbR^{n}\setminus\overline\Omega$ and $B^{k} u(x) = 0$ when $x \notin \Omega$. 
Since $\Omega$ is convex, $u \in C^{\infty}_{c}(\Omega,\Alt^{k})$ implies $\supp B^{k} u \subset\Omega$, 
Since $\Omega$ is bounded, $u \in C^{\infty}_{\overline\Omega}(\bbR^{n},\Alt^{k})$ implies $\supp B^{k} u \subset\overline\Omega$. 
% The fact that $B^{k}$ indeed maps C^{\infty}_{c}(\bbR^{n},\Alt^{k})$ to $C^{\infty}_{c}(\bbR^{n},\Alt^{{k}-1})$ will be a the following theorem.

 
 
 


























\begin{lemma}
    Let $\Omega \subseteq \bbR^{n}$. There exists a bounded mapping 
    \begin{align*}
     \Bogov_{\ell} : L^{p}(\Omega,\Alt^{\ell}) \rightarrow \bfW^{p}_{0}(\Omega,\Alt^{\ell-1})
    \end{align*}
    such that 
    \begin{align*}
        \| u \|_{L^{p}} \leq n A(n,\ell) \frac{ \vol_{n}(B_D(0)) }{|\Omega|} D \| u \|_{L^{p}(\Omega)}
    \end{align*}
    and such that $\cartan \Bogov_{\ell} u = u$ for all $u \in \cartan \bfW^{p}_{0}(\Omega,\Alt^{\ell-1})$.
\end{lemma}

\begin{lemma}
    Let $\Omega \subseteq \bbR^{n}$. There exists a bounded mapping 
    \begin{align*}
     \Bogov_{\ell} : L^{p}(\Omega,\Alt^{\ell}) \rightarrow \bfW^{p}_{0}(\Omega,\Alt^{\ell-1})
    \end{align*}
    such that 
    \begin{align*}
        \| u \|_{L^{p}} \leq n A(n,\ell) \frac{ \vol_{n}(B_D(0)) }{|\Omega|} D \| u \|_{L^{p}(\Omega)}
    \end{align*}
    and such that $\cartan \Bogov_{\ell} u = u$ for all $u \in \cartan \bfW^{p}_{0}(\Omega,\Alt^{\ell-1})$.
\end{lemma}





There exists a sequence $u_{i} \in C^{\infty}(\overline\Omega,\Alt^{\ell})$ that converges to $u$ in $W^{p}(\Omega,\Alt^{\ell})$
and which satisfies $\cartan u_{i} = 0$. Let $w \in L^{p}(\Omega,\Alt^{\ell-1})$ be the limit of $\Poinc_{\ell} u_{i}$.
We know that $\Poinc_{\ell} u_{i} \in C^{\infty}(\overline\Omega,\Alt^{\ell-1})$. 
Given any $v \in C^{\infty}_{c}(\Omega,\Alt^{n-\ell-1})$, we verify 
\begin{align*}
    \int_{\Omega} w \wedge \cartan v
    &=
    \lim_{i} \int_{\Omega} \Poinc_{\ell} u_{i} \wedge \cartan v
    \\&=
    \lim_{i} \int_{\Omega} \cartan \Poinc_{\ell} u_{i} \wedge v
    \\&=
    \lim_{i} \int_{\Omega} u_{i} \wedge v
    =
    \int_{\Omega} u \wedge v
    .
\end{align*}
That means $w \in W^{p}(\Omega,\Alt^{\ell-1})$ with $\cartan w = u$. 








\section*{Theorem 8.1}

\noindent \textbf{Theorem 8.1 (Discrete Poincaré inequality).} There holds
\begin{align*}
    \|g\|^2_{0,\Omega} 
    \leq 
    C_P |g|^2_{1,T} 
    + 
    \frac{4}{|\Omega|} \left( \int_{\Omega} g(x) \, dx \right)^2
        \quad 
    \forall g \in W(T_h), \forall h > 0
\end{align*}
with
\begin{align*}
C_P = 4C_d C_\Omega \frac{C_{d,T}}{\kappa_T} [\text{diam}(\Omega)]^2 + 8c_d h^2,
\end{align*}
where \(C_\Omega\) is given by (27) when \(\Omega\) is convex and by (28) otherwise, \(C_{d,T}\) is given by (12) when Assumption (B) is satisfied and by (15) in the general case, \(c_d\) is given by (22), and \(C_d\) is given by (26).
\\

\noindent Obviously
\begin{align*}
    \|g\|_{0,\Omega} 
    \leq 
    \|g - I(g)\|_{0,\Omega} + \|I(g)\|^2_{0,\Omega}
    ,
\end{align*}
\begin{align*}
    \|g\|^2_{0,\Omega} 
    &\leq 
    2\|g - I(g)\|^2_{0,\Omega} + 2\|I(g)\|^2_{0,\Omega} 
    ,
    \|g\|_{0,\Omega} 
    &\leq
    \sqrt{2}
    \sqrt{ \|g - I(g)\|^2_{0,\Omega} + 2\|I(g)\|^2_{0,\Omega} }
    .
\end{align*}
We apply the cellwise local approximation estimate, which coincides with the cellwise Poincare inequality:
\begin{align*}
    \|g - I(g)\|_{0,\Omega}
    &\leq 
    \frac{ h_T }{\pi}
    \| \nabla_\calT g \|_{0,\Omega}
    ,
    \|g - I(g)\|_{0,\Omega}
    &\leq 
    \frac{ h_T }{\pi}
    \| \nabla_\calT g \|_{0,\Omega}
    .
\end{align*}



\begin{align}
        v_0 + \langle v_k - v_0, v_{k-1} - v_0, \dots, v_1 - v_0 \rangle,
        \\
        \langle v_n - v_{k+1}, \dots, v_n - v_{n-1} \rangle + v_{0},
        \\
        v_0 + \sum_{i=1}^{k} \lambda_{i} ( v_i - v_0 ),
        \\
        v_0 + \sum_{i=k+1}^{n} \lambda_{i} ( v_n - v_i ),
        \\
        x = v_0 + \sum_{i=1}^{k} \lambda_{i} ( v_i - v_0 ) + \sum_{i=k+1}^{n} \lambda_{i} ( v_n - v_i ),
    \end{align}
    \begin{align}
        v_0 \left( 1 - \sum_{i=1}^{k} \lambda_{i} \right)
        +
        \sum_{i=1}^{k} \lambda_{i} v_i 
        +
        \sum_{i=k+1}^{n-1} \lambda_{i} v_n
        -
        \sum_{i=k+1}^{n-1} \lambda_{i} v_i
    \end{align}
    \begin{align}
        v_0 \left( 1 - \sum_{i=1}^{k} \lambda_{i} \right)
        +
        \sum_{i=1}^{k} \lambda_{i} v_i 
        +
        \sum_{i=k+1}^{n-1} (-\lambda_{i}) v_i
        +
        \sum_{i=k+1}^{n-1} \lambda_{i} v_n
    \end{align}


    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    Bogovskii was the first establish the 
    on whose work the following presentation is based. 
    In contrast to the aforementioned reference, the goal of our discussion is more modest:
    we merely need them over convex sets and are only interested in their operator norms between Lebesgue spaces.
    However, we derive explicit bounds for the operator norms, which are of independent interest. 
    
    It can be identified as a formal adjoint to the Poincar\'e operator in exterior calculus. 
    The Bogovski\u{\i}-type potential operator first appeared for the mathematical discussion of hydrodynamical models~\cite{bogovskii1979solution} and has since been extended to exterior calculus. 
    The regularized Bogovski\u{\i} potential operator was studied extensively by Costabel and McIntosh.
    These operators are defined over sets star-shaped with respect to a ball. 
    
    The generalization to differential forms has been discussed extensively by Costabel and McIntosh~\cite{costabel2010bogovskiui},
    on whose work the following presentation is based. 
    In contrast to the aforementioned reference, the goal of our discussion is more modest:
    we merely need them over convex sets and are only interested in their operator norms between Lebesgue spaces.
    However, we derive explicit bounds for the operator norms, which are of independent interest. 

    
    Their analysis identifies the potential as a pseudodifferential operator of negative order and utilizes tools of harmonic analysis. However, no operator norm estimates are given in the literature, to the best of our best knowledge.
    We study a variation of this potential operator over convex sets.
    We simply use a constant averaging over the entire domain. 
    While the resulting Bogovski\u{\i}-type potential has more moderate regularity properties, 
    this simplification suits our purposes and enables some simple estimates for the continuity constant of the potential operator in Lebesgue norms. 


For jede Matrix $M \in \mathbb R^{n \times n}$ schreiben wir die Reihen als $r_1, r_2, \dots, r_n \in \bbR^{n}$.
Die maximale Euklidische Norm der Reihenvektoren
\begin{align*}
    \| M \|_{\star} := \max\limits_{1 \leq i \leq n} \| r_i \|_{2}
\end{align*}
defininiert eine Norm auf den $n \times n$ Matrizen.

I am looking for the smallest constant $C > 0$ such that 
\begin{align*}
    \| M \|_{2} \leq C \| M \|_{\star}.
\end{align*}
Es ist bekannt dass die Frobenius norm eine obere Schranke ist:
\begin{align*}
    \| M \|_{2} = \sigma_{1}(M) \leq \sum_{i=1}^{n} \sigma_{i}(M) = \| M \|_{F}
\end{align*}
wo $\sigma_{1}(M) \geq \dots \geq \sigma_{n}(M)$ die Singularwerte darstellen. Folglich,
\begin{align*}
    \| M \|_{F} = \sqrt{\sum_{i=1}^{n} \| r_i \|_{2} } \leq \sqrt{n} \max\limits_{1 \leq i \leq n} \| r_i \|_{2}
\end{align*}
Kann die Konstante $\sqrt{n}$ noch verbessert werden?























On the other hand, by the reverse triangle inequality,
    \begin{align}
        \left| F(x) - F(y) \right|
        &\geq 
        \left\| 
            \frac{x}{\|x\|}
            \sum_{i=1}^{n} \lambda_{i}(x)
            -
            \frac{y}{\|y\|}
            \sum_{i=1}^{n} \lambda_{i}(y)
        \right\|
        \\&
        \geq 
        \left| 
            \frac{\|x\|}{\|x\|}
            \sum_{i=1}^{n} \lambda_{i}(x)
            -
            \frac{\|y\|}{\|y\|}
            \sum_{i=1}^{n} \lambda_{i}(y)
        \right|
        \\&
        = 
        \left| 
            \sum_{i=1}^{n} \lambda_{i}(x)
            -
            \sum_{i=1}^{n} \lambda_{i}(y)
        \right|
        \\&
        = 
        \left| 
            \vec{1}
            \cdot 
            A^{-1}( x - y )
        \right|
    \end{align}
    Note that $A^{-1}( x - y ) \in \Delta^{n} - \Delta^{n}$. 
    \begin{align}
        \left| F(x) - F(y) \right|
        &\geq 
        \left\| 
            \frac{x}{\|x\|}
            \left( 1 - \lambda_{0}(x) \right) 
            -
            \frac{y}{\|y\|}
            \left( 1 - \lambda_{0}(y) \right) 
        \right\|
        \\&
        \geq 
        \left\| 
            \frac{x}{\|x\|}
            \left( 1 - \lambda_{0}(x) \right) 
            -
            \frac{y}{\|y\|}
            \left( 1 - \lambda_{0}(y) \right) 
        \right\|
    \end{align}
    %% \todo{finish this estimate somehow}
    
    
    
    
    
    
    
    
    
    
    \begin{proof}
\begin{itemize}
    \item 
    % \todo{Choose hyperplane that puts T on one side}
    We use Lemma~\ref{lemma:oppositesubsimplex}
    \item 
    % \todo{Align barycenter of opposite subsimplex with coordinate axis}
    \item 
    % \todo{opposite simplex cast to disk}
    \item 
    % \todo{roll out rest of sphere onto disk}
    \item 
    % \todo{estimate reflection}
\end{itemize}
\end{proof}


















    We use the following auxiliary result. 
    Suppose that $\|\cdot\|_{\alpha}$ and $\|\cdot\|_{\alpha}$ are two norms on a Banach space.
    Let 
    $$
        F_{\alpha,\beta}(x) = \| x \|_{\alpha} \frac{ x }{ \| x \|_{\beta} }.
    $$
    Then 
    \begin{align*}
        &
        \left\| 
            \| x \|_{\alpha} \frac{ x }{ \| x \|_{\beta} } 
            - 
            \| y \|_{\alpha} \frac{ y }{ \| y \|_{\beta} } 
        \right\|_{\beta}
        \\&\qquad 
        \leq 
        C_{\beta}^{\alpha} 
        \left\| 
            \| x \|_{\alpha} \frac{ x }{ \| x \|_{\beta} } 
            - 
            \| y \|_{\alpha} \frac{ y }{ \| y \|_{\beta} } 
        \right\|_{\alpha}
        \\&\qquad 
        \leq 
        C_{\beta}^{\alpha} 
        \left\| 
            \| x \|_{\alpha} \frac{ x }{ \| x \|_{\beta} } 
            - 
            \| y \|_{\alpha} \frac{ x }{ \| y \|_{\beta} } 
        \right\|_{\alpha}
        +
        C_{\beta}^{\alpha} 
        \left\| 
            \| y \|_{\alpha} \frac{ x }{ \| y \|_{\beta} } 
            - 
            \| y \|_{\alpha} \frac{ y }{ \| y \|_{\beta} } 
        \right\|_{\alpha}
        \\&\qquad 
        \leq 
        C_{\beta}^{\alpha} 
        \frac{ \| x \|_{\alpha} }{ \| x \|_{\beta} } 
        \left| 
            \| x \|_{\alpha}
            - 
            \| y \|_{\alpha}
        \right|
        +
        C_{\beta}^{\alpha} 
        \frac{ \| y \|_{\alpha} }{ \| y \|_{\beta} } 
        \left\| x - y \right\|_{\alpha}
        \\&\qquad 
        \leq 
        C_{\beta}^{\alpha} 
        C_{\alpha}^{\beta} 
        \left\| x - y \right\|_{\alpha}
        +
        C_{\beta}^{\alpha} 
        C_{\alpha}^{\beta} 
        \left\| x - y \right\|_{\alpha}
        .
    \end{align*}
    \begin{align*}
        &
        \| 
            F(x) - F(y) 
        \|_{\beta}
        \\&\leq 
        \left\| 
            \| x \|_{\alpha} \frac{ x }{ \| x \|_{\beta} } 
            - 
            \| y \|_{\alpha} \frac{ y }{ \| y \|_{\beta} } 
        \right\|_{\beta}
        \\&\leq 
        \left\| 
            \| x \|_{\alpha} \frac{ x }{ \| x \|_{\beta} } 
            - 
            \| x \|_{\alpha} \frac{ y }{ \| x \|_{\beta} } 
            + 
            \| x \|_{\alpha} \frac{ y }{ \| x \|_{\beta} } 
            - 
            \| y \|_{\alpha} \frac{ y }{ \| x \|_{\beta} } 
            + 
            \| y \|_{\alpha} \frac{ y }{ \| x \|_{\beta} } 
            - 
            \| y \|_{\alpha} \frac{ y }{ \| y \|_{\beta} } 
        \right\|_{\beta}
        \\&\leq 
        \left\| 
            \| x \|_{\alpha} \frac{ x }{ \| x \|_{\beta} } 
            - 
            \| x \|_{\alpha} \frac{ y }{ \| x \|_{\beta} } 
        \right\|_{\beta}
            + 
        \left\| 
            \| x \|_{\alpha} \frac{ y }{ \| x \|_{\beta} } 
            - 
            \| y \|_{\alpha} \frac{ y }{ \| x \|_{\beta} } 
        \right\|_{\beta}
            + 
        \left\| 
            \| y \|_{\alpha} \frac{ y }{ \| x \|_{\beta} } 
            - 
            \| y \|_{\alpha} \frac{ y }{ \| y \|_{\beta} } 
        \right\|_{\beta}
        \\&\leq 
        \frac{ \| x \|_{\alpha} }{ \| x \|_{\beta} } 
        \left\| 
            x - y
        \right\|_{\beta}
            + 
        \frac{ \| y \|_{\beta} }{ \| x \|_{\beta} } 
        \left| \| x \|_{\alpha} - \| y \|_{\alpha} \right|
        + 
        \| y \|_{\alpha} \| y \|_{\beta} 
        \left| 
            \frac{ 1 }{ \| x \|_{\beta} } 
            - 
            \frac{ 1 }{ \| y \|_{\beta} }  
        \right|
        \\&\leq 
        \frac{ \| x \|_{\alpha} }{ \| x \|_{\beta} } 
        \left\| 
            x - y
        \right\|_{\beta}
        + 
        % BEcause w l o g 
        \left| \| x \|_{\alpha} - \| y \|_{\alpha} \right|
        + 
        \| y \|_{\alpha} \| y \|_{\beta} 
        \frac{ \left| \| x \|_{\beta} - \| y \|_{\beta} \right| }{ \| x \|_{\beta} \| y \|_{\beta} }
        \\&\leq 
        \frac{ \| x \|_{\alpha} }{ \| x \|_{\beta} } 
        \left\| 
            x - y
        \right\|_{\beta}
            + 
        % BEcause w l o g 
        \left| \| x \|_{\alpha} - \| y \|_{\alpha} \right|
            + 
        \| y \|_{\alpha} \| y \|_{\beta} 
        \frac{ \left| \| x \|_{\beta} - \| y \|_{\beta} \right| }{ \| x \|_{\beta} \| y \|_{\beta} }
        \\&\leq 
        \frac{ \| x \|_{\alpha} }{ \| x \|_{\beta} } 
        \left\| x - y \right\|_{\beta}
            + 
        % BEcause w l o g 
        \left\| x - y \right\|_{\alpha}
            + 
        \| y \|_{\alpha} \| y \|_{\beta} 
        \frac{ \left\| x - y \right\|_{\beta} }{ \| y \|_{\beta} \| y \|_{\beta} }
        \\&\leq 
        C^{\alpha}_{\beta} 
        C^{\beta}_{\alpha}
        \left\| x - y \right\|_{\alpha}
            + 
        % BEcause w l o g 
        \left\| x - y \right\|_{\alpha}
            + 
        C^{\alpha}_{\beta} 
        C^{\beta}_{\alpha}
        \left\| x - y \right\|_{\alpha}
        .
    \end{align*}
    % \item 
    Consider any simplex $T$ with one vertex $v_0$ at the origin. 
    Let $\lambda_{0}, \lambda_{1}, \dots, \lambda_{n}$ be the barycentric coordinates. 
    The mapping 
    \begin{align}
        F(x) = \frac{x}{\|x\|} \left( \sum_{i=1}^{n} \lambda_{i}(x) \right) = \frac{x}{\|x\|} \left( 1 - \lambda_{0}(x) \right)
    \end{align}
    maps $T$ onto a ``simplex with a curved face'' inside the unit ball. We analyze its Lipschitz properties.
    On the one hand, 
    \begin{align}
        &
        F(x) - F(y)
        \\&
        =
        \frac{x}{\|x\|} \left( \sum_{i=1}^{n} \lambda_{i}(x) \right)
        -
        \frac{y}{\|x\|} \left( \sum_{i=1}^{n} \lambda_{i}(x) \right)
        \\&\qquad 
        +
        \frac{y}{\|x\|} \left( \sum_{i=1}^{n} \lambda_{i}(x) \right)
        -
        \frac{y}{\|x\|} \left( \sum_{i=1}^{n} \lambda_{i}(y) \right)
        \\&\qquad 
        +
        \frac{y}{\|x\|} \left( \sum_{i=1}^{n} \lambda_{i}(y) \right)
        -
        \frac{y}{\|y\|} \left( \sum_{i=1}^{n} \lambda_{i}(y) \right)
        .    
    \end{align}
    Without loss of generality, $\|y\| \leq \|x\|$. 
    \begin{align}
        &
        \left\| F(x) - F(y) \right\|
        \\&
        \leq
        \left\| x - y \right\|
        \frac{\sum_{i=1}^{n} \lambda_{i}(x)}{\|x\|}
        \\&\qquad 
        +
        \left| \sum_{i=1}^{n} \lambda_{i}(x) - \sum_{i=1}^{n} \lambda_{i}(y) \right|
        +
        \|y\| \left( \sum_{i=1}^{n} \lambda_{i}(y) \right)
        \frac{ \left| \|y\| - \|x\| \right| }{\|x\| \|y\|}
        \\&\leq
        \left\| x - y \right\|
        \sqrt{n} \sigma_{\min}(A^{-1})
        +
        \sqrt{n} \sigma_{\min}(A^{-1}) \left\| x - y \right\|
        +
        \left\| x - y \right\|
        \sqrt{n} \sigma_{\min}(A^{-1})
        \\&\leq
        3\sqrt{n} \sigma_{\min}(A^{-1})
        \left\| x - y \right\|
        .    
    \end{align}
    \begin{align}
        &
        \left\| F(x) - F(y) \right\|
        \\&
        \leq
        \left\| x - y \right\|
        \frac{\sum_{i=1}^{n} \lambda_{i}(x)}{\|x\|}
        \\&\qquad 
        +
        \left| \sum_{i=1}^{n} \lambda_{i}(x) - \sum_{i=1}^{n} \lambda_{i}(y) \right|
        +
        \|y\| \left( \sum_{i=1}^{n} \lambda_{i}(y) \right)
        \frac{ \left| \|y\| - \|x\| \right| }{\|x\| \|y\|}
        \\&
        \leq
        \left\| x - y \right\|
        \frac{\sum_{i=1}^{n} \lambda_{i}(x)}{\|x\|}
        \\&\qquad 
        +
        \left| \lambda_{0}(x) - \lambda_{0}(y) \right|
        +
        \left( \sum_{i=1}^{n} \lambda_{i}(y) \right)
        \frac{ \left| \|y\| - \|x\| \right| }{\|x\|}
        \\&\leq
        \leq
        \left\| x - y \right\|
        \frac{\sum_{i=1}^{n} \lambda_{i}(x)}{\|x\|}
        \\&\qquad 
        +
        \left| \lambda_{0}(x) - \lambda_{0}(y) \right|
        +
        \left( \sum_{i=1}^{n} \lambda_{i}(y) \right)
        \frac{ \| x - y \| }{\|x\|}
        \\&\leq
        \leq
        \left\| x - y \right\|
        \frac{ \lambda_{0}(x) }{\|x\|}
        +
        \left| \lambda_{0}(x) - \lambda_{0}(y) \right|
        +
        \left( \lambda_{0}(y) \right)
        \frac{ \| x - y \| }{\|y\|}
        .    
    \end{align}
    On the one hand,
    we compute the Jacobian  
    \begin{align}
        \Jacobian F(x) 
        = 
        \frac{ \Id \|x\| - x \|x\|^{-1} x^t }{\|x\|^2} 
        \left( \sum_{i=1}^{n} \lambda_{i}(x) \right)
        + 
        \frac{x}{\|x\|} \left( \sum_{i=1}^{n} \nabla\lambda_{i}(x) \right)
        .
    \end{align}
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
% Please cite the original version:
% Alestalo, P., & Trotsenko, D. A. (2018). Radial extensions of bilipschitz maps between unit spheres. Siberian
% Electronic Mathematical Reports, 15, 839-843. https://doi.org/10.17377/semi.2018.15.071
% Theorem 3: radial extension of bi lipschitz between unit spheres, with same constant 


We recall a specialization of this result.

\begin{lemma}\label{theorem:starreflection:facepatch}

\end{lemma}





% https://mathoverflow.net/questions/232302/lipschitz-constant-of-cental-projection-of-unit-ball-to-surface-of-convex-body
% https://eudml.org/doc/258483
% https://math.stackexchange.com/questions/1476085/uniformly-convex-approximation-of-convex-domain
% SMOOTH EXHAUSTION FUNCTIONS IN CONVEX DOMAINS
\begin{lemma}
    Let $K \subseteq \bbR^{n}$ be a compact set star-shaped with respect to the origin 
    that contains the ball $B_{r}(0)$ and that is contained in the ball $B_{R}(0)$. Then the function 
    \begin{align*}
        f : S \rightarrow \partial K, \quad x \mapsto \arg( \partial K \cap \bbR x )
    \end{align*}
    satisfies 
    \begin{align*}
        R^{2}/r % euclidean 
    \end{align*}
    If $K$ is convex, then 
    \begin{align*}
        g : S \rightarrow \bbR, \quad x \mapsto \| \bbR x \cap \partial K \|
    \end{align*}
    satisfies 
    \begin{align*}
        R \sqrt{ R^{2} / r^{2} - 1 } % angular distance 
        \\
        \frac R r \sqrt{ R^{2} - r^{2} } % angular distance 
    \end{align*}
\end{lemma}
\begin{proof}
    .
\end{proof}


    
    
    
    
    
    
    
    
    
    
\end{document}
    
    
    
    
    
    
    
    
    
    
    
